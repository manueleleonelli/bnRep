# A Bayesian Network risk model for estimating coastal maritime transportation delays following an earthquake in British Columbia

library(bnlearn)
a <- function(i){
  out <- rep(0,6)
  out[i] <- 1
  return(out)
}

b <- function(i){
  if(i ==6){ rep(a(i),i)} else{
    j <- i+1
    out <- rep(a(i),i)
    for(k in j:6) out <- c(out, a(k))
    out
  }
}

d <- function(i){
  if(i ==6){ rep(b(i),i)} else if(i == 5) {c(rep(b(i),i),b(6)) } else if(i==4){c(rep(b(i),i),b(5),b(6))} else if(i==3){c(rep(b(i),i),b(4),b(5),b(6))} else if(i==2){c(rep(b(i),i),b(3),b(4),b(5),b(6))} else{c(b(1),b(2),b(3),b(4),b(5),b(6))}
}

library(bnlearn)
dag <- model2network('[BVOR][ESO][VT][OL][ESR][EEL][DL][ESD][TIDO|ESO][WIDO|ESO][CIDO|ESO:ESR][CIDD|ESD:ESR][TIDD|ESD][WIDD|ESD][PAO|ESO][CN|ESR][PAD|ESD][BSA|CN:ESO:BVOR][BSO|CN:WIDO:VT][MMSC|CN:VT][TWO|OL:EEL][CSR|CN:VT][DGR|CN:VT][TWD|DL:EEL][BSD|CN:WIDD:VT][TTRO|PAO:TIDO:VT][TCSO|PAO:CIDO:CSR][DAC|PAO:MMSC][TBS|PAO:ESO:BSA][DTWO|OL:EEL:TWO][DTWD|DL:EEL:TWD][TCSD|PAD:CIDD:CSR][TTRD|PAD:TIDD:VT][DDG|TCSD:DGR][VD|DTWD:DDG:DTWO][TBSD|DTWD:PAD:WIDD:BSD][TBSO|DTWO:PAO:WIDO:BSO][AD|TTRD:TCSD:TBSD][DD|TBSO:TBS:DAC:TCSO:TTRO][RD|VD:AD:DD]')
bvor <- array(dimnames= list(BVOR = c("Yes","No")), dim = 2, c(0.5,0.5))
eso <- array(dimnames= list(ESO = c("VI_or_less","VII","VIII","IX","X_or_more")), dim = 5, c(0.2,0.2,0.2,0.2,0.2))
vt <- array(dimnames= list(VT = c("BC_Ferries","Seaspan","Barge")), dim = 3, c(0.333,0.333,0.334))
ol <- array(dimnames= list(OL = c("V_Isl_W","V_Isl_E","V_Isl_S","BC_ML")), dim = 4, c(0.25,0.25,0.25,0.25))
esr <- array(dimnames= list(ESR = c("VI_or_less","VII","VIII","IX","X_or_more")), dim = 5, c(0.2,0.2,0.2,0.2,0.2))
eel <- array(dimnames= list(EEL = c("V_Isl_W_offshore","V_Isl_E_offshore","V_Isl_Inland","BC_ML")), dim = 4, c(0.25,0.25,0.25,0.25))
dl <- array(dimnames= list(DL = c("V_Isl_W","V_Isl_E","V_Isl_S")), dim = 3, c(0.333,0.333,0.334))
esd <- array(dimnames= list(ESD = c("VI_or_less","VII","VIII","IX","X_or_more")), dim = 5, c(0.2,0.2,0.2,0.2,0.2))
tido <- array(dimnames = list(TIDO = c("Low","Medium","High"), ESO =c("VI_or_less","VII","VIII","IX","X_or_more")), dim = c(3,5), c(0.75,0.25,0,0.6,0.4,0,0.5,0.5,0,0.4,0.5,0.1,0.2,0.4,0.4))
wido <- array(dimnames = list(WIDO = c("Low","Medium","High"), ESO =c("VI_or_less","VII","VIII","IX","X_or_more")), dim = c(3,5), c(0.95,0.05,0,0.9,0.1,0,0.8,0.2,0,0.7,0.25,0.05,0.6,0.3,0.1))
cido <- array(dimnames = list(CIDO = c("Low","Medium","High"), ESO =c("VI_or_less","VII","VIII","IX","X_or_more"),ESR =c("VI_or_less","VII","VIII","IX","X_or_more")), dim = c(3,5,5), c(1,0,0,0.95,0.05,0,0.8,0.2,0,0.6,0.4,0,0.2,0.7,0.1,0.95,0.05,0,0.9,0.1,0,0.7,0.3,0,0.5,0.4,0.1,0.1,0.6,0.3,0.8,0.2,0,0.7,0.25,0.05,0.5,0.4,0.1,0.4,0.4,0.2,0.05,0.55,0.4,0.6,0.4,0,0.55,0.35,0.1,0.4,0.3,0.3,0.3,0.2,0.5,0.1,0.4,0.5,0.3,0.7,0,0.4,0.4,0.2,0.1,0.3,0.6,0,0.25,0.75,0,0.1,0.9))
cidd <- array(dimnames = list(CIDD = c("Low","Medium","High"), ESD =c("VI_or_less","VII","VIII","IX","X_or_more"),ESR =c("VI_or_less","VII","VIII","IX","X_or_more")), dim = c(3,5,5), c(1,0,0,0.95,0.05,0,0.8,0.2,0,0.6,0.4,0,0.2,0.7,0.1,0.95,0.05,0,0.9,0.1,0,0.7,0.3,0,0.5,0.4,0.1,0.1,0.6,0.3,0.8,0.2,0,0.7,0.25,0.05,0.5,0.4,0.1,0.4,0.4,0.2,0.05,0.55,0.4,0.6,0.4,0,0.55,0.35,0.1,0.4,0.3,0.3,0.3,0.2,0.5,0.1,0.4,0.5,0.3,0.7,0,0.4,0.4,0.2,0.1,0.3,0.6,0,0.25,0.75,0,0.1,0.9))
tidd <- array(dimnames = list(TIDD = c("Low","Medium","High"), ESD =c("VI_or_less","VII","VIII","IX","X_or_more")), dim = c(3,5), c(0.75,0.25,0,0.6,0.4,0,0.5,0.5,0,0.4,0.5,0.1,0.2,0.4,0.4))
widd <- array(dimnames = list(WIDD = c("Low","Medium","High"), ESD =c("VI_or_less","VII","VIII","IX","X_or_more")), dim = c(3,5), c(0.95,0.05,0,0.9,0.1,0,0.8,0.2,0,0.7,0.25,0.05,0.6,0.3,0.1))
pao <- array(dimnames = list(PAO = c("Low","Medium","High"), ESO =c("VI_or_less","VII","VIII","IX","X_or_more")), dim = c(3,5), c(0.01,0.09,0.9,0.05,0.25,0.7,0.1,0.5,0.4,0.4,0.5,0.1,0.8,0.2,0))
cn <- array(dimnames = list(CN = c("Low","Medium","High"), ESR =c("VI_or_less","VII","VIII","IX","X_or_more")), dim = c(3,5), c(0.8,0.2,0,0.3,0.7,0,0.2,0.6,0.2,0.05,0.4,0.55,0,0.2,0.8))
pad <- array(dimnames = list(PAD = c("Low","Medium","High"), ESD =c("VI_or_less","VII","VIII","IX","X_or_more")), dim = c(3,5), c(0.01,0.09,0.9,0.05,0.25,0.7,0.1,0.5,0.4,0.4,0.5,0.1,0.8,0.2,0))
bsa <- array(dimnames = list(BSA = c("Yes","No"), CN =c("Low","Medium","High"), ESO = c("VI_or_less","VII","VIII","IX","X_or_more"), BVOR = c("Yes","No")), dim = c(2,3,5,2), c(0.8,0.2,0.7,0.3,0.4,0.6,0.9,0.1,0.7,0.3,0.3,0.7,0.99,0.01,0.6,0.4,0.5,0.5,0.99,0.01,0.7,0.3,0.5,0.5,0.99,0.01,0.8,0.2,0.5,0.5,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1))
bso <- array(dimnames = list(BSO = c("Yes","No"), CN = c("Low","Medium","High"), WIDO = c("Low","Medium","High"), VT= c("BC_Ferries","Seaspan","Barge")), dim = c(2,3,3,3), c(0.2,0.8,0.1,0.9,0.05,0.95,0.5,0.5,0.4,0.6,0.3,0.7,0.95,0.05,0.9,0.1,0.5,0.5,0.1,0.9,0.05,0.95,0.01,0.99,0.4,0.6,0.3,0.7,0.1,0.9,0.8,0.2,0.5,0.5,0.2,0.8,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1))
mmsc <- array(dimnames = list(MMSC = c("Yes","No"),CN = c("Low","Medium","High"),VT= c("BC_Ferries","Seaspan","Barge")), dim = c(2,3,3), c(0.99,0.01,0.9,0.1,0.5,0.5,0.9,0.1,0.7,0.3,0.25,0.75,0,1,0,1,0,1))
two <- array(dimnames = list(TWO = c("Yes","No"), OL = c("V_Isl_W","V_Isl_E","V_Isl_S","BC_ML"),EEL = c("V_Isl_W_offshore","V_Isl_E_offshore","V_Isl_Inland","BC_ML")), dim = c(2,4,4), c(1,0,0.05,0.95,0.5,0.5,0.25,0.75,0,1,0.25,0.75,0.25,0.75,0.25,0.75,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1))
csr <- array(dimnames = list(CSR = c("Yes","No"), CN = c("Low","Medium","High"),VT= c("BC_Ferries","Seaspan","Barge")), dim = c(2,3,3), c(0.9,0.1,0.8,0.2,0.5,0.5,0.75,0.25,0.5,0.5,0.25,0.75,0,1,0,1,0,1))
dgr <- array(dimnames = list(DGR = c("Yes","No"), CN = c("Low","Medium","High"),VT= c("BC_Ferries","Seaspan","Barge")), dim = c(2,3,3), c(0.99,0.01,0.9,0.1,0.5,0.5,0.9,0.1,0.7,0.3,0.25,0.75,0,1,0,1,0,1))
twd <- array(dimnames = list(TWD = c("Yes","No"), DL = c("V_Isl_W","V_Isl_E","V_Isl_S"),EEL = c("V_Isl_W_offshore","V_Isl_E_offshore","V_Isl_Inland","BC_ML")), dim = c(2,3,4), c(1,0,0.05,0.95,0.5,0.5,0,1,0.25,0.75,0.25,0.75,0,1,0,1,0,1,0,1,0,1,0,1))
bsd <- array(dimnames = list(BSD =c("Yes","No"), CN = c("Low","Medium","High"),WIDD = c("Low","Medium","High"),VT= c("BC_Ferries","Seaspan","Barge")),dim = c(2,3,3,3), c(0.2,0.8,0.1,0.9,0.05,0.95,0.5,0.5,0.4,0.6,0.3,0.7,0.95,0.05,0.9,0.1,0.5,0.5,0.1,0.9,0.05,0.95,0.01,0.99,0.4,0.6,0.3,0.7,0.1,0.9,0.8,0.2,0.5,0.5,0.2,0.8,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1))
ttro <- array(dimnames = list(TTRO = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), PAO = c("Low","Medium","High"), TIDO = c("Low","Medium","High"), VT = c("BC_Ferries","Seaspan","Barge")), dim = c(6,3,3,3), c(0,0,0.1,0.6,0.2,0.1,0,0,0.2,0.5,0.25,0.05,0,0,0.4,0.4,0.19,0.01,0,0,0,0.4,0.4,0.2,0,0,0.15,0.35,0.4,0.1,0,0,0.25,0.35,0.35,0.05,0,0,0,0.2,0.2,0.6,0,0,0.05,0.25,0.3,0.4,0,0,0.1,0.4,0.2,0.3,0,0,0.4,0.5,0.1,0,0,0.1,0.4,0.45,0.05,0,0,0.19,0.5,0.3,0.01,0,0,0,0.2,0.5,0.3,0,0,0,0.3,0.45,0.25,0,0,0,0.35,0.45,0.2,0,0,0,0.1,0.5,0.35,0.05,0,0,0.15,0.55,0.29,0.01,0,0,0.2,0.6,0.19,0.01,0.05,0.95,0,0,0,0,0.1,0.9,0,0,0,0,0.2,0.8,0,0,0,0,0.01,0.95,0.04,0,0,0,0.02,0.95,0.03,0,0,0,0.03,0.95,0.02,0,0,0,0,0.85,0.15,0,0,0,0,0.9,0.1,0,0,0,0,0.95,0.05,0,0,0))
tcso <- array(dimnames = list(TCSO = c("L0","B0_6","B6_12","B12_24","B24_48","M48"),PAO = c("Low","Medium","High"), CIDO = c("Low","Medium","High"), CSR = c("Yes","No")), dim = c(6,3,3,2), c(0.2,0.5,0.3,0,0,0,0.3,0.6,0.1,0,0,0,0.25,0.65,0.1,0,0,0,0,0.1,0.3,0.5,0.1,0,0,0.2,0.4,0.35,0.05,0,0,0.3,0.45,0.25,0,0,0,0,0,0.2,0.3,0.5,0,0,0,0.25,0.3,0.45,0,0,0.05,0.3,0.35,0.3,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0))
dac <- array(dimnames = list(DAC = c("L0","B0_6","B6_12","B12_24","B24_48","M48"),PAO = c("Low","Medium","High"), MMSC = c("Yes","No")), dim = c(6,3,2), c(0,0.1,0.4,0.4,0.1,0,0,0.3,0.3,0.4,0,0,0,0.6,0.3,0.1,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0))
tbs <- array(dimnames = list(TBS = c("L0","B0_6","B6_12","B12_24","B24_48","M48"),PAO = c("Low","Medium","High"),ESO = c("VI_or_less","VII","VIII","IX","X_or_more"), BSA = c("Yes","No")), dim = c(6,3,5,2), c(0,0.1,0.8,0.1,0,0,0,0.4,0.55,0.05,0,0,0,0.45,0.54,0.01,0,0,0,0,0.2,0.7,0.1,0,0,0,0.25,0.7,0.05,0,0,0,0.35,0.64,0.01,0,0,0,0,0.1,0.7,0.2,0,0,0,0.15,0.7,0.15,0,0,0,0.2,0.65,0.15,0,0,0,0,0.4,0.6,0,0,0,0.05,0.4,0.55,0,0,0,0.1,0.4,0.5,0,0,0,0,0.1,0.9,0,0,0,0,0.15,0.85,0,0,0,0,0.2,0.8,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0))
dtwo <- array(dimnames = list(DTWO = c("L0","B0_6","B6_12","B12_24","B24_48","M48"),OL = c("V_Isl_W","V_Isl_E","V_Isl_S","BC_ML"),EEL = c("V_Isl_W_offshore","V_Isl_E_offshore","V_Isl_Inland","BC_ML"),TWO = c("Yes","No")),dim = c(6,4,4,2), c(0,0.1,0.6,0.2,0.09,0.01,0.05,0.9,0.05,0,0,0,0,0.2,0.7,0.1,0,0,0.05,0.8,0.1,0.05,0,0,0.05,0.95,0,0,0,0,0,0.2,0.7,0.1,0,0,0,0.5,0.5,0,0,0,0,0.2,0.7,0.1,0,0,0.05,0.95,0,0,0,0,0.05,0.95,0,0,0,0,0.05,0.95,0,0,0,0,0.05,0.95,0,0,0,0,0.05,0.95,0,0,0,0,0.05,0.95,0,0,0,0,0.05,0.95,0,0,0,0,0.05,0.95,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0))
dtwd <- array(dimnames = list(DTWD = c("L0","B0_6","B6_12","B12_24","B24_48","M48"),DL = c("V_Isl_W","V_Isl_E","V_Isl_S"),EEL = c("V_Isl_W_offshore","V_Isl_E_offshore","V_Isl_Inland","BC_ML"),TWD = c("Yes","No")),dim = c(6,3,4,2), c(0,0.1,0.6,0.2,0.09,0.01,0.05,0.9,0.05,0,0,0,0,0.2,0.7,0.1,0,0,1,0,0,0,0,0,0,0.2,0.7,0.1,0,0,0,0.5,0.5,0,0,0,0.05,0.95,0,0,0,0,0.05,0.95,0,0,0,0,0.05,0.95,0,0,0,0,0.05,0.95,0,0,0,0,0.05,0.95,0,0,0,0,0.05,0.95,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0))
tcsd <- array(dimnames = list(TCSD = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), PAD = c("Low","Medium","High"), CIDD =c("Low","Medium","High"), CSR = c("Yes","No")), dim = c(6,3,3,2), c(0.2,0.5,0.3,0,0,0,0.3,0.6,0.1,0,0,0,0.25,0.65,0.1,0,0,0,0,0.1,0.3,0.5,0.1,0,0,0.2,0.4,0.35,0.05,0,0,0.3,0.45,0.25,0,0,0,0,0,0.2,0.3,0.5,0,0,0,0.25,0.3,0.45,0,0,0.05,0.3,0.35,0.3,rep(c(1,0,0,0,0,0),9)))
ttrd <- array(dimnames = list(TTRD =  c("L0","B0_6","B6_12","B12_24","B24_48","M48"), PAD = c("Low","Medium","High"), TIDD =c("Low","Medium","High"), VT = c("BC_Ferries","Seaspan","Barge")),dim = c(6,3,3,3), c(0,0,0.1,0.6,0.2,0.1,0,0,0.2,0.5,0.25,0.05,0,0,0.4,0.4,0.19,0.01,0,0,0,0.4,0.4,0.2,0,0,0.15,0.35,0.4,0.1,0,0,0.25,0.35,0.35,0.05,0,0,0,0.2,0.2,0.6,0,0,0.05,0.25,0.3,0.4,0,0,0.1,0.4,0.2,0.3,0,0,0.4,0.5,0.1,0,0,0.1,0.4,0.45,0.05,0,0,0.19,0.5,0.3,0.01,0,0,0,0.2,0.5,0.3,0,0,0,0.3,0.45,0.25,0,0,0,0.35,0.45,0.2,0,0,0,0.1,0.5,0.35,0.05,0,0,0.15,0.55,0.29,0.01,0,0,0.2,0.6,0.19,0.01,0.05,0.95,0,0,0,0,0.1,0.9,0,0,0,0,0.2,0.8,0,0,0,0,0.01,0.95,0.04,0,0,0,0.02,0.95,0.03,0,0,0,0.03,0.95,0.02,0,0,0,0,0.85,0.15,0,0,0,0,0.9,0.1,0,0,0,0,0.95,0.05,0,0,0))
ddg <- array(dimnames = list(DDG = c("L0","B0_6","B6_12","B12_24","B24_48","M48"),TCSD = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), DGR = c("Yes","No")), dim = c(6,6,2), c(0,0.9,0.1,0,0,0,0,0.45,0.5,0.05,0,0,0,0,0.45,0.55,0,0,0,0,0,0.7,0.3,0,0,0,0,0,0.85,0.15,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0))
vd <- array(dimnames = list(VD=c("L0","B0_6","B6_12","B12_24","B24_48","M48"),DTWD = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), DDG = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), DTWO = c("L0","B0_6","B6_12","B12_24","B24_48","M48")), dim = c(6,6,6,6), c(b(1),b(2),b(3),b(4),b(5),b(6),b(2),b(2),b(3),b(4),b(5),b(6),b(3),b(3),b(3),b(4),b(5),b(6),b(4),b(4),b(4),b(4),b(5),b(6),b(5),b(5),b(5),b(5),b(5),b(6),b(6),b(6),b(6),b(6),b(6)))
tbsd <- array(dimnames = list(TBSD = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), DTWD = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), PAD = c("Low","Medium","High"), WIDD = c("Low","Medium","High"),BSD = c("Yes","No")), dim = c(6,6,3,3,2), c(0,0.2,0.8,0,0,0,0,0.1,0.5,0.4,0,0,0,0,0.1,0.9,0,0,0,0,0,0.35,0.65,0,0,0,0,0,0.675,0.325,0,0,0,0,0,1,0,0.5,0.5,0,0,0,0,0.25,0.5,0.25,0,0,0,0,0.25,0.75,0,0,0,0,0,0.5,0.5,0,0,0,0,0,0.75,0.25,0,0,0,0,0,1,0,0.8,0.2,0,0,0,0,0.4,0.5,0.1,0,0,0,0,0.4,0.6,0,0,0,0,0,0.65,0.35,0,0,0,0,0,0.825,0.175,0,0,0,0,0,1,0,0,0.5,0.5,0,0,0,0,0.25,0.625,0.125,0,0,0,0,0.625,0.375,0,0,0,0,0.125,0.875,0,0,0,0,0,0.437,0.563,0,0,0,0,0,1,0,0.2,0.6,0.2,0,0,0,0.1,0.4,0.45,0.05,0,0,0,0.1,0.75,0.15,0,0,0,0,0.3,0.7,0,0,0,0,0,0.6,0.4,0,0,0,0,0,1,0,0.1,0.8,0.1,0,0,0,0.05,0.45,0.475,0.025,0,0,0,0.05,0.875,0.075,0,0,0,0,0.275,0.725,0,0,0,0,0,0.612,0.388,0,0,0,0,0,1,0,0,0,0.1,0.6,0.3,0,0,0,0.075,0.55,0.375,0,0,0,0.025,0.45,0.525,0,0,0,0,0.25,0.75,0,0,0,0,0.025,0.975,0,0,0,0,0,1,0,0,0.1,0.4,0.4,0.1,0,0,0.05,0.35,0.45,0.15,0,0,0,0.2,0.55,0.25,0,0,0,0.025,0.575,0.4,0,0,0,0,0.162,0.838,0,0,0,0,0,1,0,0,0.1,0.6,0.3,0,0,0,0.05,0.5,0.413,0.037,0,0,0,0.25,0.637,0.113,0,0,0,0.025,0.75,0.225,0,0,0,0,0.212,0.788,0,0,0,0,0,1,rep(a(1),54)))
tbso <- array(dimnames = list(TBSO = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), DTWO = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), PAO = c("Low","Medium","High"), WIDO = c("Low","Medium","High"),BSO = c("Yes","No")), dim = c(6,6,3,3,2), c(0,0.2,0.8,0,0,0,0,0.1,0.5,0.4,0,0,0,0,0.1,0.9,0,0,0,0,0,0.35,0.65,0,0,0,0,0,0.675,0.325,0,0,0,0,0,1,0,0.5,0.5,0,0,0,0,0.25,0.5,0.25,0,0,0,0,0.25,0.75,0,0,0,0,0,0.5,0.5,0,0,0,0,0,0.75,0.25,0,0,0,0,0,1,0,0.8,0.2,0,0,0,0,0.4,0.5,0.1,0,0,0,0,0.4,0.6,0,0,0,0,0,0.65,0.35,0,0,0,0,0,0.825,0.175,0,0,0,0,0,1,0,0,0.5,0.5,0,0,0,0,0.25,0.625,0.125,0,0,0,0,0.625,0.375,0,0,0,0,0.125,0.875,0,0,0,0,0,0.437,0.563,0,0,0,0,0,1,0,0.2,0.6,0.2,0,0,0,0.1,0.4,0.45,0.05,0,0,0,0.1,0.75,0.15,0,0,0,0,0.3,0.7,0,0,0,0,0,0.6,0.4,0,0,0,0,0,1,0,0.1,0.8,0.1,0,0,0,0.05,0.45,0.475,0.025,0,0,0,0.05,0.875,0.075,0,0,0,0,0.275,0.725,0,0,0,0,0,0.612,0.388,0,0,0,0,0,1,0,0,0,0.1,0.6,0.3,0,0,0,0.075,0.55,0.375,0,0,0,0.025,0.45,0.525,0,0,0,0,0.25,0.75,0,0,0,0,0.025,0.975,0,0,0,0,0,1,0,0,0.1,0.4,0.4,0.1,0,0,0.05,0.35,0.45,0.15,0,0,0,0.2,0.55,0.25,0,0,0,0.025,0.575,0.4,0,0,0,0,0.162,0.838,0,0,0,0,0,1,0,0,0.1,0.6,0.3,0,0,0,0.05,0.5,0.413,0.037,0,0,0,0.25,0.637,0.113,0,0,0,0.025,0.75,0.225,0,0,0,0,0.212,0.788,0,0,0,0,0,1,rep(a(1),54)))
ad <- array(dimnames = list(AD =c("L0","B0_6","B6_12","B12_24","B24_48","M48"), TTRD = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), TCSD = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), TBSD = c("L0","B0_6","B6_12","B12_24","B24_48","M48")), dim = c(6,6,6,6), c(b(1),b(2),b(3),b(4),b(5),b(6),b(2),b(2),b(3),b(4),b(5),b(6),b(3),b(3),b(3),b(4),b(5),b(6),b(4),b(4),b(4),b(4),b(5),b(6),b(5),b(5),b(5),b(5),b(5),b(6),b(6),b(6),b(6),b(6),b(6),b(6)))

f <- c(d(3),d(3),d(3),d(4),d(5),d(6),d(3),d(3),d(3),d(4),d(5),d(6),d(3),d(3),d(3),d(4),d(5),d(6),d(4),d(4),d(4),d(4),d(5),d(6),d(5),d(5),d(5),d(5),d(5),d(6),d(6),d(6),d(6),d(6),d(6),d(6))
g <- c(d(4),d(4),d(4),d(4),d(5),d(6),d(4),d(4),d(4),d(4),d(5),d(6),d(4),d(4),d(4),d(4),d(5),d(6),d(4),d(4),d(4),d(4),d(5),d(6),d(5),d(5),d(5),d(5),d(5),d(6),d(6),d(6),d(6),d(6),d(6),d(6))
h <- c(d(5),d(5),d(5),d(5),d(5),d(6),d(5),d(5),d(5),d(5),d(5),d(6),d(5),d(5),d(5),d(5),d(5),d(6),d(5),d(5),d(5),d(5),d(5),d(6),d(5),d(5),d(5),d(5),d(5),d(6),d(6),d(6),d(6),d(6),d(6),d(6))
i <- c(d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(6))
dd <- array(dimnames = list(DD = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), TBSO= c("L0","B0_6","B6_12","B12_24","B24_48","M48"), TBS = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), DAC = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), TCSO = c("L0","B0_6","B6_12","B12_24","B24_48","M48"),TTRO =c("L0","B0_6","B6_12","B12_24","B24_48","M48")), dim = c(6,6,6,6,6,6), c(d(1),d(2),d(3),d(4),d(5),d(6),d(2),d(2),d(3),d(4),d(5),d(6),d(3),d(3),d(3),d(4),d(5),d(6),d(4),d(4),d(4),d(4),d(5),d(6),d(5),d(5),d(5),d(5),d(5),d(6),d(6),d(6),d(6),d(6),d(6),d(6),d(2),d(2),d(3),d(4),d(5),d(6),d(2),d(2),d(3),d(4),d(5),d(6),d(3),d(3),d(3),d(4),d(5),d(6),d(4),d(4),d(4),d(4),d(5),d(6),d(5),d(5),d(5),d(5),d(5),d(6),d(6),d(6),d(6),d(6),d(6),d(6),f,g,h,i))
rd <- array(dimnames = list(RD = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), VD = c("L0","B0_6","B6_12","B12_24","B24_48","M48"),AD = c("L0","B0_6","B6_12","B12_24","B24_48","M48"), DD = c("L0","B0_6","B6_12","B12_24","B24_48","M48")), dim = c(6,6,6,6), c(d(1),d(2),d(3),d(4),d(5),d(6)))

cpts <- list(BVOR = bvor, ESO = eso, VT = vt, OL = ol, ESR = esr,EEL = eel, DL = dl,ESD = esd, TIDO = tido,WIDO=wido,CIDO = cido,CIDD = cidd,TIDD = tidd,WIDD = widd,PAO = pao,CN = cn, PAD = pad, BSA = bsa,BSO = bso, MMSC = mmsc,TWO = two, CSR = csr,DGR = dgr,TWD =twd,BSD = bsd,TTRO = ttro, TCSO = tcso,DAC = dac, TBS = tbs,DTWO = dtwo,DTWD =dtwd, TCSD = tcsd, TTRD = ttrd, DDG = ddg,VD=vd, TBSD = tbsd,TBSO = tbso,AD = ad,DD = dd, RD = rd)
earthquake <- custom.fit(dag, cpts)

#usethis::use_data(earthquake, overwrite = TRUE)


