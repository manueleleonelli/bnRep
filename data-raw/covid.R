cough <- read.csv("~/Downloads/cough.csv", header=FALSE)

cough <- cough[,-1]
cough <- cough[-(1:9),]

cou <- c()
for(i in 1:ncol(cough)) cou <- c(cou,cough[,i])
cou <- as.numeric(cou)



library(bnlearn)

dag <- model2network("[Diarrhea][Fatigue|CovidSeverity][Fever|Sob:CovidSeverity][Headache|MuscleSore:Fatigue:Diarrhea][LossOfTaste|RunnyNose:LossOfSmell][LossOfSmell|SoreThroat:Sob:RunnyNose][MuscleSore|Fever:Fatigue:Diarrhea][RunnyNose|SoreThroat:Headache][Sob|CovidSeverity][SoreThroat|Fatigue:Diarrhea:CovidSeverity][Cough|Diarrhea:Fatigue:Fever:Headache:LossOfTaste:MuscleSore:RunnyNose:Sob:SoreThroat][CovidSeverity|Diarrhea]")
lv <- c("1. 0", "2. 1")
lv1 <- c("1. 1", "2. 2", "3. 3", "4. 4", "5. 5", "6. 6")

LossOfSmell <- array(c(0.9550898203592815,1-0.9550898203592815,0.7707692307692308,1-0.7707692307692308,0.8393939393939394,1-0.8393939393939394,0.8018867924528302,1-0.8018867924528302,0.7651933701657458,1-0.7651933701657458,0.8120567375886525,1-0.8120567375886525,0.7162162162162162,1-0.7162162162162162,0.30327868852459017,1-0.30327868852459017),c(2,2,2,2),list(LossOfSmell=lv,SoreThroat=lv,Sob=lv,RunnyNose=lv))
Diarrhea <- array(c(0.915714,1-0.915714),2,list(Diarrhea=lv))
Fatigue <- array(c(0.8665158371040724,1-0.8665158371040724,0.9880382775119618,1-0.9880382775119618,0.9390243902439024,1-0.9390243902439024,0.021008403361344536,1-0.021008403361344536,0.1470588235294118,1-0.1470588235294118,0.5179640718562875,1-0.5179640718562875),c(2,6),list(Fatigue=lv,CovidSeverity=lv1))
Fever <- array(c(0.9991647176745739,1-0.9991647176745739,0.6188118811881188,1-0.6188118811881188,0.006053268765133172,1-0.006053268765133172,0.5,0.5,0.03246753246753247,1-0.03246753246753247,0.5,0.5,0.010729613733905581,1-0.010729613733905581,0.5,0.5,0.5,0.5,0.08620689655172413,1-0.08620689655172413,0.5,0.5,0.4817629179331307,1-0.4817629179331307),c(2,2,6),list(Fever=lv,Sob=lv,CovidSeverity=lv1))
Headache <- array(c(0.8943661971830986,1-0.8943661971830986,0.5211640211640212,1-0.5211640211640212,0.4819004524886878,1-0.4819004524886878,0.41561181434599154,1-0.41561181434599154,0.5,0.5,0.23333333333333334,1-0.23333333333333334,0.28378378378378377,1-0.28378378378378377,0.26811594202898553,1-0.26811594202898553),c(2,2,2,2),list(Headache=lv,MuscleSore=lv,Fatigue=lv,Diarrhea=lv))
LossOfTaste <- array(c(0.9720951509606587,1-0.9720951509606587,0.9295302013422819,1-0.9295302013422819,0.39690721649484534,1-0.39690721649484534,0.040983606557377046,1-0.040983606557377046),c(2,2,2),list(LossOfTaste=lv,RunnyNose=lv,LossOfSmell=lv))
MuscleSore <- array(c(0.9577903682719546,1-0.9577903682719546,0.6642228739002932,1-0.6642228739002932,0.5743494423791822,1-0.5743494423791822,0.35185185185185186,1-0.35185185185185186,0.6558441558441559,1-0.6558441558441559,0.6509433962264151,1-0.6509433962264151,0.4111111111111111,1-0.4111111111111111,0.30327868852459017,1-0.30327868852459017),c(2,2,2,2),list(MuscleSore=lv,Fever=lv,Fatigue=lv,Diarrhea=lv))
RunnyNose <- array(c(0.9353591160220994,1-0.9353591160220994,0.7896551724137931,1-0.7896551724137931,0.7536585365853659,1-0.7536585365853659,0.5137931034482759,1-0.5137931034482759),c(2,2,2),list(RunnyNose=lv,SoreThroat=lv,Headache=lv))
Sob <- array(c(0.9673561732385262,1-0.9673561732385262,0.9880382775119618,1-0.9880382775119618,0.9390243902439024,1-0.9390243902439024,0.9789915966386554,1-0.9789915966386554,0.1470588235294118,1-0.1470588235294118,0.014970059880239521,1-0.014970059880239521),c(2,6),list(Sob=lv,CovidSeverity=lv1))
SoreThroat <- array(c(0.9205227492739594,1-0.9205227492739594,0.6121495327102804,1-0.6121495327102804,0.6218274111675127,1-0.6218274111675127,0.03246753246753247,1-0.03246753246753247,0.646163215590743,1-0.646163215590743,rep(0.5,20),0.6558441558441559,1-0.6558441558441559,0.5,0.5,0.9137931034482758,1-0.9137931034482758,0.5,0.5,0.08620689655172413,1-0.08620689655172413,0.8406940063091483,1-0.8406940063091483,0.6218274111675127,1-0.6218274111675127,0.9137931034482758,1-0.9137931034482758,0.02,0.98),c(2,2,2,6),list(SoreThroat=lv,Fatigue=lv,Diarrhea=lv,CovidSeverity=lv1))
Cough <- array(cou, rep(2,10), list(Cough=lv,SoreThroat=lv,Sob=lv,RunnyNose=lv,MuscleSore=lv,LossOfTaste=lv,Headache=lv,Fever=lv,Fatigue=lv,Diarrhea=lv))
CovidSeverity <- array(c(0.768850754030161,0.10738429537181485,0.001300052002080083,0.05122204888195527,0.004420176807072283,0.06682267290691626,0.38700564971751406,0.014124293785310733,0.2175141242937853,0.11581920903954801,0.04802259887005649 ,0.2175141242937853 ),c(6,2),list(CovidSeverity=lv1,Diarrhea=lv))

covid3 <- custom.fit(dag,list(
  Diarrhea=Diarrhea, Fatigue=Fatigue,Fever=Fever,Headache=Headache,LossOfTaste=LossOfTaste,MuscleSore=MuscleSore,RunnyNose=RunnyNose,Sob=Sob,SoreThroat=SoreThroat,Cough=Cough,CovidSeverity=CovidSeverity,LossOfSmell=LossOfSmell
  ))


usethis::use_data(covid3, overwrite = TRUE)


dag <- model2network("[Diarrhea|CovidSeverity:SoreThroat][Fatigue|CovidSeverity:MuscleSore][Fever|Cough:CovidSeverity][Headache|Cough:CovidSeverity][LossOfTaste|RunnyNose:CovidSeverity][LossOfSmell|LossOfTaste:CovidSeverity][MuscleSore|Headache:CovidSeverity][RunnyNose|CovidSeverity:Headache][Sob|CovidSeverity:Fever][SoreThroat|RunnyNose:CovidSeverity][Cough|CovidSeverity][CovidSeverity]")
lv <- c("1. 0", "2. 1")
lv1 <- c("1. 1", "2. 2", "3. 3", "4. 4", "5. 5", "6. 6")

LossOfSmell <- array(c(0.9740689175078315,1-0.9740689175078315,0.33710407239819,1-0.33710407239819,0.9297082228116711,1-0.9297082228116711,0.3536585365853658,1-0.3536585365853658,0.9615384615384616,1-0.9615384615384616,0.1470588235294118,1-0.1470588235294118,0.9844720496894409,1-0.9844720496894409,0.18831168831168832,1-0.18831168831168832,0.8529411764705883,1-0.8529411764705883,0.1470588235294118,1-0.1470588235294118,0.9377682403433477,1-0.9377682403433477,0.14356435643564355,1-0.14356435643564355),c(2,2,6),list(LossOfSmell=lv,LossOfTaste=lv,CovidSeverity=lv1))

Diarrhea <- array(c(0.9765829898838516,1-0.9765829898838516,0.8247058823529412,1-0.8247058823529412,0.9907063197026023,1-0.9907063197026023,0.9832214765100671,1-0.9832214765100671,0.06097560975609756,1-0.06097560975609756,0.06097560975609756,1-0.06097560975609756,0.7879999999999999,1-0.7879999999999999,0.8716814159292035,1-0.8716814159292035,0.8529411764705883,1-0.8529411764705883,0.1470588235294118,1-0.1470588235294118,0.930622009569378,1-0.930622009569378,0.5,0.5),c(2,2,6),list(Diarrhea=lv,SoreThroat=lv,CovidSeverity=lv1))

Fatigue <- array(c(0.916636528028933,1-0.916636528028933,0.4452887537993921,1-0.4452887537993921,0.9907063197026023,1-0.9907063197026023,0.9832214765100671,1-0.9832214765100671,0.9528301886792453,1-0.9528301886792453,0.9137931034482758,1-0.9137931034482758,0.03246753246753247,1-0.03246753246753247,0.015527950310559006,1-0.015527950310559006,0.1470588235294118,1-0.1470588235294118,0.1470588235294118,1-0.1470588235294118,0.700956937799043,1-0.700956937799043,0.212,1-0.212),c(2,2,6),list(Fatigue=lv,MuscleSore=lv,CovidSeverity=lv1))
Fever <- array(c(0.9933759707629054,1-0.9933759707629054,0.010729613733905581,1-0.010729613733905581,0.5,0.5,0.022123893805309734,1-0.022123893805309734,0.5,0.5,0.7376237623762376,1-0.7376237623762376,0.9707182320441989,1-0.9707182320441989,0.013513513513513513,1-0.013513513513513513,0.03246753246753247,1-0.03246753246753247,0.019999999999999997,1-0.019999999999999997,0.08620689655172413,1-0.08620689655172413,0.371244635193133,1-0.371244635193133),c(2,2,6),list(Fever=lv,Cough=lv,CovidSeverity=lv1))
Headache <- array(c(0.9111466423024212,1-0.9111466423024212,0.9377682403433477,1-0.9377682403433477,0.5,0.5,0.34070796460176994,1-0.34070796460176994,0.5,0.5,0.5,0.5,0.5729281767955801,1-0.5729281767955801,0.727027027027027,1-0.727027027027027,0.3441558441558442,1-0.3441558441558442,0.30800000000000005,1-0.30800000000000005,0.08620689655172413,1-0.08620689655172413,0.5257510729613734,1-0.5257510729613734),c(2,2,6),list(Headache=lv,Cough=lv,CovidSeverity=lv1))
LossOfTaste <- array(c(0.9509303174024079  ,1-0.9509303174024079  ,0.754957507082153,1-0.754957507082153,0.924929178470255,1-0.924929178470255,0.7769230769230769,1-0.7769230769230769,0.9390243902439024,1-0.9390243902439024,0.6463414634146342,1-0.6463414634146342,0.6621621621621622,1-0.6621621621621622,0.7264150943396226,1-0.7264150943396226,0.8529411764705883,1-0.8529411764705883,0.1470588235294118,1-0.1470588235294118,0.8347639484978541,1-0.8347639484978541,0.38118811881188125,1-0.38118811881188125),c(2,2,6),list(LossOfTaste=lv,RunnyNose=lv,CovidSeverity=lv1))
MuscleSore <- array(c(0.9464783127735774,1-0.9464783127735774,0.6652323580034423,1-0.6652323580034423,0.7209631728045326,1-0.7209631728045326,0.2230769230769231,1-0.2230769230769231,0.9137931034482758,1-0.9137931034482758,0.5,0.5,0.18831168831168832,1-0.18831168831168832,0.3881987577639751,1-0.3881987577639751,0.5,0.5,0.5,0.5,0.7774566473988439,1-0.7774566473988439,0.46273291925465837,1-0.46273291925465837),c(2,2,6),list(MuscleSore=lv,Headache=lv,CovidSeverity=lv1))
RunnyNose <- array(c(0.9321528054118583,1-0.9321528054118583,0.6858864027538726,1-0.6858864027538726,0.8229461756373938,1-0.8229461756373938,0.9615384615384616,1-0.9615384615384616,0.9137931034482758,1-0.9137931034482758,0.2735849056603773,1-0.2735849056603773,0.8116883116883117,1-0.8116883116883117,0.7608695652173912,1-0.7608695652173912,0.5,0.5,0.5,0.5,0.9161849710982659,1-0.9161849710982659,0.46273291925465837,1-0.46273291925465837),c(2,2,6),list(RunnyNose=lv,Headache=lv,CovidSeverity=lv1))
Sob <- array(c(0.9795283327874221,1-0.9795283327874221,0.06097560975609756,1-0.06097560975609756,0.5,0.5,0.9939467312348668,1-0.9939467312348668,0.5,0.5,0.9675324675324676,1-0.9675324675324676,0.5,0.5,0.9892703862660944,1-0.9892703862660944,0.5,0.5,0.08620689655172413,1-0.08620689655172413,0.015527950310559006,1-0.015527950310559006,0.014450867052023121,1-0.014450867052023121),c(2,2,6),list(Sob=lv,Fever=lv,CovidSeverity=lv1))
SoreThroat <- array(c(0.9509303174024079,1-0.9509303174024079,0.754957507082153,1-0.754957507082153,0.924929178470255,1-0.924929178470255,0.7769230769230769,1-0.7769230769230769,0.9390243902439024,1-0.9390243902439024,0.6463414634146342,1-0.6463414634146342,0.6621621621621622,1-0.6621621621621622,0.7264150943396226,1-0.7264150943396226,0.8529411764705883,1-0.8529411764705883,0.1470588235294118,1-0.1470588235294118,0.8347639484978541,1-0.8347639484978541,0.38118811881188125,1-0.38118811881188125),c(2,2,6),list(SoreThroat=lv,RunnyNose=lv,CovidSeverity=lv1))
Cough <- array(c(0.7074983839689722,1-0.7074983839689722,0.5574162679425837,1-0.5574162679425837,0.06097560975609756,1-0.06097560975609756,0.47478991596638653,1-0.47478991596638653,0.1470588235294118,1-0.1470588235294118,0.30239520958083826,1-0.30239520958083826), c(2,6), list(Cough=lv,CovidSeverity=lv1))
CovidSeverity <- array(c(0.736667,0.0995238,0.0195238,0.0566667,0.00809524,0.0795238),c(6),list(CovidSeverity=lv1))

covid2 <- custom.fit(dag,list(
  Diarrhea=Diarrhea, Fatigue=Fatigue,Fever=Fever,Headache=Headache,LossOfTaste=LossOfTaste,MuscleSore=MuscleSore,RunnyNose=RunnyNose,Sob=Sob,SoreThroat=SoreThroat,Cough=Cough,CovidSeverity=CovidSeverity,LossOfSmell=LossOfSmell
))


usethis::use_data(covid2, overwrite = TRUE)


dag <- model2network("[Diarrhea|CovidSeverity][Fatigue|CovidSeverity][Fever|CovidSeverity][Headache|CovidSeverity][LossOfTaste|CovidSeverity][LossOfSmell|CovidSeverity][MuscleSore|CovidSeverity][RunnyNose|CovidSeverity][Sob|CovidSeverity][SoreThroat|CovidSeverity][Cough|CovidSeverity][CovidSeverity]")
lv <- c("1. 0", "2. 1")
lv1 <- c("1. 1", "2. 2", "3. 3", "4. 4", "5. 5", "6. 6")


LossOfSmell <- array(c(0.9285714285714286,1-0.9285714285714286,0.8732057416267942,1-0.8732057416267942,0.7926829268292682,1-0.7926829268292682,0.726890756302521,1-0.726890756302521,0.5,0.5,0.6976047904191617,1-0.6976047904191617),c(2,6),list(LossOfSmell=lv,CovidSeverity=lv1))
Diarrhea <- array(c(0.9557207498383969,1-0.9557207498383969,0.9880382775119618,1-0.9880382775119618,0.06097560975609756,1-0.06097560975609756,0.8277310924369747,1-0.8277310924369747,0.5,0.5,0.7694610778443114,1-0.7694610778443114),c(2,6),list(Diarrhea=lv,CovidSeverity=lv1))
Fatigue  <- array(c(0.8665158371040724,1-0.8665158371040724,0.9880382775119618,1-0.9880382775119618,0.9880382775119618,1-0.9880382775119618,0.021008403361344536,1-0.021008403361344536,0.1470588235294118,1-0.1470588235294118,0.5179640718562875,1-0.5179640718562875),c(2,6),list(Fatigue =lv,CovidSeverity=lv1))
Fever <- array(c(0.986748545572075,1-0.986748545572075,0.01196172248803828,1-0.01196172248803828,0.06097560975609756,1-0.06097560975609756,0.021008403361344536,1-0.021008403361344536,0.1470588235294118,1-0.1470588235294118,0.4820359281437126,1-0.4820359281437126),c(2,6),list(Fever=lv,CovidSeverity=lv1))
Headache  <- array(c(0.8122171945701357,1-0.8122171945701357,0.8444976076555024,1-0.8444976076555024,0.3536585365853658,1-0.3536585365853658,0.3235294117647059,1-0.3235294117647059,0.1470588235294118,1-0.1470588235294118,0.5179640718562875,1-0.5179640718562875),c(2,6),list(Headache =lv,CovidSeverity=lv1))
LossOfTaste <- array(c(0.9285714285714286,1-0.9285714285714286,0.9019138755980861,1-0.9019138755980861,0.7926829268292682,1-0.7926829268292682,0.6764705882352942,1-0.6764705882352942,0.5,0.5,0.6976047904191617,1-0.6976047904191617),c(2,6),list(LossOfTaste=lv,CovidSeverity=lv1))
MuscleSore <- array(c(0.8936651583710408,1-0.8936651583710408,0.6435406698564593,1-0.6435406698564593,0.6463414634146342,1-0.6463414634146342,0.3235294117647059,1-0.3235294117647059,0.5,0.5,0.625748502994012,1-0.625748502994012),c(2,6),list(MuscleSore=lv,CovidSeverity=lv1))
RunnyNose <- array(c(0.8859082094376213,1-0.8859082094376213,0.8444976076555024,1-0.8444976076555024,0.5,0.5,0.7773109243697479,1-0.7773109243697479,0.5,0.5,0.6976047904191617,1-0.6976047904191617),c(2,6),list(RunnyNose=lv,CovidSeverity=lv1))
Sob  <- array(c(0.9673561732385262,1-0.9673561732385262,0.9880382775119618,1-0.9880382775119618,0.9390243902439024,1-0.9390243902439024,0.9789915966386554,1-0.9789915966386554,0.1470588235294118,1-0.1470588235294118,0.014970059880239521,1-0.014970059880239521),c(2,6),list(Sob =lv,CovidSeverity=lv1))
SoreThroat  <- array(c(0.8626373626373627,1-0.8626373626373627,0.6435406698564593,1-0.6435406698564593,0.5,0.5,0.5252100840336135,1-0.5252100840336135,0.5,0.5,0.625748502994012,1-0.625748502994012),c(2,6),list(SoreThroat =lv,CovidSeverity=lv1))
Cough <- array(c(0.7074983839689722,1-0.7074983839689722,0.5574162679425837,1-0.5574162679425837,0.06097560975609756,1-0.06097560975609756,0.47478991596638653,1-0.47478991596638653,0.1470588235294118,1-0.1470588235294118,0.30239520958083826,1-0.30239520958083826),c(2,6),list(Cough=lv,CovidSeverity=lv1))
CovidSeverity <- array(c(0.736667,0.0995238,0.0195238,0.0566667,0.00809524,0.0795238),c(6),list(CovidSeverity=lv1))

covid1 <- custom.fit(dag,list(
  Diarrhea=Diarrhea, Fatigue=Fatigue,Fever=Fever,Headache=Headache,LossOfTaste=LossOfTaste,MuscleSore=MuscleSore,RunnyNose=RunnyNose,Sob=Sob,SoreThroat=SoreThroat,Cough=Cough,CovidSeverity=CovidSeverity,LossOfSmell=LossOfSmell
))


usethis::use_data(covid1, overwrite = TRUE)

