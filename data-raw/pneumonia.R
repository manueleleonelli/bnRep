
library(bnlearn)

dag <- model2network("[BreathingDifficulty|UpperAirwayInvolvment:OxygenSaturation:CausativePathogenForPneumonia:CurrentPhenotype][CReactiveProteins|CausativePathogenForPneumonia:CurrentPhenotype][NeutrophilProportion|CausativePathogenForPneumonia:CurrentPhenotype][Cough|UpperAirwayInvolvment:CausativePathogenForPneumonia:CurrentPhenotype][EnergyLoss|CausativePathogenForPneumonia:CurrentPhenotype:ReducedOralIntake][DiagnosisBacterialPneumonia|BloodCultureResult:PleuralEffusion][WhiteCellCount|CausativePathogenForPneumonia:CurrentPhenotype][Crackles|CausativePathogenForPneumonia:CurrentPhenotype][Rash|CausativePathogenForPneumonia:CurrentPhenotype][ChillSweat|CausativePathogenForPneumonia:CurrentPhenotype:HighestTemperature][PleuralFluidResult|PleuralEffusion:CausativePathogenForPneumonia:AntibioticExposure][BloodCultureResult|BloodCulturePerformed:CausativePathogenForPneumonia:AntibioticExposure:PleuralEffusion][ReducedOralIntake|Vomiting:Diarrhoea:CausativePathogenForPneumonia:CurrentPhenotype:AgeGroup][Vomiting|CausativePathogenForPneumonia:CurrentPhenotype][Wheezing|ChronicRespiratoryDisease:CurrentPhenotype:UpperAirwayInvolvment:CausativePathogenForPneumonia:AgeGroup][Fever|CausativePathogenForPneumonia:CurrentPhenotype:AgeGroup][HighestTemperature|CausativePathogenForPneumonia:CurrentPhenotype:AgeGroup][OtherPain|CausativePathogenForPneumonia:CurrentPhenotype:AgeGroup][Rhinorrhoea|UpperAirwayInvolvment][SubjectGroup|CausativePathogenForPneumonia][Earache|UpperAirwayInvolvment:AgeGroup][AbdominalPain|CausativePathogenForPneumonia:PleuralEffusion:CurrentPhenotype:Diarrhoea][ChestPain|CausativePathogenForPneumonia:CurrentPhenotype:PleuralEffusion:AgeGroup][Diarrhoea|CausativePathogenForPneumonia:CurrentPhenotype][PleuralEffusion|CausativePathogenForPneumonia:CurrentPhenotype][BloodCulturePerformed|AgeGroup:HospitalTransfer][Irritable|CausativePathogenForPneumonia:CurrentPhenotype:AgeGroup][Headache|UpperAirwayInvolvment:CausativePathogenForPneumonia:CurrentPhenotype:AgeGroup][SoreThroat|UpperAirwayInvolvment:AgeGroup][UpperAirwayInvolvment|TypicalBacteriaInNasopharynx:ViralNasopharyngealInfection:ThroatInfection][RespiratoryRate|OxygenSaturation:CausativePathogenForPneumonia:CurrentPhenotype:AgeGroup][OxygenSaturation|CausativePathogenForPneumonia:CurrentPhenotype:O2Type][O2Type|CurrentPhenotype:CausativePathogenForPneumonia][CurrentPhenotype|SusceptibilityToProgression:HospitalTransfer:CausativePathogenForPneumonia:DurationOfSymptomsOnset][CausativePathogenForPneumonia|TypicalBacterialPneumonia:ViralLikePneumonia][TypicalBacterialPneumonia|ViralLikePneumonia:TypicalBacteriaInNasopharynx:PneumococcalVaccine:ThroatInfection:ViralNasopharyngealInfection:AgeGroup][ViralLikePneumonia|ThroatInfection:ViralNasopharyngealInfection:RSVInNasopharynx:HMPVInNasopharynx:InfluenzaInNasopharynx:ParainfluenzaInNasopharynx:MycoplasmaInNasopharynx][ThroatInfection|ViralNasopharyngealInfection:RSVInNasopharynx:HMPVInNasopharynx:InfluenzaInNasopharynx:ParainfluenzaInNasopharynx:MycoplasmaInNasopharynx][ViralNasopharyngealInfection|RSVInNasopharynx:HMPVInNasopharynx:InfluenzaInNasopharynx:ParainfluenzaInNasopharynx:MycoplasmaInNasopharynx][TypicalBacteriaInNasopharynx|PneumococcalVaccine:SusceptibilityToColonisation:LevelOfExposure:AntibioticExposure:AgeGroup][MycoplasmaInNasopharynx|LevelOfExposure:AgeGroup][ParainfluenzaInNasopharynx|LevelOfExposure:AgeGroup][InfluenzaInNasopharynx|InfluenzaVaccine:InfluenzaSeason:LevelOfExposure:AgeGroup][HMPVInNasopharynx|InfluenzaSeason:LevelOfExposure:AgeGroup][RSVInNasopharynx|InfluenzaSeason:LevelOfExposure:AgeGroup][InfluenzaSeason][AntibioticExposure|HospitalTransfer:AgeGroup:ImpairedImmunity][PreviousSignificantInfection|AgeGroup:SusceptibilityToColonisation:SusceptibilityToProgression][SusceptibilityToProgression|ChronicRespiratoryDisease:ImpairedImmunity:AgeGroup][ChronicRespiratoryDisease][DurationOfSymptomsOnset|AgeGroup:HospitalTransfer][HospitalTransfer|Ethnicity:AgeGroup][SusceptibilityToColonisation|ImpairedImmunity:SmokerInHousehold:AgeGroup][ImpairedImmunity][InfluenzaVaccine|Prematurity:AgeGroup:Ethnicity][PneumococcalVaccine|AgeGroup:Ethnicity][LevelOfExposure|Ethnicity:ChildcareDays:AgeGroup][ChildcareDays|AgeGroup:Ethnicity:Prematurity][AgeGroup][Ethnicity][SmokerInHousehold|Ethnicity][Prematurity|Ethnicity:SmokerInHousehold]")


lvNeutro <- c("Above 80","Between 50 and 80","Below 50")
lvAge <- c("School","PreSchool","Infant")
lvEthnic <- c("Indigenous","NonIndigenous")
lv <- c("Yes","No")
lvDays <- c("Five or more","Two to four","One or less")
lv1 <- c("High","Low")
lvVaccine <- c("UnderVax","FullyVax") #VACSPN2
vl <- c("No","Yes")
lv2 <- c("Reported","Unknown")
lvDuration <- c("More than one week","Three to seven days","One or two days")
lvAntibiotic <- c("Last day","Last week","No")
lv3 <- c("Positive","Negative")
lv4 <- c("Present","Absent")
lvCause <- c("TypicalBac","ViralLike","NoPneumonia")
lvType <- c("Type 1", "Type 2")
lvO2 <- c("Supp02","RoomAir")
lvOxy <- c("Below 92","Betwenn 92 and 95","Above 95")
lvRate <- c("Above 50","Between 30 and 50","Below 30")
lvUpper <- c("NP","Throat","NPAndThroat","No")
lv5 <- c("Recorded","Unknown")
lvGroup <- c("Case","Control")
lvTemp <- c("Above 39","Between 38 and 39", "Below 38")
lvResult <- c("Positive","Negative","NotDone")
lvWhite <- c("Above18","Between 10 and 18","Below10")
lvC <- c("Above 70","Between 30 and 70","Below 30")


AgeGroup <- array(c(0.3607503, 0.3217893, 0.3174603),3,list(AgeGroup=lvAge))
Ethnicity <- array(c(0.09740262, 0.9025974),2,list(Ethnicity=lvEthnic))
SmokerInHousehold <- array(c(0.4565218, 0.5434783 ,0.1363637 ,0.8636363),c(2,2),list(SmokerInHousehold=lv,Ethnicity=lvEthnic))
Prematurity <- array(c(0.3181821, 0.6818178, 0.1923082, 0.8076918 ,0.1551727, 0.8448274, 0.1298343, 0.8701657),c(2,2,2),list(Prematurity=lv,Ethnicity=lvEthnic,SmokerInHousehold=lv))
ChildcareDays <- array(c(0.1666692 ,0.1666692, 0.6666617, 0.7619029 ,0.04762027 ,0.1904768, 0.7037025, 0.1481488 ,0.1481488, 0.9613524 ,0.03381655,0.004831061 ,0.1111133 ,0.7777733, 0.1111133 ,0.1904768, 0.3333333, 0.4761899, 0.2592595, 0.3703702, 0.3703702, 0.141243 ,0.5310733 ,0.3276836, 0.1111133 ,0.1111133, 0.7777733, 0.2222228 ,0.3888886 ,0.3888886 ,0.1111117, 0.1944448 ,0.6944436 ,0.1309525 ,0.4523809, 0.4166666),c(3,3,2,2),list(ChildcareDays=lvDays,AgeGroup=lvAge,Ethnicity=lvEthnic,Prematurity=lv))
LevelOfExposure <- array(c(0.801, 0.199, 0.7595, 0.2405, 0.7141999999999999, 0.2858, 0.6655 ,0.3345, 0.614, 0.386, 0.5606, 0.4394 ,0.5058494 ,0.4941506 ,0.4508 ,0.5492, 0.3963, 0.6037 ,0.614 ,0.386, 0.5606 ,0.4394, 0.5058494, 0.4941506, 0.4508 ,0.5492, 0.3963 ,0.6037, 0.3433 ,0.6567 ,0.2926 ,0.7074, 0.245 ,0.755, 0.2012, 0.7988),dim=c(2,2,3,3),list(LevelOfExposure=lv1,Ethnicity=lvEthnic,ChildcareDays=lvDays,AgeGroup=lvAge))
PneumococcalVaccine <- array(c(0.1875008, 0.8124992 ,0.2272728, 0.7727271999999999 ,0.05555655, 0.9444435, 0.1268658, 0.8731343 ,0.4375 ,0.5625, 0.1119404, 0.8880595999999999),c(2,3,2),list(PneumococcalVaccine=lvVaccine,AgeGroup=lvAge,Ethnicity=lvEthnic))
InfluenzaVaccine <- array(c(0.7499975, 0.2500025, 0.8333326 ,0.1666674 ,0.5, 0.5, 0.8333326, 0.1666674, 0.8333311, 0.1666689, 0.7916662, 0.2083338, 0.9285702, 0.0714298, 0.9347825 ,0.06521752, 0.7857135, 0.2142865, 0.8389829,0.1610171, 0.7499992, 0.2500008, 0.9196427, 0.08035729),c(2,2,3,2),list(InfluenzaVaccine=vl,Prematurity=lv,AgeGroup=lvAge,Ethnicity=lvEthnic))
ImpairedImmunity <- array(c(0.04978359, 0.9502164),2,list(ImpairedImmunity=lv2))
SusceptibilityToColonisation  <- array(c(0.6655, 0.3345, 0.7373 ,0.2627, 0.8008999999999999, 0.1991, 0.5059 ,0.4941, 0.5875 ,0.4125 ,0.6655 ,0.3345, 0.3433, 0.6567,0.4234, 0.5766 ,0.5059, 0.4941, 0.2012, 0.7988, 0.2684 ,0.7316, 0.3433 ,0.6567),c(2,2,2,3),list(SusceptibilityToColonisation=lv1,ImpairedImmunity=lv2,SmokerInHousehold=lv,AgeGroup=lvAge))
HospitalTransfer <- array(c(0.1875008 ,0.8124992 ,0.3888891 ,0.6111109 ,0.1875008, 0.8124992, 0.1363637, 0.8636363 ,0.1417911 ,0.8582088, 0.05223894, 0.9477611),c(2,2,3),list(HospitalTransfer=lv,Ethnicity=lvEthnic,AgeGroup=lvAge))
DurationOfSymptomsOnset <- array(c(0.6944435 ,0.2777779 ,0.02777854, 0.3881278 ,0.3881278, 0.2237443, 0.6410249, 0.2564104, 0.1025646, 0.2592593, 0.5925925, 0.1481482, 0.2666671, 0.4666659, 0.2666671 ,0.2619048 ,0.5761904 ,0.1619048),c(3,3,2),list(DurationOfSymptomsOnset=lvDuration,AgeGroup=lvAge,HospitalTransfer=lv))
ChronicRespiratoryDisease <- array(c(0.04112558, 0.9588744),2,list(ChronicRespiratoryDisease=lv2))
SusceptibilityToProgression <- array(c(0.6607 ,0.3393 ,0.7994, 0.2006, 0.8991 ,0.1009, 0.3359 ,0.6641, 0.498 ,0.502 ,0.6607 ,0.3393, 0.3359, 0.6641, 0.498, 0.502, 0.6607 ,0.3393, 0.1, 0.9, 0.1985, 0.8015 ,0.3359 ,0.6641),c(2,2,2,3),list(SusceptibilityToProgression=lv1,ChronicRespiratoryDisease=lv2,ImpairedImmunity=lv2,AgeGroup=lvAge))
PreviousSignificantInfection <- array(c(0.5579422000000001 ,0.4420578 ,0.7567518, 0.2432481 ,0.5233819 ,0.4766181 ,0.1714632, 0.8285368, 0.7250283 ,0.2749717, 0.5744139 ,0.4255861, 0.4047153 ,0.5952847 ,0.1626692, 0.8373308, 0.2691395, 0.7308605, 0.2186787 ,0.7813213, 0.475694,0.524306, 0.3635187, 0.6364813),c(2,3,2,2),list(PreviousSignificantInfection=lv2,AgeGroup=lvAge,SusceptibilityToColonisation=lv1,SusceptibilityToProgression=lv1))
AntibioticExposure <- array(c(0.3333333, 0.3333333 ,0.3333333, 0.7777767 ,0.02777854, 0.1944448 ,0.6666617 ,0.1666692,0.1666692, 0.4444442, 0.02777854, 0.5277773, 0.3333333, 0.3333333, 0.3333333, 0.6666647, 0.06666825999999999, 0.2666671, 0.7222203, 0.05555694, 0.2222228 ,0.4460784, 0.07843149000000001, 0.4754901, 0.4666659, 0.06666825999999999 ,0.4666659 ,0.2937853, 0.09039561, 0.615819 ,0.6666617 ,0.1666692, 0.1666692, 0.294686, 0.1062803, 0.5990337),c(3,2,3,2),list(AntibioticExposure=lvAntibiotic,HospitalTransfer=lv,AgeGroup=lvAge,ImpairedImmunity=lv2))
InfluenzaSeason <- array(c(0.465368 ,0.534632),2,list(InfluenzaSeason=vl))
RSVInNasopharynx <- array(c(0.03926136 ,0.9607386999999999 ,0.1900547, 0.8099453 ,0.6801507, 0.3198493, 0.002801016 ,0.9971989999999999 ,0.009850836999999999, 0.9901491, 0.005450159, 0.9945498, 0.1267663, 0.8732337, 0.1304636, 0.8695364 ,0.9069048 ,0.09309524 ,0.01086282 ,0.9891372 ,0.513037 ,0.486963 ,0.2512858 ,0.7487141),c(2,2,2,3),list(RSVInNasopharynx=lv3,InfluenzaSeason=vl,LevelOfExposure=lv1,AgeGroup=lvAge))
HMPVInNasopharynx <- array(c(0.005038579, 0.9949614, 0.05597429, 0.9440257 ,0.009827136 ,0.9901729, 0.05606302, 0.943937, 0.03412544, 0.9658746, 0.1502052, 0.8497949 ,0.1599907 ,0.8400093 ,0.335255 ,0.664745 ,0.01289513, 0.9871049 ,0.0219254, 0.9780746 ,0.01337935 ,0.9866207 ,0.3503273, 0.6496727),c(2,2,2,3),list(HMPVInNasopharynx=lv3,InfluenzaSeason=vl,LevelOfExposure=lv1,AgeGroup=lvAge))
InfluenzaInNasopharynx<- array(c(0.00634028, 0.9936597, 0.04282159, 0.9571784 ,0.01038355, 0.9896165 ,0.06356141 ,0.9364386, 0.05101679, 0.9489832, 0.04099298, 0.9590070000000001 ,0.01631814 ,0.9836819 ,0.381218 ,0.6187820000000001 ,0.07376903999999999 ,0.926231 ,0.3008136, 0.6991864, 0.01170281, 0.9882972, 0.06563818, 0.9343618 ,0.02447549, 0.9755245 ,0.02523052, 0.9747695, 0.02657878 ,0.9734212 ,0.008457811000000001 ,0.9915422, 0.01144733, 0.9885527 ,0.01094367 ,0.9890563 ,0.06108363, 0.9389164 ,0.02055451, 0.9794455, 0.09184900999999999, 0.908151 ,0.05796071, 0.9420393, 0.01162665, 0.9883733, 0.01278593, 0.9872141),c(2,2,2,2,3),list(InfluenzaInNasopharynx=lv3,InfluenzaVaccine=vl,InfluenzaSeason=vl,LevelOfExposure=lv1,AgeGroup=lvAge))
ParainfluenzaInNasopharynx <- array(c(0.03120656 ,0.9687935, 0.06795287, 0.9320471, 0.006606346 ,0.9933937, 0.04611722 ,0.9538828, 0.06763972, 0.9323603, 0.1295852, 0.8704149),c(2,2,3),list(ParainfluenzaInNasopharynx=lv3,LevelOfExposure=lv1,AgeGroup=lvAge))
MycoplasmaInNasopharynx<- array(c(0.3653027, 0.6346973, 0.005162972, 0.994837, 0.003779552, 0.9962205 ,0.008596147, 0.9914039 ,0.04338311, 0.9566169,0.06612328000000001, 0.9338768),c(2,2,3),list(MycoplasmaInNasopharynx=lv3,LevelOfExposure=lv1,AgeGroup=lvAge))
TypicalBacteriaInNasopharynx <- array(c(0.510244,0.489756,0.7422079,0.2577921,0.6079037,0.3920963,0.7820549999999999,0.217945,0.8760764,0.1239236,0.900492,0.09950800999999999,0.7701259,0.2298741,0.8637087,0.1362913,0.9365798,0.06342022999999999,0.517293,0.4827069,0.5487007,0.4512993,0.6452081,0.3547919,0.6700733,0.3299267,0.7391933000000001,0.2608067,0.800494,0.199506,0.5503274,0.4496725,0.8421362999999999,0.1578637,0.6520995000000001,0.3479005,0.4558861,0.5441139,0.5973741,0.4026259,0.3868124,0.6131876000000001,0.2693026,0.7306973,0.7794945,0.2205055,0.6703966,0.3296034,0.3484741,0.6515259,0.7683335,0.2316665,0.8272772,0.1727227,0.6244431,0.375557,0.288746,0.7112540000000001,0.6076317,0.3923683,0.3924453,0.6075547,0.4679019,0.5320981,0.5291994,0.4708006,0.2355134,0.7644866,0.8233878,0.1766122,0.5782982,0.4217018,0.5909504,0.4090496,0.6065263,0.3934737,0.9126174,0.08738259,0.5789415999999999,0.4210583,0.7366229,0.2633772,0.9196007,0.08039929,0.8795205,0.1204795,0.7105082,0.2894918,0.8928293,0.1071707,0.3732478,0.6267523,0.5301113,0.4698887,0.6371468,0.3628532,0.4289496,0.5710504,0.5484478,0.4515522,0.710201,0.289799,0.7679785,0.2320214,0.7140552999999999,0.2859447,0.8000715,0.1999285,0.3919987,0.6080013,0.7130087000000001,0.2869913,0.8799701,0.1200299,0.3601826,0.6398175,0.589317,0.410683,0.8676093,0.1323908,0.5274255,0.4725745,0.8098823000000001,0.1901177,0.6892862,0.3107138,0.04938743,0.9506125,0.3272059,0.6727941,0.6290326000000001,0.3709674,0.1563377,0.8436623,0.1825964,0.8174036,0.2239325,0.7760675,0.8359818,0.1640182,0.7749269,0.2250731,0.8759606,0.1240394),c(2,2,2,2,3,3),list(TypicalBacteriaInNasopharynx=lv,PneumococcalVaccine=lvVaccine,SusceptibilityToColonisation=lv1,LevelOfExposure=lv1,AntibioticExposure=lvAntibiotic,AgeGroup=lvAge))
ViralNasopharyngealInfection <- array(c(0.3800024 ,0.6199976, 0.3800024, 0.6199976 ,0.3800024, 0.6199976 ,0.650938, 0.349062 ,0.3800024 ,0.6199976, 0.3800024, 0.6199976 ,0.3800024, 0.6199976 ,0.3800024, 0.6199976 ,0.3800024, 0.6199976 ,0.3800024, 0.6199976, 0.3800024, 0.6199976 ,0.6805566, 0.3194434 ,0.3800024, 0.6199976 ,0.6812367, 0.3187633, 0.1909948, 0.8090052, 0.7406558, 0.2593442, 0.2800044 ,0.7199956 ,0.2800044, 0.7199956 ,0.2800044, 0.7199956 ,0.2800044, 0.7199956 ,0.2800044, 0.7199956, 0.2124888, 0.7875112 ,0.1405935, 0.8594065 ,0.8707598 ,0.1292402, 0.250005 ,0.749995, 0.250005, 0.749995 ,0.250005, 0.749995, 0.8867441 ,0.1132559 ,0.06751361, 0.9324864, 0.6347499, 0.3652501 ,0.007542826 ,0.9924572, 0.5074272 ,0.4925728),rep(2,6),list(ViralNasopharyngealInfection=lv4,RSVInNasopharynx=lv3,HMPVInNasopharynx=lv3,InfluenzaInNasopharynx=lv3,ParainfluenzaInNasopharynx=lv3,MycoplasmaInNasopharynx=lv3))
ThroatInfection  <- array(c(0.8549928999999999,0.1450071,0.8549928999999999,0.1450071,0.8549928999999999,0.1450071,0.8947229,0.1052771,0.8549928999999999,0.1450071,0.8549928999999999,0.1450071,0.8549928999999999,0.1450071,0.8549928999999999,0.1450071,0.8549928999999999,0.1450071,0.8549928999999999,0.1450071,0.8549928999999999,0.1450071,0.9127375,0.08726245000000001,0.8549928999999999,0.1450071,0.9177896,0.08221037,0.8540232,0.1459769,0.9904188,0.009581189,0.4746005,0.5253995,0.4746005,0.5253995,0.4746005,0.5253995,0.4746005,0.5253995,0.4746005,0.5253995,0.4634355,0.5365645,0.4751846,0.5248153,0.9024183,0.09758174,0.3750025,0.6249975,0.3750025,0.6249975,0.3750025,0.6249975,0.04604308,0.9539569,0.3005013,0.6994987,0.8723066,0.1276934,0.1623395,0.8376606,0.001503288,0.9984967,0.3800024,0.6199976,0.3800024,0.6199976,0.3800024,0.6199976,0.3960941,0.6039059,0.3800024,0.6199976,0.3800024,0.6199976,0.3800024,0.6199976,0.3800024,0.6199976,0.3800024,0.6199976,0.3800024,0.6199976,0.3800024,0.6199976,0.3844757,0.6155242,0.3800024,0.6199976,0.3862585,0.6137416,0.1947947,0.8052053,0.0588662,0.9411338,0.2800044,0.7199956,0.2800044,0.7199956,0.2800044,0.7199956,0.2800044,0.7199956,0.2800044,0.7199956,0.6040522,0.3959478,0.1411282,0.8588719,0.1441674,0.8558326000000001,0.250005,0.749995,0.250005,0.749995,0.250005,0.749995,0.1771061,0.8228939,0.3920027,0.6079972,0.06044136,0.9395586,0.1956692,0.8043308,0.0009902572000000001,0.9990097),rep(2,7),list(ThroatInfection=lv4,ViralNasopharyngealInfection=lv4,RSVInNasopharynx=lv3,HMPVInNasopharynx=lv3,InfluenzaInNasopharynx=lv3,ParainfluenzaInNasopharynx=lv3,MycoplasmaInNasopharynx=lv3))
ViralLikePneumonia <- array(c(0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.9356357,0.06436425,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.9384912,0.06150881,0.8799924,0.1200076,0.9388794,0.06112058,0.8800789999999999,0.119921,0.9967455,0.003254553,0.6599968000000001,0.3400032,0.6599968000000001,0.3400032,0.6599968000000001,0.3400032,0.6599968000000001,0.3400032,0.6599968000000001,0.3400032,0.6780327,0.3219673,0.6603856,0.3396144,0.9814672,0.01853275,0.549999,0.450001,0.549999,0.450001,0.549999,0.450001,0.6450361999999999,0.3549638,0.4407049,0.5592951,0.9248391,0.07516095,0.2238954,0.7761046,0.1175699,0.8824301,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8853832,0.1146168,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8813812,0.1186189,0.8799924,0.1200076,0.8815333,0.1184666,0.8810836,0.1189164,0.9144918,0.08550824,0.6599968000000001,0.3400032,0.6599968000000001,0.3400032,0.6599968000000001,0.3400032,0.6599968000000001,0.3400032,0.6599968000000001,0.3400032,0.8152674,0.1847326,0.6607034000000001,0.3392966,0.7094047999999999,0.2905952,0.549999,0.450001,0.549999,0.450001,0.549999,0.450001,0.5888196,0.4111803,0.7164547,0.2835453,0.4691091,0.5308909000000001,0.8426215,0.1573785,0.1125399,0.8874602,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8864978999999999,0.1135021,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8799924,0.1200076,0.8832211,0.1167788,0.8799924,0.1200076,0.8821045,0.1178956,0.8801433,0.1198567,0.9010581,0.09894185,0.6599968000000001,0.3400032,0.6599968000000001,0.3400032,0.6599968000000001,0.3400032,0.6599968000000001,0.3400032,0.6599968000000001,0.3400032,0.6877692,0.3122307,0.6600087,0.3399913,0.8585967,0.1414033,0.549999,0.450001,0.549999,0.450001,0.549999,0.450001,0.9670442,0.03295582,0.4407135,0.5592865,0.565354,0.434646,0.2521785,0.7478216,0.9839421,0.01605789,0.799994,0.200006,0.799994,0.200006,0.799994,0.200006,0.8060125,0.1939875,0.799994,0.200006,0.799994,0.200006,0.799994,0.200006,0.799994,0.200006,0.799994,0.200006,0.799994,0.200006,0.799994,0.200006,0.8009735,0.1990265,0.799994,0.200006,0.8005177999999999,0.1994822,0.8892072,0.1107928,0.9688385,0.03116148,0.599998,0.400002,0.599998,0.400002,0.599998,0.400002,0.599998,0.400002,0.599998,0.400002,0.6057059,0.3942941,0.7996591,0.200341,0.8618777,0.1381223,0.5,0.5,0.5,0.5,0.5,0.5,0.6549369,0.3450631,0.7033055,0.2966945,0.8309602,0.1690398,0.9298398,0.07016014,0.6520899999999999,0.3479101),rep(2,8),list(ViralLikePneumonia=lv4,ThroatInfection=lv4,ViralNasopharyngealInfection=lv4,RSVInNasopharynx=lv3,HMPVInNasopharynx=lv3,InfluenzaInNasopharynx=lv3,ParainfluenzaInNasopharynx=lv3,MycoplasmaInNasopharynx=lv3))
TypicalBacterialPneumonia <- array(c(0.04426878,0.9557312,0.3282125,0.6717875,0.09085741999999999,0.9091426,0.02482018,0.9751799,0.0302624,0.9697376,0.0407626,0.9592374,0.009471873,0.9905281,0.5469885,0.4530115,0.2896748,0.7103252,0.7725034,0.2274966,0.0910045,0.9089955,0.02680395,0.9731959999999999,0.5724725000000001,0.4275276,0.001785601,0.9982143999999999,0.05883216,0.9411678,0.005198719,0.9948013,0.01543839,0.9845616,0.01162305,0.988377,0.1968219,0.8031781,0.392824,0.6071761,0.5539229,0.4460771,0.1234848,0.8765152,0.1322101,0.8677899,0.8024655000000001,0.1975345,0.01481841,0.9851816,0.01830786,0.9816921,0.4997732,0.5002268,0.4955178,0.5044822,0.01260977,0.9873902,0.01546654,0.9845335,0.003501396,0.9964986,0.01372313,0.9862769,0.007782674,0.9922173,0.06759554,0.9324045,0.4710175,0.5289825,0.006137942,0.993862,0.005580984,0.9944190000000001,0.002712161,0.9972877999999999,0.003394846,0.9966052,0.004041792,0.9959582,0.008931919,0.9910681,0.006149416,0.9938506,0.4932809,0.5067191,0.3878685,0.6121315000000001,0.006848864,0.9931511,0.001823278,0.9981767,0.008696933,0.9913031,0.002737639,0.9972624,0.01495401,0.985046,0.02076028,0.9792397,0.02340055,0.9765995,0.01114367,0.9888563,0.01267262,0.9873274,0.01497192,0.9850281,0.01151677,0.9884833,0.01476914,0.9852309,0.01584588,0.9841541,0.3419607,0.6580393,0.4112336,0.5887664,0.4512587,0.5487413,0.01244694,0.9875531,0.01444754,0.9855524,0.01790568,0.9820943,0.009446026,0.990554,0.0100113,0.9899887000000001,0.01135038,0.9886496,0.01231811,0.9876819,0.01541983,0.9845802,0.01580022,0.9842,0.7989082,0.2010918,0.6445913,0.3554087,0.5223582,0.4776417,0.009392187,0.9906078,0.009910047999999999,0.99009,0.01108426,0.9889157,0.01355982,0.9864402,0.008809966000000001,0.99119,0.009243416000000001,0.9907566,0.008765360999999999,0.9912347,0.008821712000000001,0.9911783,0.009232964999999999,0.9907671,0.6335641,0.3664359,0.09460908,0.9053909,0.008864834,0.9911352,0.008658535,0.9913415,0.008962606999999999,0.9910374,0.009257675999999999,0.9907423,0.008855299000000001,0.9911447,0.008709626,0.9912904,0.008638710000000001,0.9913613,0.009967838,0.9900321,0.01073059,0.9892694,0.009304167,0.9906958,0.8559814,0.1440186,0.6905274,0.3094726,0.009873689999999999,0.9901263),c(2,2,2,2,2,2,3),list(TypicalBacterialPneumonia=lv4,ViralLikePneumonia=lv4,TypicalBacteriaInNasopharynx=lv,PneumococcalVaccine=lvVaccine,ThroatInfection=lv4,ViralNasopharyngealInfection=lv4,AgeGroup=lvAge))
CausativePathogenForPneumonia <- array(c(1,0,0,1,0,0,0,1,0,0,0,1),c(3,2,2),list(CausativePathogenForPneumonia=lvCause, TypicalBacterialPneumonia=lv4,ViralLikePneumonia=lv4))
CurrentPhenotype <- array(c(.6240726, 0.3759274 ,0.7113832 ,0.2886168, 0.6318994 ,0.3681006, 0.7278603, 0.2721397, 0.7702287, 0.2297713,0.8260845999999999, 0.1739154, 0.799994, 0.200006 ,0.799994 ,0.200006, 0.799994 ,0.200006, 0.1526786, 0.8473214 ,0.1196257 ,0.8803743000000001, 0.4920968 ,0.5079032 ,0.2497558, 0.7502443 ,0.07218832, 0.9278117, 0.4486566, 0.5513434, 0.599998 ,0.400002 ,0.599998, 0.400002 ,0.599998, 0.400002 ,0.2540576,0.7459424 ,0.1493809, 0.8506191 ,0.3465625 ,0.6534375 ,0.1535487 ,0.8464513 ,0.3841796,0.6158204, 0.7825204 ,0.2174797,0.599998, 0.400002, 0.599998, 0.400002 ,0.599998, 0.400002 ,0.07860101 ,0.921399, 0.06117915, 0.9388208 ,0.1637857 ,0.8362143 ,0.08596432 ,0.9140357, 0.09783512 ,0.9021649, 0.02966398, 0.970336, 0.200006, 0.799994 ,0.200006, 0.799994, 0.200006, 0.799994),c(2,2,2,3,3),list(CurrentPhenotype=lvType,SusceptibilityToProgression=lv1,HospitalTransfer=lv,CausativePathogenForPneumonia=lvCause,DurationOfSymptomsOnset=lvDuration))
O2Type <- array(c(0.3880154, 0.6119847, 0.2370936, 0.7629064, 0.5, 0.5 ,0.1108335, 0.8891665, 0.01677646 ,0.9832236, 0.5, 0.5),c(2,2,3),list(O2Type=lvO2,CurrentPhenotype=lvType,CausativePathogenForPneumonia=lvCause))
OxygenSaturation <- array(c(0.2874959, 0.3874931, 0.325011, 0.3654507 ,0.2562492, 0.3783, 0.002845177, 0.0327046, 0.9644502, 0.1171553 ,0.2485204 ,0.6343243, 0.2340033 ,0.2960039, 0.4699928 ,0.2149486, 0.5625833 ,0.2224682, 0.006743947 ,0.06066857, 0.9325875 ,0.171627, 0.3880411, 0.4403319 ,0.0001099967 ,0.00100997, 0.99888, 0.0001099967, 0.00100997, 0.99888, 0.0001099967, 0.00100997 ,0.99888 ,0.0001099967 ,0.00100997 ,0.99888),c(3,3,2,2),list(OxygenSaturation=lvOxy,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType,O2Type=lvO2))
RespiratoryRate <- array(c(0.6750205,0.2999766,0.02500282,0.5499961,0.4099954,0.04000855,0.8899944,0.1033356,0.006669933,0.05949781,0.5963224,0.3441797,0.759379,0.2189342,0.02168683,0.7265628,0.2569872,0.01645,0.4499698,0.200012,0.3500183,0.5166639,0.4699995,0.01333656,0.6699899,0.3100007,0.0200094,0.25799,0.4047152,0.3372948,0.1557844,0.7402324,0.1039832,0.6211793,0.3765426,0.002278097,0.3499995,0.599992,0.0500085,0.5499935,0.4099977,0.04000879,0.6699899,0.3100007,0.0200094,0.3499995,0.599992,0.0500085,0.5499935,0.4099977,0.04000879,0.6699899,0.3100007,0.0200094,0.06619663000000001,0.5862901,0.3475133,0.3994785,0.550578,0.04994351,0.4999956,0.4899947,0.01000969,0.02984213,0.7644479,0.20571,0.09606895,0.6827261,0.2212049,0.5535142,0.4435256,0.00296023,0.04419107,0.7308414,0.2249675,0.2860747,0.6999198,0.01400556,0.7899929999999999,0.1900023,0.02000471,0.06439569000000001,0.2030236,0.7325807,0.1767859,0.5061095,0.3171046,0.3979852,0.5030015,0.09901324,0.2100037,0.7299881,0.06000819,0.4099977,0.5299941,0.0600082,0.5499935,0.4299971,0.0200094,0.2100037,0.7299881,0.06000819,0.4099977,0.5299941,0.0600082,0.5499935,0.4299971,0.0200094,0.05004424,0.8732231,0.07673272,0.6650066,0.2649919,0.07000145000000001,0.4799956,0.4499965,0.0700079,0.08733261,0.6232105,0.2894569,0.07905283,0.5300844,0.3908628,0.3855689,0.4580095,0.1564216,0.109867,0.8302033,0.05992972,0.3574885,0.6250088,0.01750268,0.7899931,0.1900022,0.0200047,0.002923635,0.1079219,0.8891545,0.2603764,0.5874568999999999,0.1521667,0.3825969,0.4980248,0.1193784,0.0100097,0.499995,0.4899953,0.0500085,0.5499935,0.399998,0.100007,0.6499905,0.2500025,0.0100097,0.499995,0.4899953,0.0500085,0.5499935,0.399998,0.100007,0.6499905,0.2500025),c(3,3,3,2,3),list(RespiratoryRate=lvRate,OxygenSaturation=lvOxy,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType,AgeGroup=lvAge))
UpperAirwayInvolvment <- array(c(0, 0, 1, 0, 0.95 ,0 ,0.05, 0 ,0, 0.95, 0.05, 0 ,0.02 ,0.02 ,0.01, 0.95 ,0, 0, 1, 0, 1, 0, 0 ,0, 0, 0, 1 ,0 ,0 ,0, 0, 1),c(4,2,2,2),list(UpperAirwayInvolvment=lvUpper,TypicalBacteriaInNasopharynx=lv,ViralNasopharyngealInfection=lv4,ThroatInfection=lv4))
SoreThroat <- array(c(0.002056355, 0.9979436 ,0.001466704 ,0.9985333, 0.0004392629, 0.9995607 ,0.8928286 ,0.1071714 ,0.4733817, 0.5266183 ,0.1468323, 0.8531677 ,0.2067763, 0.7932237, 0.1716603 ,0.8283397, 0.03435494 ,0.9656451, 0.1030005 ,0.8969994999999999, 3.921311e-05 ,0.9999608 ,7.126688e-05 ,0.9999287),c(2,4,3),list(SoreThroat=lv5,UpperAirwayInvolvment=lvUpper,AgeGroup=lvAge))
Headache <- array(c(0.2353102,0.7646898,0.5954695,0.4045305,0.08948842999999999,0.9105116,0.3134799,0.68652,0.1008372,0.8991628,0.008877408999999999,0.9911226,0.4535293,0.5464707,0.06794374,0.9320562,0.1717483,0.8282517,0.1871762,0.8128238,0.008662606,0.9913374,0.005716042,0.9942839999999999,0.050009,0.949991,0.0350093,0.9649907,0.0100098,0.9899902,0.050009,0.949991,0.0350093,0.9649907,0.0100098,0.9899902,0.2424864,0.7575136,0.2004142,0.7995858,0.166572,0.8334279999999999,0.1271312,0.8728688,0.09375528,0.9062447,0.06775916,0.9322408,0.2315058,0.7684942,0.212627,0.787373,0.1713155,0.8286844,0.6712947,0.3287053,0.07916299,0.920837,0.03653111,0.9634689,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.2424936,0.7575064,0.2042293,0.7957707000000001,0.08133932000000001,0.9186607,0.02589711,0.9741029,0.04982933,0.9501707,0.3299196,0.6700804,0.2141082,0.7858918,0.1843214,0.8156785,0.05779219,0.9422078,0.6002315,0.3997684,0.004919503,0.9950805,0.002600986,0.997399,0.050009,0.949991,0.0350093,0.9649907,0.0100098,0.9899902,0.050009,0.949991,0.0350093,0.9649907,0.0100098,0.9899902,0.3801861,0.6198139,0.2116134,0.7883866,0.1590682,0.8409318,0.08586574,0.9141343,0.0123027,0.9876973,0.01110849,0.9888915,0.07317828999999999,0.9268217,0.4159879,0.5840121,0.1712859,0.8287141,0.2607524,0.7392476,0.06737476000000001,0.9326252,0.01027112,0.9897289,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902),c(2,4,3,2,3),list(Headache=lv5,UpperAirwayInvolvment=lvUpper,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType,AgeGroup=lvAge))
Irritable <- array(c(0.1123666,0.8876334,0.398926,0.601074,0.2996679,0.7003321,0.01528217,0.9847178,0.02553595,0.9744641000000001,0.03621484,0.9637852,0.1912401,0.8087599,0.0670201,0.9329799,0.6026662,0.3973338,0.02426187,0.9757381000000001,0.07173619000000001,0.9282638,0.009576503,0.9904235,0.100008,0.899992,0.150007,0.849993,0.250005,0.749995,0.100008,0.899992,0.150007,0.849993,0.250005,0.749995),c(2,3,2,3),list(Irritable=lv5,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType,AgeGroup=lvAge))
BloodCulturePerformed <- array(c(0.291667, 0.708333, 0.6506849, 0.3493151, 0.3461541, 0.6538459 ,0.8333333000000001 ,0.1666668, 0.5, 0.5, 0.8071428, 0.1928572),c(2,3,2),list(BloodCulturePerformed=lv,AgeGroup=lvAge,HospitalTransfer=lv))
PleuralEffusion <- array(c(.929922, 0.07007802 ,0.1883328, 0.8116672, 0.160281, 0.8397191000000001, 0.01377018, 0.9862298 ,0.001039917 ,0.9989601, 0.001039917, 0.9989601),c(2,3,2),list(PleuralEffusion=lv,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType))
Diarrhoea  <- array(c(0.6005571, 0.3994429 ,0.2414514, 0.7585486, 0.4414151 ,0.5585849000000001 ,0.2375768, 0.7624232, 0.0100098 ,0.9899902, 0.0100098, 0.9899902),c(2,3,2),list(Diarrhoea =lv5,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType))
ChestPain <- array(c(0.2492166,0.7507834,0.242744,0.757256,0.1572023,0.8427977,0.2180581,0.7819419,0.1951508,0.8048491,0.1764062,0.8235937,0.07432878,0.9256712,0.2038476,0.7961524,0.4077018,0.5922982,0.07140516,0.9285948000000001,0.009670124,0.9903299,0.006128347,0.9938716,0.1493758,0.8506242000000001,0.2128604,0.7871396000000001,0.4077018,0.5922982,0.191008,0.808992,0.01409202,0.985908,0.03709947,0.9629005,0.1869678,0.8130322,0.1758098,0.8241901,0.3323034,0.6676967,0.03957564,0.9604244,0.0235092,0.9764908,0.001175464,0.9988245,0.150007,0.849993,0.100008,0.899992,0.050009,0.949991,0.00100998,0.99899,0.00100998,0.99899,0.00100998,0.99899,0.150007,0.849993,0.100008,0.899992,0.050009,0.949991,0.00100998,0.99899,0.00100998,0.99899,0.00100998,0.99899),c(2,3,2,2,3),list(ChestPain=lv5, CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType,PleuralEffusion=lv,AgeGroup=lvAge))
AbdominalPain <- array(c(0.9752796,0.02472036,0.9390929,0.0609071,0.4275507,0.5724493,0.2447432,0.7552568,0.6826875,0.3173125,0.8170468,0.1829532,0.8068939000000001,0.1931061,0.2556063,0.7443936,0.7271223999999999,0.2728775,0.4244274,0.5755726,0.4947166,0.5052834,0.4175017,0.5824984,0.7428609,0.2571391,0.6938945,0.3061055,0.6457971,0.3542029,0.4402849,0.5597152,0.3721004,0.6278996,0.3143045,0.6856955,0.4009909,0.5990092,0.129645,0.870355,0.1972222,0.8027778,0.09956226999999999,0.9004377,0.6683163,0.3316837,0.1809561,0.8190439,0.9341928,0.06580722,0.8410233,0.1589767,0.8117937,0.1882063,0.8312567,0.1687433,0.3031261,0.6968738,0.551799,0.448201,0.8760462,0.1239538,0.7038571,0.2961429,0.6570969,0.3429031,0.4502078,0.5497922,0.1952887,0.8047113,0.3275034,0.6724966,0.1689093,0.8310907,0.9045419,0.09545808,0.2823022,0.7176978000000001,0.4499059,0.5500941,0.2140512,0.7859489,0.6156486,0.3843514,0.3101564,0.6898436,0.4710471,0.5289528,0.1248023,0.8751976,0.5118958,0.4881042,0.1810093,0.8189907,0.03011153,0.9698884,0.9005919999999999,0.09940801,0.8781924,0.1218076,0.8550929,0.1449071,0.7335953,0.2664047,0.6827964,0.3172037,0.6340973,0.3659027,0.8068939000000001,0.1931061,0.7667947000000001,0.2332053,0.7271223999999999,0.2728775,0.5430992,0.4569009,0.4766005,0.5233995,0.4175017,0.5824984,0.5,0.5,0.400002,0.599998,0.300004,0.699996,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.5,0.5,0.400002,0.599998,0.300004,0.699996,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902),c(2,3,2,2,2),list(AbdominalPain=lv5,CausativePathogenForPneumonia=lvCause,PleuralEffusion=lv,CurrentPhenotype=lvType,Diarrhoea=lv5))
Earache <- array(c(0.09134199,0.908658,0.008175573,0.9918244000000001,0.1519352,0.8480648,0.05004422,0.9499558,0.07589404,0.9241059,0.02161773,0.9783823,0.05648768,0.9435123,0.05056201,0.949438,0.02117462,0.9788254,0.06025382,0.9397462,3.898106e-05,0.999961,7.562885999999999e-05,0.9999244),c(2,4,3),list(Earache=lv5,UpperAirwayInvolvment=lvUpper,AgeGroup=lvAge))
SubjectGroup <- array(c(1,0,1,0,0,1),c(2,3),list(SubjectGroup=lvGroup,CausativePathogenForPneumonia=lvCause))
Rhinorrhoea  <- array(c(0.9760112 ,0.02398879 ,0.5626447 ,0.4373553 ,0.9913735 ,0.008626478999999999, 0.08481378000000001 ,0.9151861999999999),c(2,4),list(Rhinorrhoea=lv5,UpperAirwayInvolvment=lvUpper))
OtherPain <- array(c(0.3898662,0.6101337999999999,0.1528983,0.8471017,0.08870272,0.9112973,0.05168744,0.9483126,0.05965126,0.9403487,0.00726323,0.9927368,0.5341074,0.4658926,0.1215875,0.8784125,0.06050295,0.9394971,0.002564575,0.9974355,0.02356845,0.9764315,0.001383645,0.9986163,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902),c(2,3,2,3),list(OtherPain=lv5,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType,AgeGroup=lvAge))
HighestTemperature <- array(c(.7305864,0.07848664,0.1909269,0.7251006,0.1999442,0.07495517,0.5333315,0.4333321,0.03333632,0.2608544,0.3146614,0.4244842,0.2056652,0.4518144,0.3425204,0.343933,0.2199694,0.4360977,0.037906,0.3104399,0.6516541,0.3349249,0.445045,0.2200301,0.8333282,0.1333354,0.03333635,0.1486681,0.3729381,0.4783938,0.2623653,0.3715909,0.3660438,0.1520426,0.4603647,0.3875927,0.0100097,0.0500085,0.9399818,0.0100097,0.0500085,0.9399818,0.0100097,0.0500085,0.9399818,0.0100097,0.0500085,0.9399818,0.0100097,0.0500085,0.9399818,0.0100097,0.0500085,0.9399818),c(3,3,2,3),list(HighestTemperature=lvTemp,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType,AgeGroup=lvAge))
Fever <- array(c(0.958464,0.04153603,0.9499473,0.05005269,0.9833301,0.01666989,0.543874,0.456126,0.7633948,0.2366052,0.9710545,0.02894548,0.8120505,0.1879495,0.6699707,0.3300293,0.6333323,0.3666677,0.8439647,0.1560353,0.8368682,0.1631318,0.894976,0.105024,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902),c(2,3,2,3),list(Fever=lv5,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType,AgeGroup=lvAge))
Wheezing <- array(c(0.5876986,0.4123014,0.6661986,0.3338015,0.7280953999999999,0.2719046,0.8836876,0.1163124,0.8611823,0.1388177,0.7739165,0.2260835,0.050009,0.949991,0.050009,0.949991,0.100008,0.899992,0.5333993,0.4666007,0.6210355,0.3789645,0.6928961,0.3071039,0.6214075999999999,0.3785924,0.6928961,0.3071039,0.748295,0.251705,0.050009,0.949991,0.050009,0.949991,0.100008,0.899992,0.651797,0.348203,0.717024,0.2829761,0.7659947,0.2340053,0.7350586,0.2649414,0.7660605,0.2339395,0.799894,0.200106,0.050009,0.949991,0.050009,0.949991,0.100008,0.899992,0.4745006,0.5254995,0.5701988,0.4298013,0.6517969,0.348203,0.5949163,0.4050837,0.665503,0.3344969,0.717024,0.2829761,0.0200096,0.9799904,0.0200096,0.9799904,0.050009,0.949991,0.3914789,0.6085211,0.4862418,0.5137582000000001,0.581268,0.418732,0.4836254,0.5163746,0.2037271,0.7962729,0.6693891,0.3306109,0.050009,0.949991,0.050009,0.949991,0.100008,0.899992,0.3284321,0.6715679,0.4335013,0.5664987,0.5331324,0.4668676,0.4335058,0.5664941999999999,0.5333993,0.4666007,0.6352326,0.3647675,0.050009,0.949991,0.050009,0.949991,0.100008,0.899992,0.474516,0.525484,0.5701982,0.4298018,0.6516741,0.3483259,0.5701983,0.4298017,0.6515,0.3485,0.7336923,0.2663077,0.050009,0.949991,0.050009,0.949991,0.100008,0.899992,0.6208889,0.3791111,0.3701324,0.6298677,0.2388082,0.7611918,0.2095466,0.7904534,0.4327092,0.5672908,0.7719563,0.2280437,0.0200096,0.9799904,0.0200096,0.9799904,0.050009,0.949991,0.3501347,0.6498653,0.2498775,0.7501225,0.3134412,0.6865588,0.4772254,0.5227746,0.800189,0.199811,0.6636532000000001,0.3363468,0.0100098,0.9899902,0.0100098,0.9899902,0.0300094,0.9699906,0.328287,0.671713,0.4332256,0.5667744,0.5295286,0.4704714,0.4046258,0.5953742,0.5261738,0.4738262,0.6171055,0.3828945,0.0100098,0.9899902,0.0100098,0.9899902,0.0300094,0.9699906,0.4744932,0.5255068000000001,0.5667844,0.4332156,0.3159713,0.6840286,0.5686491,0.4313509,0.6232648,0.3767352,0.2403527,0.7596473,0.0100098,0.9899902,0.0100098,0.9899902,0.0300094,0.9699906,0.045223,0.954777,0.3649124,0.6350876,0.4498366,0.5501634,0.09775838000000001,0.9022416,0.1543746,0.8456255,0.5664924,0.4335076,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.1794924,0.8205076,0.03266516,0.9673349,0.1251187,0.8748813,0.0197497,0.9802503,0.2373196,0.7626804,0.1653827,0.8346173,0.0100098,0.9899902,0.0100098,0.9899902,0.0300094,0.9699906,0.1395763,0.8604237,0.2228198,0.7771803,0.3165889,0.6834111,0.07835854,0.9216415,0.2994148,0.7005852,0.2685928,0.7314072,0.0100098,0.9899902,0.0100098,0.9899902,0.0300094,0.9699906,0.05437387,0.9456261,0.1578094,0.8421906,0.2026354,0.7973646,0.0773901,0.9226099,0.06806418,0.9319358,0.2003736,0.7996264,0.0100098,0.9899902,0.0100098,0.9899902,0.0300094,0.9699906,0.2429071,0.7570929,0.02074138,0.9792586,0.3670532,0.6329468,0.04063394,0.9593661,0.01775748,0.9822425,0.06783772,0.9321623,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902),c(2,2,2,4,3,3),list(Wheezing=lv5,ChronicRespiratoryDisease=lv2,CurrentPhenotype=lvType,UpperAirwayInvolvment=lvUpper,CausativePathogenForPneumonia=lvCause,AgeGroup=lvAge))
Vomiting <- array(c(0.8336912, 0.1663088, 0.4931066, 0.5068935 ,0.7052125, 0.2947875 ,0.5991587, 0.4008413, 0.0100098, 0.9899902 ,0.0100098, 0.9899902),c(2,3,2),list(Vomiting=lv5,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType))
ReducedOralIntake <- array(c(.9528517,0.04714834,0.9393384,0.06066162,0.9748452,0.02515475,0.1696905,0.8303095,0.9336741,0.06632591,0.9694485,0.0305515,0.9580575,0.04194254,0.9657373,0.03426271,0.9702453,0.0297547,0.9518413999999999,0.04815863,0.6843577,0.3156423,0.8974963,0.1025037,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.8882725,0.1117275,0.7507907,0.2492094,0.8629928,0.1370073,0.7023838999999999,0.2976161,0.7629355,0.2370645,0.9334435,0.06655646,0.8811949,0.1188051,0.6824751,0.3175249,0.846393,0.1536069,0.9712461,0.02875385,0.9046314,0.09536857999999999,0.9851173,0.01488272,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.599898,0.400102,0.6868963,0.3131037,0.8103938000000001,0.1896062,0.4119391,0.5880609,0.7394636,0.2605363,0.806727,0.193273,0.5785984,0.4214016,0.6650967,0.3349033,0.7911942,0.2088058,0.8489316,0.1510684,0.8651561,0.1348439,0.9468578,0.05314218,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.4607101,0.5392898,0.5371732,0.4628268,0.8325468,0.1674532,0.552825,0.447175,0.8259736,0.1740264,0.6894957,0.3105043,0.7216454,0.2783546,0.6292595,0.3707405,0.8216467,0.1783533,0.8674313,0.1325687,0.7666548,0.2333452,0.7812015,0.2187985,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902,0.0100098,0.9899902),c(2,2,2,3,2,3),list(ReducedOralIntake=lv5,Vomiting=lv5,Diarrhoea=lv5,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType,AgeGroup=lvAge))
BloodCultureResult <- array(c(0.01752663,0.9824681,5.323797e-06,0.003253914,0.9967449,1.153069e-06,0.05000839,0.9499794,1.220967e-05,0.1697136,0.8302844,1.983087e-06,0.2974145,0.7025841,1.470769e-06,0.003168297,0.9968313,4.344649e-07,4.217312e-05,0.9999527,5.104892e-06,1.6632e-06,0.9999981999999999,2.013239e-07,0.0006087633,0.9993798,1.139983e-05,9.886434e-05,0.9998994,1.665969e-06,3.340409e-05,0.9999616,5.068901e-06,1.040819e-06,0.9999988,1.581089e-07,0.001039876,0.9989201,3.99961e-05,0.001039876,0.9989201,3.99961e-05,0.001039876,0.9989201,3.99961e-05,0.001039876,0.9989201,3.99961e-05,0.001039869,0.9989201,3.99961e-05,0.001039869,0.9989201,3.99961e-05,1.075727e-06,1.075727e-06,0.9999979,3.373229e-06,3.373229e-06,0.9999933,1.074648e-05,1.074648e-05,0.9999785,3.705469e-06,3.705469e-06,0.9999926,3.58206e-06,3.582059e-06,0.9999928,1.374382e-06,1.374382e-06,0.9999973,5.347206e-06,5.347206e-06,0.9999893,5.712083e-07,5.712082e-07,0.9999989,1.074648e-05,1.074648e-05,0.9999785,2.107296e-06,2.107295e-06,0.9999958,5.373704e-06,5.373703e-06,0.9999893,5.602926e-07,5.602926e-07,0.9999989,1.074648e-05,1.074648e-05,0.9999785,1.074648e-05,1.074648e-05,0.9999785,1.074648e-05,1.074648e-05,0.9999785,1.074648e-05,1.074648e-05,0.9999785,1.074648e-05,1.074648e-05,0.9999785,1.074648e-05,1.074648e-05,0.9999785),c(3,2,3,3,2),list(BloodCultureResult=lvResult,BloodCulturePerformed=lv,CausativePathogenForPneumonia=lvCause,AntibioticExposure=lvAntibiotic,PleuralEffusion=lv))
PleuralFluidResult <- array(c(0.5287073,0.4629645,0.008328166,0.4299971,0.4699959,0.100007,0.2846499,0.7042283,0.01112184,0.002561921,0.4711249,0.5263132,0.0100097,0.8899833,0.100007,0.3359439,0.2981574,0.3658987,0.0100097,0.8899833,0.100007,0.0100097,0.8899833,0.100007,0.0100097,0.8899833,0.100007,1.375898e-06,1.375899e-06,0.9999973,1.94818e-06,1.94818e-06,0.9999961000000001,5.147516e-07,5.147516e-07,0.999999,2.288492e-07,2.288492e-07,0.9999995,1.434475e-06,1.434475e-06,0.9999971,1.902551e-07,1.902551e-07,0.9999996,1.569663e-05,1.569663e-05,0.9999686,1.569663e-05,1.569663e-05,0.9999686,1.569663e-05,1.569663e-05,0.9999686),c(3,2,3,3),list(PleuralFluidResult=lvResult,PleuralEffusion=lv,CausativePathogenForPneumonia=lvCause,AntibioticExposure=lvAntibiotic))
ChillSweat <- array(c(0.1284535,0.8715465,0.4304923,0.5695077,0.9187199,0.08128004,0.05404168,0.9459583,0.148715,0.851285,0.01363809,0.9863619,0.110294,0.889706,0.08732562000000001,0.9126744,0.1944537,0.8055463,0.05805603,0.9419438999999999,0.01025227,0.9897477,0.001623686,0.9983763,0.100008,0.899992,0.050009,0.949991,0.0100098,0.9899902,0.100008,0.899992,0.050009,0.949991,0.0100098,0.9899902),c(2,3,2,3),list(ChillSweat=lv5,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType,HighestTemperature=lvTemp))
Crackles <- array(c(0.06460875000000001, 0.9353912 ,0.2052245, 0.7947755 ,0.8781676, 0.1218324, 0.5593320000000001 ,0.440668 ,0.0100098, 0.9899902, 0.0100098 ,0.9899902),c(2,3,2),list(Crackles=lv5,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType))
Rash <- array(c(0.2251777 ,0.7748223 ,0.09139027 ,0.9086097, 0.1643772, 0.8356228, 0.1471031, 0.8528969, 0.00100998, 0.99899, 0.00100998, 0.99899),c(2,3,2),list(Rash=lv5,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType))
WhiteCellCount <- array(c(0.6033364,0.2698046 ,0.126859 ,0.6031587, 0.3685944 ,0.02824687 ,0.1755993 ,0.4634103, 0.3609903, 0.1110508 ,0.3703499 ,0.5185993, 0.0100097 ,0.0500085, 0.9399818 ,0.0100097 ,0.0500085, 0.9399818),c(3,3,2),list(WhiteCellCount=lvWhite,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType))
DiagnosisBacterialPneumonia <- array(c(1,0,1,0,1,0,0,1,1,0,0,1),c(2,3,2),list(DiagnosisBacterialPneumonia=lv,BloodCultureResult=lvResult,PleuralEffusion=lv))
EnergyLoss <- array(c(0.8781350999999999,0.1218649,0.6318936000000001,0.3681064,0.6320507,0.3679493,0.1520451,0.8479549,0.8130375,0.1869625,0.5044343,0.4955657,0.621096,0.378904,0.5052451,0.4947549,0.100008,0.899992,0.0100098,0.9899902,0.100008,0.899992,0.0100098,0.9899902),c(2,3,2,2),list(EnergyLoss=lv5,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType,ReducedOralIntake=lv5))
Cough <- array(c(0.966035,0.03396496,0.8727249,0.1272751,0.9816117,0.01838829,0.9380388,0.06196119,0.0100098,0.9899902,0.0100098,0.9899902,0.9008607,0.09913933,0.5502,0.4498,0.8863618,0.1136383,0.8911665,0.1088335,0.050009,0.949991,0.050009,0.949991,0.9518391,0.04816091,0.9468490000000001,0.05315096,0.9839863,0.01601375,0.9910831,0.008916844,0.050009,0.949991,0.050009,0.949991,0.6486037,0.3513963,0.7608988,0.2391012,0.9793908,0.02060919,0.9320642,0.06793573999999999,0.0100098,0.9899902,0.0100098,0.9899902),c(2,4,3,2),list(Cough=lv5,UpperAirwayInvolvment=lvUpper,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType))
NeutrophilProportion <- array(c(0.4933341,0.4877718,0.01889409,0.5132665,0.4824765,0.00425696,0.4516702,0.4055669,0.1427628,0.09254315,0.6424976,0.2649592,0.0100097,0.0500085,0.9399818,0.0100097,0.0500085,0.9399818),c(3,3,2),list(NeutrophilProportion=lvNeutro,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType))
CReactiveProteins <- array(c(0.8479941,0.1408889,0.01111707,0.4725086,0.3022373,0.2252541,0.2517622,0.2553906,0.4928472,0.1305051,0.2488578,0.6206371000000001,0.0100097,0.0500085,0.9399818,0.0100097,0.0500085,0.9399818),c(3,3,2),list(CReactiveProteins=lvC,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType))
BreathingDifficulty <- array(c(0.9732425,0.0267575,0.9756036,0.0243964,0.9866922,0.01330782,0.9912312,0.008768789000000001,0.9497910000000001,0.05020899,0.9497910000000001,0.05020899,0.762022,0.2379781,0.9591643,0.04083575,0.9146857,0.08531432999999999,0.8381716,0.1618284,0.7457951,0.2542049,0.7457951,0.2542049,0.718618,0.281382,0.708816,0.291184,0.7248027,0.2751973,0.483676,0.516324,0.050009,0.949991,0.050009,0.949991,0.9501695999999999,0.04983045,0.9491158,0.05088422,0.9501706,0.04982935,0.955305,0.04469501,0.9497910000000001,0.05020899,0.9497910000000001,0.05020899,0.7457952,0.2542048,0.7520204,0.2479796,0.7667339,0.2332661,0.770952,0.229048,0.7457951,0.2542049,0.7457951,0.2542049,0.4296028,0.5703972,0.1049074,0.8950925,0.4366516,0.5633484,0.03010533,0.9698946000000001,0.050009,0.949991,0.050009,0.949991,0.9756609000000001,0.02433916,0.9540960000000001,0.045904,0.9762772,0.02372284,0.9917505,0.008249434999999999,0.9497910000000001,0.05020899,0.9497910000000001,0.05020899,0.7459165,0.2540835,0.9471499,0.05285012,0.7416751,0.2583249,0.8228624,0.1771376,0.7457951,0.2542049,0.7457951,0.2542049,0.4323559,0.5676441,0.7714564,0.2285436,0.805024,0.194976,0.8477519,0.1522481,0.050009,0.949991,0.050009,0.949991,0.9755456,0.02445433,0.4984298,0.5015702,0.9544697,0.0455303,0.6755097,0.3244903,0.9497910000000001,0.05020899,0.9497910000000001,0.05020899,0.9139461,0.08605388999999999,0.7093838,0.2906162,0.9366129,0.06338707,0.8481677,0.1518323,0.7457951,0.2542049,0.7457951,0.2542049,0.8073393,0.1926607,0.7263749,0.273625,0.8089319,0.191068,0.4865401,0.5134599,0.0100098,0.9899902,0.0100098,0.9899902),c(2,4,3,3,2),list(BreathingDifficulty=lv5,UpperAirwayInvolvment=lvUpper,OxygenSaturation=lvOxy,CausativePathogenForPneumonia=lvCause,CurrentPhenotype=lvType))




pneumonia <- custom.fit(dag,list(
AgeGroup=AgeGroup, Ethnicity=Ethnicity,SmokerInHousehold=SmokerInHousehold, Prematurity=Prematurity,
ChildcareDays=ChildcareDays,LevelOfExposure=LevelOfExposure,PneumococcalVaccine=PneumococcalVaccine,
InfluenzaVaccine=InfluenzaVaccine,ImpairedImmunity=ImpairedImmunity,
SusceptibilityToColonisation=SusceptibilityToColonisation, HospitalTransfer=HospitalTransfer,
DurationOfSymptomsOnset=DurationOfSymptomsOnset,ChronicRespiratoryDisease=ChronicRespiratoryDisease,
SusceptibilityToProgression=SusceptibilityToProgression,
PreviousSignificantInfection=PreviousSignificantInfection,
AntibioticExposure=AntibioticExposure,InfluenzaSeason=InfluenzaSeason,
RSVInNasopharynx=RSVInNasopharynx,HMPVInNasopharynx=HMPVInNasopharynx,
InfluenzaInNasopharynx=InfluenzaInNasopharynx,ParainfluenzaInNasopharynx=ParainfluenzaInNasopharynx,
MycoplasmaInNasopharynx=MycoplasmaInNasopharynx,TypicalBacteriaInNasopharynx=TypicalBacteriaInNasopharynx,
ViralNasopharyngealInfection=ViralNasopharyngealInfection,ThroatInfection=ThroatInfection,
ViralLikePneumonia=ViralLikePneumonia,TypicalBacterialPneumonia=TypicalBacterialPneumonia,
CausativePathogenForPneumonia=CausativePathogenForPneumonia,
CurrentPhenotype=CurrentPhenotype, O2Type=O2Type,OxygenSaturation=OxygenSaturation,
RespiratoryRate=RespiratoryRate,UpperAirwayInvolvment=UpperAirwayInvolvment,SoreThroat=SoreThroat,
Headache=Headache,Irritable=Irritable,BloodCulturePerformed=BloodCulturePerformed,
PleuralEffusion=PleuralEffusion,Diarrhoea=Diarrhoea,ChestPain=ChestPain,
AbdominalPain=AbdominalPain,Earache=Earache,SubjectGroup=SubjectGroup,Rhinorrhoea=Rhinorrhoea,
OtherPain=OtherPain,HighestTemperature=HighestTemperature,Fever=Fever,Wheezing=Wheezing,
Vomiting=Vomiting,ReducedOralIntake=ReducedOralIntake,BloodCultureResult=BloodCultureResult,
PleuralFluidResult=PleuralFluidResult,ChillSweat=ChillSweat,Crackles=Crackles, Rash=Rash,WhiteCellCount=WhiteCellCount,
DiagnosisBacterialPneumonia=DiagnosisBacterialPneumonia,EnergyLoss=EnergyLoss,Cough=Cough,
NeutrophilProportion=NeutrophilProportion,CReactiveProteins=CReactiveProteins,BreathingDifficulty=BreathingDifficulty
))


usethis::use_data(pneumonia, overwrite = TRUE)
