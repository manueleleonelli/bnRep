
library(bnlearn)

dag <- model2network("[RiskToHumanHealth|DrowningMortality:AbilityToEvacuate][DrowningMortality|FloodPreparedness:FloodExposure:PopulationLocation][AbilityToEvacuate|FloodPreparedness:EvacuationRequired:RoadwayAccessibility:PersonalVehicle][EvacuationRequired|FloodExposure:PopulationLocation:RoadwayLocation][RoadwayAccessibility|FloodExposure:NuisanceFloodExposure:RoadwayLocation][FloodExposure|StormSurgeProtection:FloodHazard:PhysicalFloodProtection][PopulationLocation][RoadwayLocation][NuisanceFloodExposure|PhysicalFloodProtection:NuisanceFloodHazard][FloodHazard|StormSurge:SeaLevelRise:ExtremePrecipitation][PhysicalFloodProtection][StormSurgeProtection][FloodPreparedness][PersonalVehicle][NuisanceFloodHazard|RegionWithCoastline:NuisanceFloodFrequency:TideLevelAboveHighTide][ExtremePrecipitation|RegionWithCoastline:HurricaneCategory:ExtremePrecipitationNonHurricane][StormSurge|HurricaneCategory:RegionWithCoastline:ActiveHurricane][NuisanceFloodFrequency|SeaLevelRise][TideLevelAboveHighTide|SeaLevelRise][ExtremePrecipitationNonHurricane][RegionWithCoastline][SeaLevelRise|RegionWithCoastline][ActiveHurricane][HurricaneCategory]")

lv <- c("No","Yes")
vl <- c("Yes","No")
lv4 <- c("Zero", "Low", "Medium", "High")


RegionWithCoastline <- array(c(1,0),2,list(RegionWithCoastline=lv))
SeaLevelRise <- array(c(1,0,0,0,0.05,0.20,0.60,0.15),c(4,2),list(SeaLevelRise=lv4,RegionWithCoastline=lv))
ActiveHurricane <- array(c(0,1),2,list(ActiveHurricane=lv))
HurricaneCategory <- array(c(0,0,1,0),4,list(HurricaneCategory=lv4))
ExtremePrecipitationNonHurricane <- array(c(0.8,0.2,0,0),4,list(ExtremePrecipitationNonHurricane=lv4))
TideLevelAboveHighTide <- array(c(0.7,0.2,0.08,0.02,0.25,0.60,0.10,0.05,0.05,0.20,0.60,0.15,0.02,0.08,0.20,0.70),c(4,4),list(TideLevelAboveHighTide=lv4,SeaLevelRise=lv4))
NuisanceFloodFrequency <- array(0.01*c(10,40,40,10,5,20,50,25,5,10,50,35,0,5,25,70),c(4,4),list(NuisanceFloodFrequency=lv4,SeaLevelRise=lv4))
StormSurge <- array(c(rep(c(1,0,0,0),12),0.8,0.2,0,0,0,0.3,0.4,0.3,0,0.10,0.5,0.4,0,0,0.2,0.8),c(4,4,2,2),list(StormSurge=lv4,HurricaneCategory=lv4,RegionWithCoastline=lv,ActiveHurricane=lv))
ExtremePrecipitation <- array(0.01*c(100,0,0,0,                                100,0,0,0,80,20,0,0,                                20,80,0,0,                                0,80,20,0,                                0,20,80,0,0,50,50,0,                                0,20,60,20,                                80,20,0,0,                                20,80,0,0,                                80,10,10,0,                                10,80,10,0,                                40,50,10,0,                                0,50,50,0,                                0,50,30,20,                                0,20,30,50,                                0,80,20,0,                                0,20,80,0,                                50,40,10,0,                                0,50,50,0,                                0,40,50,10,                                0,10,80,10,                               0,50,50,0,                                0,0,50,50,                                40,20,20,20,                                20,20,20,40,                                0,50,30,20,                                0,20,30,50,                                0,0,20,80,                                0,0,20,80,                                0,0,80,20,                                0,0,0,100),c(4,2,4,4),list(ExtremePrecipitation=lv4,RegionWithCoastline=lv,HurricaneCategory=lv4,ExtremePrecipitationNonHurricane=lv4))
NuisanceFloodHazard <- array(0.01*c(100,0,0,0,                                    100,0,0,0,                                    100,0,0,0,                                    100,0,0,0,                                    100,0,0,0,                                    100,0,0,0,                                    100,0,0,0,                                    100,0,0,0,                                    100,0,0,0,                                    90,10,0,0,                                    100,0,0,0,                                    85,15,0,0,                                    100,0,0,0,                                    85,10,5,0,                                    100,0,0,0,                                    20,50,25,5,                                    100,0,0,0,                                    10,40,50,0,                                    100,0,0,0,                                   10,65,25,0,                                   100,0,0,0,                                    5,10,80,5,                                    100,0,0,0,                                    0,5,70,25,                                    100,0,0,0,                                    0,5,90,5,                                    100,0,0,0,                                    0,5,85,10,                                    100,0,0,0,                                  0,5,35,60,                                  100,0,0,0,                             0,0,0,100),c(4,2,4,4),list(NuisanceFloodHazard=lv4,RegionWithCoastline=lv,NuisanceFloodFrequency=lv4,TideLevelAboveHighTide=lv4))
PhysicalFloodProtection <- array(c(0.05,0.95),2,list(PhysicalFloodProtection=vl))
StormSurgeProtection <- array(c(1,0),2,list(StormSurgeProtection=vl))
FloodPreparedness <- array(c(0.1,0.9),2,list(FloodPreparedness=vl))
PersonalVehicle <- array(c(0.9,0.1),2,list(PersonalVehicle=vl))
FloodHazard <- array(0.01*c(100,0,0,0,                            25,75,0,0,                            25,25,50,0,                           0,25,50,25,                           50,50,0,0,                            25,75,0,0,                            20,60,20,0,                            10,20,50,20,                            30,40,30,0,                            20,50,30,0,                            10,40,50,0,20,30,30,20,                            30,30,30,10,20,35,35,10,                            10,20,40,30,                            0,30,40,30,                            50,50,0,0,                            40,50,10,0,                            30,50,20,0,20,50,20,10,                            10,80,10,0,                            20,80,0,0,10,80,10,0,                            10,70,20,0,                            25,50,25,0,                            0,60,40,0,                            0,40,60,0,                            0,30,40,30,                            20,30,30,20,                            0,30,40,30,0,20,50,30,                            0,10,50,40,                            30,40,30,0,                            15,55,30,0,10,40,50,0,                            10,30,40,20,                            25,50,25,0,                            10,70,20,0,                            0,50,50,0,                            0,25,50,25,10,20,70,0,                            0,20,75,5,                            0,10,80,10,                            0,10,70,20,                            10,20,50,20,                            0,25,50,25,                            0,10,70,20,                            0,0,40,60,                            30,40,30,0,                            20,50,30,0,                            15,30,40,15,                            10,20,30,40,                            10,30,40,20,                            0,40,50,10,                            0,30,40,30,                            0,10,40,50,                           0,0,50,50,                            0,25,50,25,                            0,0,70,30,                            0,0,20,80,                            0,20,30,50,                            0,10,40,50,                            0,0,25,75,                            0,0,0,100),c(4,4,4,4),list(FloodHazard=lv4,StormSurge=lv4,SeaLevelRise=lv4,ExtremePrecipitation=lv4))
NuisanceFloodExposure <- array(c(1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,1),c(4,2,4),list(NuisanceFloodExposure=lv4,PhysicalFloodProtection=vl,NuisanceFloodHazard=lv4))
PopulationLocation <- array(c(0.6,0.3,0.1,0),4,list(PopulationLocation=lv4))
RoadwayLocation <- array(c(0.8,0.2,0.0,0),4,list(RoadwayLocation=lv4))
FloodExposure <- array(c(1,0,0,0,    1,0,0,0,    1,0,0,0,    0,1,0,0,   0,1,0,0,   0,0,1,0,   0,1,0,0,   0,0,1,0,   1,0,0,0,    1,0,0,0,    0,1,0,0,   0,1,0,0,   0,1,0,0,   0,0,1,0,   0,0,1,0,   0,0,0,1),c(4,2,4,2),list(FloodExposure=lv4,StormSurgeProtection=vl,FloodHazard=lv4,PhysicalFloodProtection=vl))
RoadwayAccessibility <- array(0.01*c(100,0,0,0,                                     100,0,0,0,                                     100,0,0,0,                                     100,0,0,0,                                     25,75,0,0,                                     25,75,0,0,                                     25,75,0,0,                                     25,75,0,0,                                     25,25,50,0,                                     25,25,50,0,                                     25,25,50,0,                                     25,25,50,0,                                     0,25,50,25,                                     0,25,50,25,                                     0,25,50,25,                                     0,25,50,25,                                    50,50,0,0,                                     50,50,0,0,                                     50,50,0,0,                                     50,50,0,0,                                     25,75,0,0,                                     25,75,0,0,                                     25,75,0,0,                                     25,75,0,0,                                     20,60,20,0,                                     20,60,20,0,                                     20,60,20,0,                                     20,60,20,0,                                     10,20,50,20,                                     10,20,50,20,                                     10,20,50,20,                                     10,20,50,20,                                     30,40,30,0,                                     30,40,30,0,                                     30,40,30,0,                                     30,40,30,0,                                     20,50,30,0,                                     20,50,30,0,                                    20,50,30,0,                                    20,50,30,0,                                     10,40,50,0,                                     10,40,50,0,                                     10,40,50,0,                                     10,40,50,0,                                     20,30,30,20,                                     20,30,30,20,                                     20,30,30,20,                                     20,30,30,20,                                     30,30,30,10,                                    30,30,30,10,                                     30,30,30,10,                                     30,30,30,10,                                    20,35,35,10,                                    20,35,35,10,                                     20,35,35,10,                                     20,35,35,10,                                     10,20,40,30,                                     10,20,40,30,                                     10,20,40,30,                                     10,20,40,30,                                     0,30,40,30,                                     0,30,40,30,                                     0,30,40,30,                                   0,30,40,30),c(4,4,4,4),list(RoadwayAccessibility=lv4,FloodExposure=lv4,NuisanceFloodExposure=lv4,RoadwayLocation=lv4))
EvacuationRequired <- array(0.01*c(100,0,0,0,                                   100,0,0,0,                                   100,0,0,0,                                   100,0,0,0,                                   50,50,0,0,                                   25,75,0,0,                                   20,60,20,0,                                   10,20,50,20,                                   30,40,30,0,                                   20,50,30,0,                                   10,40,50,0,                                   20,30,30,20,                                   30,30,30,10,                                   20,35,35,10,                                   10,20,40,30,                                   0,30,40,30,                                   50,50,0,0,                                   40,50,10,0,                                   30,50,20,0,                                   20,50,20,10,                                   10,80,10,0,                                   20,80,0,0,                                   10,80,10,0,                                   10,70,20,0,                                   25,50,25,0,                                   0,60,40,0,                                   0,40,60,0,                                   0,30,40,30,                                   20,30,30,20,                                   0,30,40,30,                                   0,20,50,30,                                   0,10,50,40,                                   30,40,30,0,                                   15,55,30,0,                                   10,40,50,0,                                   10,30,40,20,                                   25,50,25,0,                                   10,70,20,0,                                   0,50,50,0,                                   0,25,50,25,                                   10,20,70,0,                                   0,20,75,5,                                   0,10,80,10,                                   0,10,70,20,                                   10,20,50,20,                                   0,25,50,25,                                  0,10,70,20,                                  0,0,40,60,                                   30,40,30,0,                                   20,50,30,0,                                   15,30,40,15,                                   10,20,30,40,                                   10,30,40,20,                                   0,40,50,10,                                   0,30,40,30,                                   0,10,40,50,                                   0,0,50,50,                                   0,25,50,25,                                   0,0,70,30,                                   0,0,20,80,                                   0,20,30,50,                                   0,10,40,50,                                   0,0,25,75,                                   0,0,0,100),c(4,4,4,4), list(EvacuationRequired=lv4,FloodExposure=lv4,PopulationLocation=lv4,RoadwayLocation=lv4))
AbilityToEvacuate <- array(0.01*c(25,25,25,25,                                 25,25,25,25,                                 100,0,0,0,                                 100,0,0,0,                                  100,0,0,0,                                  100,0,0,0,                                  100,0,0,0,                                  100,0,0,0,                                  25,25,25,25,                                  25,25,25,25,                                  0,100,0,0,                                  0,100,0,0,                                  0,100,0,0,                                  0,100,0,0,                                  0,100,0,0,                                  0,0,100,0,                                  25,25,25,25,                                  25,25,25,25,                                  0,100,0,0,                                  0,100,0,0,                                  0,100,0,0,                                  0,100,0,0,                                  0,100,0,0,                                  0,100,0,0,                                  25,25,25,25,                                  25,25,25,25,                                  0,0,0,100,                                  0,0,0,100,                                  0,100,0,0,                                  0,0,100,0,                                  0,100,0,0,                                 0,100,0,0,                                  25,25,25,25,                                  25,25,25,25,                                  0,100,0,0,                                  0,100,0,0,                                  0,100,0,0,                                  0,0,100,0,                                  0,100,0,0,                                  0,0,100,0,                                  25,25,25,25,                                  25,25,25,25,                                  0,100,0,0,                               0,100,0,0,                                  0,100,0,0,                                  0,100,0,0,                                 0,100,0,0,                                  0,0,100,0,                                  25,25,25,25,                                  25,25,25,25,                                 0,100,0,0,                                 0,0,100,0,                                  0,0,100,0,                                  0,0,0,100,                                  0,0,100,0,                                  0,0,0,100,                                 25,25,25,25,                                 25,25,25,25,                                  0,0,0,100,                                  0,0,0,100,                                  0,0,0,100,                                  0,0,0,100,                                  0,0,0,100,                                0,0,0,100),c(4,2,4,4,2),list(AbilityToEvacuate=lv4,FloodPreparedness=vl,EvacuationRequired=lv4,RoadwayAccessibility=lv4,PersonalVehicle=vl))

a1 <- c(1,0,0,0); a2 <- c(0,1,0,0); a3 <- c(0,0,1,0); a4 <- c(0,0,0,1)
DrowningMortality <- array(c(rep(a1,10),a2,a2,a2,a3,a2,a3,a1,a1,a2,a3,a2,a3,a2,a4,a1,a1,a2,a3,a3,a4,a3,a4),c(4,2,4,4),list(DrowningMortality=lv4,FloodPreparedness=vl,FloodExposure=lv4,PopulationLocation=lv4))
RiskToHumanHealth <- array(c(a1,a2,a3,a3,a2,a2,a3,a3,a2,a3,a4,a4,a2,a3,a4,a4),c(4,4,4),list(RiskToHumanHealth=lv4,DrowningMortality=lv4,AbilityToEvacuate=lv4))

charleston<- custom.fit(dag,list(
  RegionWithCoastline=RegionWithCoastline,
  SeaLevelRise =SeaLevelRise,
  ActiveHurricane=ActiveHurricane,
  HurricaneCategory=HurricaneCategory,
  ExtremePrecipitationNonHurricane=ExtremePrecipitationNonHurricane,
  TideLevelAboveHighTide=TideLevelAboveHighTide,
  NuisanceFloodFrequency=NuisanceFloodFrequency,PersonalVehicle=PersonalVehicle,
  StormSurge=StormSurge,ExtremePrecipitation=ExtremePrecipitation,
  NuisanceFloodHazard=NuisanceFloodHazard,PhysicalFloodProtection=PhysicalFloodProtection,
  StormSurgeProtection=StormSurgeProtection,FloodPreparedness=FloodPreparedness,
  FloodHazard=FloodHazard,NuisanceFloodExposure=NuisanceFloodExposure,
  PopulationLocation=PopulationLocation,RoadwayLocation=RoadwayLocation,
  FloodExposure=FloodExposure,RoadwayAccessibility=RoadwayAccessibility,
  EvacuationRequired=EvacuationRequired,AbilityToEvacuate=AbilityToEvacuate,
  DrowningMortality=DrowningMortality,RiskToHumanHealth=RiskToHumanHealth
))


usethis::use_data(charleston, overwrite = TRUE)
