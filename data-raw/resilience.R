# Quantifying resilience of socio-ecological systems through dynamic Bayesian networks

library(bnlearn)
dag <- model2network("[Fires][Fires1|Fires][Fires2|Fires1][Precipitation2][Precipitation1][Precipitation][Fcover2][Fcover1][Fcover][Diversity][Diversity1][Diversity2][Density][Density1][Density2][Organization][Organization1][Organization2][Connectivity][Connectivity1][Connectivity2][Autonomy][Autonomy1][Autonomy2][Absorption|Fcover:Diversity:Autonomy][Absorption1|Fcover1:Diversity1:Autonomy1][Absorption2|Fcover2:Diversity2:Autonomy2][Adaptation|Precipitation:Fcover:Diversity:Organization:Connectivity:Autonomy][Adaptation1|Precipitation1:Fcover1:Diversity1:Organization1:Connectivity1:Autonomy1][Adaptation2|Precipitation2:Fcover2:Diversity2:Organization2:Connectivity2:Autonomy2][Transformation|Fires:Density:Organization:Connectivity][Transformation1|Fires1:Density1:Organization1:Connectivity1:Transformation][Transformation2|Fires2:Density2:Organization2:Connectivity2:Transformation1][Function|Absorption:Adaptation:Transformation][Function1|Absorption1:Adaptation1:Transformation1][Function2|Absorption2:Adaptation2:Transformation2]")

Fires.prob <- array(c(0.2777777777777778, 0.7222222222222222),dim=2,dimnames = list(Fires = c("high","moderate")))
Fires1.prob <- array(c(0.7777777777777777, 0.1111111111111111, 0.1111111111111111, 0.1904761904761905, 0.1904761904761905, 0.619047619047619) ,dim=c(3,2),dimnames = list(Fires1=c("high","low","moderate"), Fires = c("high","moderate")))
Fires2.prob <- array(c(0.875, 0.125, 0.75, 0.25, 0.7000000000000001, 0.3), dim = c(2,3), dimnames= list(Fires2=c("low","moderate"), Fires1 = c("high","low","moderate")))
Precipitation.prob <- array(c(0.1481481481481481, 0.1481481481481481, 0.7037037037037036),dim=3,dimnames = list(Precipitation=c("high","low","moderate")))
Precipitation2.prob <- array(c(0.1481481481481481, 0.4814814814814814, 0.3703703703703703),dim=3,dimnames = list(Precipitation2=c("high","low","moderate")))
Precipitation1.prob <- array(c(0.2777777777777778, 0.7222222222222222),dim=2,dimnames = list(Precipitation1=c("low","moderate")))
Fcover.prob <- array(c(0.8333333333333333,0.1666666666666667), dim =2, dimnames=list(Fcover= c("low","moderate")))
Fcover1.prob <- array(c(0.5,0.5), dim =2, dimnames=list(Fcover1= c("low","moderate")))
Fcover2.prob <- array(c(0.7037037037037036, 0.1481481481481481, 0.1481481481481481), dim =3, dimnames=list(Fcover2= c("high","low","moderate")))
Diversity.prob <- array(c(.8333333333333333, 0.1666666666666667),dim=2,dimnames=list(Diversity=c("low","moderate")))
Diversity1.prob <- array(c(0.1481481481481481, 0.2592592592592592, 0.5925925925925926),dim=3,dimnames=list(Diversity1=c("high","low","moderate")))
Diversity2.prob <- array(c(0.5, 0.5),dim=2,dimnames=list(Diversity2=c("high","moderate")))
Density.prob <- array(c(0.8333333333333333, 0.1666666666666667), dim =2 ,dimnames=list(Density=c("low","moderate")))
Density1.prob <- array(c(0.5,0.5), dim =2 ,dimnames=list(Density1=c("low","moderate")))
Density2.prob <- array(c(0.8333333333333333, 0.1666666666666667), dim =2 ,dimnames=list(Density2=c("high","moderate")))
Organization.prob <- array(c(0.611111111111111, 0.3888888888888888),dim=2,dimnames=list(Organization=c("deficient","low")))
Organization1.prob <- array(c(0.5,0.5),dim=2,dimnames=list(Organization1=c("low","moderate")))
Organization2.prob <- array(c(0.8333333333333333, 0.1666666666666667),dim=2,dimnames=list(Organization2=c("high","moderate")))
Connectivity.prob <- array(c(0.611111111111111, 0.3888888888888888),dim=2,dimnames=list(Connectivity=c("deficient","low")))
Connectivity1.prob <- array(c(0.5,0.5),dim=2,dimnames=list(Connectivity1=c("low","moderate")))
Connectivity2.prob <- array(c(0.8333333333333333, 0.1666666666666667),dim=2,dimnames=list(Connectivity2=c("high","moderate")))
Autonomy.prob <- array(c(0.8333333333333333, 0.1666666666666667),dim=2,dimnames=list(Autonomy=c("deficient","low")))
Autonomy1.prob <- array(c(0.1666666666666667, 0.8333333333333333),dim=2,dimnames=list(Autonomy1=c("deficient","low")))
Autonomy2.prob <- array(c(0.3888888888888888, 0.611111111111111),dim=2,dimnames=list(Autonomy2=c("low","moderate")))
Absorption.prob <- array(c(0.75, 0.25, 0.75, 0.25, 0.75, 0.25, 0.5, 0.5, 0.75, 0.25, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),dim=c(2,2,2,2),dimnames= list(Absorption=c("false","true"),Fcover = c("low","moderate"), Diversity=c("low","moderate"), Autonomy=c("deficient","low")))
Absorption1.prob <- array(c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.75, 0.25, 0.5, 0.5 ,0.625 ,0.375, 0.5, 0.5 ,0.25, 0.75, 0.5 ,0.5, 0.75, 0.25, 0.75 ,0.25, 0.75, 0.25),dim=c(2,2,3,2),dimnames= list(Absorption1=c("false","true"),Fcover1 = c("low","moderate"), Diversity1=c("high","low","moderate"), Autonomy1=c("deficient","low")))
Absorption2.prob <- array(c(0.25, 0.75 ,0.1666666666666667 ,0.8333333333333333 ,0.5 ,0.5 ,0.25 ,0.75, 0.5, 0.5, 0.5 ,0.5, 0.5, 0.5 ,0.25 ,0.75, 0.5, 0.5, 0.25, 0.75, 0.5, 0.5, 0.5, 0.5),dim=c(2,3,2,2),dimnames= list(Absorption2=c("false","true"),Fcover2 = c("high","low","moderate"), Diversity2=c("high","moderate"), Autonomy2=c("low","moderate")))
Adaptation.prob <- array(c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.75, 0.25, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.75, 0.25, 0.5, 0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.625, 0.375, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.75, 0.25, 0.75, 0.25, 0.75, 0.25, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5 ,0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5), dim=c(2,3,2,2,2,2,2),dimnames=list(Adaptation=c("false","true"),Precipitation=c("high","low","moderate"),Fcover=c("low","moderate"),Diversity=c("low","moderate"),Organization=c("deficient","low"),Connectivity=c("deficient","low"),Autonomy=c("deficient","low")))
Adaptation1.prob <- array(c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5, 0.5, 0.75, 0.25, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.25, 0.75, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.75, 0.25, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.25 ,0.75, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.75 ,0.25, 0.75, 0.25, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ),
                          dim=c(2,2,2,3,2,2,2),dimnames=list(Adaptation1=c("false","true"),Precipitation1=c("low","moderate"),Fcover1=c("low","moderate"),Diversity1=c("high","low","moderate"),Organization1=c("low","moderate"),Connectivity1=c("low","moderate"),Autonomy1=c("deficient","low")))
Adaptation2.prob <- array(c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.25, 0.75, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.25, 0.75 ,0.25, 0.75 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.75, 0.25, 0.25, 0.75, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.25, 0.75, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.25, 0.75, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.25, 0.75, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5 ,0.5 ,0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5),
                          dim=c(2,3,3,2,2,2,2),dimnames=list(Adaptation2=c("false","true"),Precipitation2=c("high","low","moderate"),Fcover2=c("high","low","moderate"),Diversity2=c("high","moderate"),Organization2=c("high","moderate"),Connectivity2=c("high","moderate"),Autonomy2=c("low","moderate")))
Transformation.prob <- array(c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.8333333333333333, 0.1666666666666667, 0.5, 0.5, 0.5, 0.5, 0.875, 0.125, 0.75, 0.25, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),dim=c(2,2,2,2,2), dimnames= list(Transformation=c("false","true"),Fires= c("high","moderate"),Density=c("low","moderate"),Organization=c("deficient","low"),Connectivity=c("deficient","low")))
Transformation1.prob <- array(c(0.5, 0.5, 0.75, 0.25, 0.5, 0.5, 0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.25, 0.75, 0.5, 0.5, 0.875, 0.125, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.25, 0.75, 0.5, 0.5),dim=c(2,3,2,2,2,2), dimnames= list(Transformation1=c("false","true"),Fires1= c("high","low","moderate"),Density1=c("low","moderate"),Organization1=c("low","moderate"),Connectivity1=c("low","moderate"),Transformation=c("false","true")))
Transformation2.prob <- array(c(0.375, 0.625, 0.125, 0.875, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.25, 0.75, 0.5 ,0.5, 0.75, 0.25, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),dim=c(2,2,2,2,2,2), dimnames= list(Transformation2=c("false","true"),Fires2= c("low","moderate"),Density2=c("high","moderate"),Organization2=c("high","moderate"),Connectivity2=c("high","moderate"),Transformation1=c("false","true")))
Function.prob <- array(c(0.6875, 0.3125, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.75, 0.25), dim=c(2,2,2,2), dimnames= list(Function=c("false","true"),Absorption=c("false","true"),Adaptation=c("false","true"),Transformation=c("false","true")))
Function1.prob <- array(c(0.7000000000000001, 0.3, 0.75, 0.25 ,0.75, 0.25 ,0.5 ,0.5 ,0.5, 0.5, 0.5 ,0.5, 0.5, 0.5 ,0.1666666666666667 ,0.8333333333333333), dim=c(2,2,2,2), dimnames= list(Function1=c("false","true"),Absorption1=c("false","true"),Adaptation1=c("false","true"),Transformation1=c("false","true")))
Function2.prob <- array(c(0.75, 0.25, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5, 0.5 ,0.5, 0.5, 0.5, 0.25, 0.75, 0.07142857142857142, 0.9285714285714285), dim=c(2,2,2,2), dimnames= list(Function2=c("false","true"),Absorption2=c("false","true"),Adaptation2=c("false","true"),Transformation2=c("false","true")))


cpt <- list(Fires = Fires.prob, Fires1 = Fires1.prob, Fires2=Fires2.prob, Precipitation = Precipitation.prob,Precipitation1 = Precipitation1.prob,Precipitation2 = Precipitation2.prob,
            Fcover = Fcover.prob, Fcover2 = Fcover2.prob,Fcover1 = Fcover1.prob,Diversity=Diversity.prob,Diversity1=Diversity1.prob,Diversity2=Diversity2.prob,
            Density=Density.prob,Density1=Density1.prob,Density2=Density2.prob, Organization = Organization.prob,Organization1 = Organization1.prob,Organization2 = Organization2.prob,
            Connectivity=Connectivity.prob,Connectivity1=Connectivity1.prob,Connectivity2=Connectivity2.prob,
            Autonomy=Autonomy.prob,Autonomy1=Autonomy1.prob,Autonomy2=Autonomy2.prob,
            Absorption = Absorption.prob,Absorption1 = Absorption1.prob,Absorption2 = Absorption2.prob, Adaptation=Adaptation.prob,Adaptation1=Adaptation1.prob,Adaptation2=Adaptation2.prob,
            Transformation = Transformation.prob,Transformation1 = Transformation1.prob,Transformation2 = Transformation2.prob,
            Function = Function.prob,Function1 = Function1.prob,Function2 = Function2.prob)

resilience <- custom.fit(dag,cpt)

usethis::use_data(resilience, overwrite = TRUE)


