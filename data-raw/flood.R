# A trade-off between farm production and flood alleviation using land use tillage preferences as a natural flood management (NFM) strategy

library(bnlearn)
flood.dag <- model2network("[Land_Use][Texture][Tillage|Land_Use:Texture][Bulk_Density|Texture:Land_Use:Tillage][SOMC|Texture:Land_Use:Tillage][VESS|Texture:SOMC:Bulk_Density][Rainfall][Temperature][Water_Stress|Rainfall:Temperature][Weight|Water_Stress:Rainfall:Temperature][Product_Weight|Weight][Slope][Weeds|SOMC:Tillage][Senesced|SOMC:Weight][Water|Tillage:Senesced:Rainfall][Daily_Runoff|Slope:Rainfall:Water][Runoff|Daily_Runoff:Weeds:VESS:Bulk_Density][Flood_Alleviation|Runoff][Erosion|Bulk_Density:Runoff:Tillage][Nutrients|SOMC:Erosion:Weeds][Yield|Product_Weight:Nutrients:Land_Use][Farm_Yield|Yield]")
lvLand <- c("Arable","Arable With Grass","Grassland","Woodland")
lvTexture <- c("Loamy","Clay")
lvTillage <- c("Conservational","Conventional")
lvBulk <- c("0 to 0.25","0.25 to 0.5", "0.5 to 0.75", "0.75 to 1", "1 to 1.25", "1.25 to 1.5")
lvSOMC <- c("0 to 1.833e5","1.833e5 to 3.666e5", "3.666e5 to 5.499e5","5.499e5 to 7.322e5", "7.322e5 to 9.165e5")
lvVESS <- c("Fragile","Intact","Firm","Compact","Very Compact")
lvRain <- c("0 to 0.4","0.4 to 0.8","0.8 to 1.2", "1.2 to 1.6","1.6 to 2","2 to 2.4", "2.4 to 2.8")
lvTemperature <- c("7.5 to 8.54","8.54 to 9.06","9.06 to 9.58","9.58 to 10.1","10.1 to 10.62")
lvStress <- c("0 to 3.66","3.66 to 7.32","7.32 to 10.98", "10.98 to 14.64")
lvWeigth <- c("0 to 5000", "5000 to 10000", "10000 to 15000", "15000 to 20000", "20000 to 25000")
lvProduct <- c("0 to 2550", "2550 to 5100", "5100 to 7650", "7650 to 10200")
lvSlope <- c("Flat","Sloped")
lvWeeds <- c("Present","Absent")
lvSenesced <- c("0 to 77.5", "77.5 to 155", "155 to 232.5", "232.5 to 310")
lvWater <- c("0 to 159","159 to 318","318 to 477","477 to 636")
lvRunoff1 <- c("0 to 18","18 to 36", "36 to 54", "54 to 72")
lvRunoff<-c("0 to 7.7", "7.7 to 15.4")
lv <- c("Positive","Negative")
lv1 <- c("High","Low")


land.prob <- array(c(0.54444,0.20,0.18889,0.06667),dim=4,dimnames=list(Guilty=lvLand))
texture.prob <- array(c(0.72839,0.2716),dim=2,dimnames=list(Texture=lvTexture))
tillage.prob <- array(c(0.48485,0.51515,0.63636,0.36364,0.4,0.6,0.57143,0.42857,0.72727,0.27273,0.66667,0.33333,0.66667,0.33333,0.5,0.5 ),dim=c(2,2,4),dimnames=list(Tillage=lvTillage,Texture=lvTexture,Land_Use=lvLand))
bulk.prob <- array(c(0.09091, 0.09091, 0.0909091 ,0.181818,0.454545, 0.0909091, 0.111111,0.111111,0.111111,0.222222,0.333333,0.111111,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.0833333,0.0833333,0.25,0.25,0.25,0.0833333,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.142857,0.142857,0.142857,0.142857,0.285714,0.142857,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.0833333,0.0833333,0.0833333,0.166667,0.333333,0.25,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.142857,0.142857,0.142857,0.142857,0.285714,0.142857,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.142857,0.142857,0.285714,0.142857,0.142857,0.142857,0.142857,0.142857,0.142857,0.285714,0.142857,0.142857,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667,0.166667),dim=c(6,2,4,2),dimnames=list(Bulk_Density=lvBulk,Texture=lvTexture,Land_Use=lvLand,Tillage=lvTillage))
SOMC.prob <- array(c(0.1,0.5,0.2,0.1,0.1,0.125   , 0.375  , 0.125  ,0.25  , 0.125, 0.2  ,  0.2,   0.2  , 0.2  , 0.2, 0.2 , 0.2 , 0.2 , 0.2  , 0.2,0.181818 , 0.0909091       , 0.272727, 0.272727 ,0.181818, 0.2  , 0.2 ,  0.2, 0.2  ,0.2, 0.166667 ,0.166667 , 0.333333, 0.166667 , 0.166667,0.2 ,  0.2   ,  0.2 ,  0.2 , 0.2,0.181818 ,  0.454545,  0.181818   , 0.0909091 , 0.0909091, 0.2  ,  0.2   , 0.2 ,  0.2   , 0.2,0.166667 , 0.166667,0.333333,0.166667, 0.166667,0.2  , 0.2,  0.2  , 0.2  , 0.2,0.166667 , 0.166667 , 0.166667, 0.166667 , 0.333333, 0.166667, 0.166667,0.333333 , 0.166667 ,0.166667,0.2, 0.2 ,   0.2 , 0.2 , 0.2,0.2 ,0.2 , 0.2 , 0.2 , 0.2),dim=c(5,2,4,2),dimnames=list(SOMC=lvSOMC,Texture=lvTexture,Land_Use=lvLand,Tillage=lvTillage))
VESS.prob <- array(c(rep(0.2,16*5),0.166667,0.333333,0.166667,0.166667,0.166667,0.2,0.2,0.2,0.2,0.2,0.285714,0.142857,0.285714,0.142857,0.142857,rep(0.2,5*5),0.25,0.125,0.375,0.125,0.125,rep(0.166667,4),0.333333,0.333333,rep(0.166667,4),0.333333,rep(0.166667,4),rep(0.2,10),0.166667,0.333333,0.166667,0.166667,0.166667,0.2,0.2,0.2,0.2,0.2,0.0833333,0.333333,0.166667,0.25,0.166667,0.142857,0.285714,0.285714,0.142857,0.142857,0.125,0.25,0.375,0.125,0.125,rep(0.2,25),0.166667,0.166667,0.166667,0.333333,0.166667,0.2,0.2,0.2,0.2,0.2,0.166667,0.166667,0.166667,0.333333,0.166667,rep(0.2,7*5)),dim=c(5,2,5,6),dimnames=list(VESS=lvVESS,Texture=lvTexture,SOMC=lvSOMC,Bulk_Density=lvBulk))
rain.prob <- array(c(0.000541418,0.0221982,0.0655116,0.249594,0.498646,0.119654,0.0438549), dim=7,dimnames=list(Rainfall=lvRain))
temperature.prob <- array(c(0.304065,0.249865,0.271545,0.152304,0.0222222),dim=5,dimnames=list(Temperature=lvTemperature))
stress.prob <- array(c(0.25     , 0.25    ,  0.25   ,   0.25,  0.25  ,    0.25     , 0.25  ,    0.25      ,   0.25    ,  0.25   ,   0.25  ,    0.25,    0.054878      ,     0.0426829   ,     0.493902 ,          0.408537,  0.0185185    ,    0.111111         ,  0.743827,           0.126543, 0.0357143      ,  0.0833333     ,   0.773809     ,      0.107143,0.25     , 0.25    ,  0.25,      0.25,  0.25  ,   0.25   ,   0.25,      0.25,  0.113636   ,        0.25    ,  0.613636   ,        0.0227273, 0.113636      ,     0.0227273    ,    0.840909 ,          0.0227273, 0.0706522     ,   0.103261          , 0.755435    ,       0.0706522, 0.0182927   ,     0.0792683      ,  0.640244  ,         0.262195,  0.0227273      ,  0.113636        ,  0.659091     ,      0.204545, 0.25     , 0.25   ,   0.25  ,    0.25,  0.25  ,    0.25    ,  0.25   ,   0.25,  0.25,      0.25  ,    0.25  ,    0.25,    0.107143       ,    0.107143      ,     0.773809,           0.0119048,  0.107143      ,     0.333333        ,   0.547619 ,          0.0119048,  0.00409836    ,  0.110656       ,    0.684426 ,          0.20082, 0.015625       ,    0.140625        ,   0.828125  ,         0.015625,  0.0227273      ,  0.113636        ,   0.659091  ,         0.204545,  0.25   ,   0.25   ,   0.25 ,     0.25,  0.25  ,    0.25   ,   0.25 ,     0.25,0.25    ,  0.25 ,     0.25,      0.25,  0.113636     ,      0.113636      ,     0.75  ,    0.0227273, 0.0441176   ,     0.328431         ,  0.455882    ,       0.171569, 0.0454546      ,  0.181818    ,       0.75  ,    0.0227273, 0.25  ,    0.25    ,  0.25   ,   0.25,   0.25   ,   0.25   ,   0.25  ,    0.25,  0.25    ,  0.25    ,  0.25    ,  0.25, 0.25     , 0.25   ,   0.25    ,  0.25, 0.25   ,   0.25    ,  0.25  ,    0.25,  0.25 ,     0.25  ,    0.25 ,  0.25, 0.25 ,  0.25  , 0.25 , 0.25,0.0227273  ,0.113636, 0.727273 ,0.136364), dim=c(4,7,5), dimnames= list(Water_Stress=lvStress,Rainfall=lvRain,Temperature=lvTemperature))
weigth.prob <- array(c(0.2  ,   0.2  , 0.2   ,0.2 ,  0.2,  0.2,0.2, 0.2  ,  0.2  ,   0.2, 0.2 ,  0.2 ,  0.2  , 0.2 ,  0.2, 0.0769231 ,  0.538462, 0.230769 , 0.0769231 ,0.0769231, 0.1 ,0.5  , 0.2 ,  0.1 , 0.1,  0.142857   ,  0.428571   ,   0.142857  ,  0.142857  ,  0.142857, 0.2 ,  0.2 ,   0.2  , 0.2 ,0.2, 0.2 ,   0.2 ,  0.2, 0.2 ,0.2, 0.555556, 0.111111 , 0.111111,0.111111,0.111111, 0.111111 ,  0.555556 ,  0.111111 ,0.111111 , 0.111111, 0.0588235  , 0.529412    ,0.176471 ,0.176471 , 0.0588235, 0.142857 ,0.142857 ,0.142857,0.428571,0.142857,0.2 ,0.2 ,0.2  ,0.2  , 0.2,0.2,0.2,  0.2  , 0.2  ,0.2,0.2   ,0.2   , 0.2  ,0.2 , 0.2,   0.2  ,   0.2 ,   0.2,  0.2  , 0.2, 0.538462 , 0.230769  ,    0.0769231 ,  0.0769231,  0.0769231,0.0769231 , 0.0769231 , 0.692308 ,0.0769231,  0.0769231, 0.2 , 0.2 ,0.2 ,  0.2  , 0.2, 0.2 ,  0.2 , 0.2 , 0.2  , 0.2,0.2  ,  0.2  ,   0.2  , 0.2 , 0.2, 0.2 ,  0.2 , 0.2 , 0.2 , 0.2, 0.2 ,   0.2  ,  0.2 , 0.2 , 0.2,0.2  ,     0.2 ,   0.2 ,  0.2  ,  0.2, 0.111111  , 0.111111 ,  0.555556  ,   0.111111 , 0.111111,  0.0769231 , 0.384615 ,  0.384615 ,  0.0769231 , 0.0769231,  0.166667 , 0.166667   , 0.333333  , 0.166667 , 0.166667, 0.2, 0.2 ,  0.2 , 0.2 ,0.2,  0.2 , 0.2,0.2 ,0.2 , 0.2, 0.2 ,0.2,0.2 ,0.2,  0.2,0.2 , 0.2 , 0.2 , 0.2,0.2, 0.2 ,0.2 ,0.2 , 0.2 ,0.2,0.2,0.2,0.2 ,0.2,  0.2,0.2 ,0.2,0.2 , 0.2 ,0.2,  0.2 ,0.2, 0.2 ,0.2 , 0.2, 0.2 , 0.2,   0.2,  0.2 , 0.2,
                       0.2  , 0.2  ,  0.2 , 0.2, 0.2,  0.2  ,  0.2 ,  0.2 , 0.2,  0.2, 0.272727  , 0.0909091, 0.454545 ,0.0909091 ,0.0909091, 0.175 , 0.375,  0.3   , 0.125 , 0.025, 0.0909091 , 0.272727 ,0.454545 , 0.0909091, 0.0909091,0.2  ,0.2 , 0.2 ,0.2 , 0.2,  0.2 ,   0.2, 0.2 , 0.2, 0.2, 0.733333 , 0.0666667,0.0666667 ,0.0666667 ,0.0666667,0.2 ,0.2 , 0.2  ,0.2 ,0.2,0.434783 , 0.26087  ,0.217391 ,  0.0434783 , 0.0434783,0.176471  ,  0.0588235  ,  0.529412 , 0.176471,   0.0588235,   0.111111 ,   0.111111   , 0.555556  , 0.111111   , 0.111111,0.2 , 0.2 ,  0.2  , 0.2  , 0.2,  0.2 , 0.2 ,0.2 , 0.2, 0.2, 0.2,  0.2,  0.2 ,  0.2 , 0.2,0.538462,  0.230769 , 0.0769231 , 0.0769231, 0.0769231, 0.78125 ,  0.125 , 0.03125, 0.03125 , 0.03125, 0.0967742  , 0.0645161, 0.709677, 0.0967742 , 0.0322581, 0.230769 , 0.0769231 ,  0.230769, 0.384615 , 0.0769231, 0.111111 , 0.111111 , 0.111111 ,  0.555556 , 0.111111,0.2, 0.2 , 0.2 , 0.2 , 0.2, 0.2, 0.2 ,0.2 ,0.2 ,0.2, 0.2 ,   0.2,0.2 ,   0.2 , 0.2,  0.555556  ,   0.111111  , 0.111111 ,  0.111111 ,    0.111111,0.746479 ,  0.0422535   ,0.126761  ,  0.0140845 , 0.0704225, 0.416667 ,0.0833333  ,0.333333, 0.0833333 , 0.0833333, 0.2 ,  0.2 , 0.2 , 0.2, 0.2,0.2,0.2  ,0.2,  0.2, 0.2, 0.2 ,  0.2 ,  0.2  ,  0.2 ,  0.2, 0.2  ,   0.2, 0.2 ,  0.2 , 0.2, 0.2, 0.2, 0.2  ,   0.2 ,  0.2, 0.2  , 0.2 ,   0.2  ,    0.2  ,  0.2, 0.2  ,  0.2  , 0.2 ,  0.2 , 0.2, 0.111111 ,  0.111111 , 0.444444 ,  0.222222 ,  0.111111,
                       0.2   , 0.2   ,   0.2  ,   0.2  , 0.2,  0.2  ,  0.2  ,  0.2 ,  0.2 , 0.2,  0.2 ,    0.2 ,   0.2,    0.2 ,  0.2,    0.388235  ,     0.282353   ,     0.105882  ,    0.164706  , 0.0588235,   0.318367     ,   0.269388  , 0.2  ,0.2 ,0.0122449, 0.130435 , 0.391304 ,  0.333333  ,0.130435,0.0144928,     0.2 ,    0.2  ,   0.2 ,  0.2  ,  0.2,  0.2 ,   0.2 , 0.2  , 0.2 ,   0.2,  0.225806 ,      0.419355  ,    0.16129  ,   0.16129 ,  0.0322581, 0.0731707   , 0.195122   ,   0.317073 ,     0.390244 ,    0.0243902, 0.20979 ,    0.237762  ,   0.314685,   0.230769  ,   0.00699301, 0.155963  ,   0.311927  , 0.220184  ,  0.284404 ,  0.0275229, 0.333333 ,  0.333333 ,0.272727,0.030303, 0.030303, 0.2  ,0.2   ,  0.2  ,  0.2  ,   0.2, 0.2  , 0.2  ,  0.2  ,  0.2 ,  0.2,0.2 ,  0.2 ,   0.2  , 0.2 ,    0.2,0.0434783, 0.246377  , 0.376812  , 0.318841  ,  0.0144928,  0.12 , 0.18 ,  0.24, 0.36 , 0.1, 0.251462 ,0.269006 , 0.210526 ,  0.22807 , 0.0409357, 0.0350877 ,0.280702   , 0.175439 ,  0.210526 ,  0.298246, 0.0909091,0.424242  ,  0.30303 ,  0.151515  , 0.030303, 0.2  ,0.2 ,   0.2 ,  0.2  ,0.2, 0.2   , 0.2,  0.2 ,  0.2 , 0.2, 0.2 ,  0.2,  0.2,  0.2 ,  0.2,   0.189189 , 0.297297   , 0.027027  ,  0.243243 ,  0.243243,0.0927835,0.257732  ,   0.278351,  0.257732 , 0.113402,  0.351351 ,  0.135135 ,  0.243243  ,   0.027027 ,  0.243243, 0.2  , 0.2 ,  0.2 ,  0.2 ,  0.2,0.2  ,  0.2 ,  0.2  ,  0.2 ,  0.2,0.2 , 0.2 ,  0.2 ,    0.2  , 0.2, 0.2  , 0.2  ,  0.2 , 0.2 ,   0.2,  0.2 , 0.2 ,   0.2 ,  0.2 , 0.2,  0.2  , 0.2 , 0.2  ,  0.2 ,    0.2,  0.2  ,  0.2,0.2 , 0.2 , 0.2, 0.472222 ,0.138889, 0.138889  ,   0.222222 , 0.0277778, 0.2 ,  0.2 ,   0.2  ,   0.2 ,  0.2,0.2  , 0.2 ,0.2 ,  0.2 ,  0.2,0.2 , 0.2  , 0.2,  0.2 ,0.2, 0.521127  ,0.112676 , 0.239437 ,0.112676 ,0.0140845,0.0222222 ,   0.0222222  , 0.222222  , 0.333333  , 0.4,
                       0.0769231, 0.0769231, 0.692308   , 0.0769231  , 0.0769231,  0.2,  0.2,  0.2  , 0.2 , 0.2,  0.2  ,  0.2 ,   0.2  ,  0.2 , 0.2,   0.2 ,   0.2 ,  0.2 , 0.2, 0.2,  0.2 , 0.2,  0.2 , 0.2 ,0.2,0.0588235, 0.0588235 , 0.0588235 , 0.647059 , 0.176471, 0.319149 , 0.446808 , 0.0212766, 0.0212766 ,0.191489, 0.0769231 , 0.0769231, 0.230769 , 0.538462, 0.0769231,0.2 ,0.2 ,0.2 , 0.2 ,0.2, 0.2  , 0.2  , 0.2   ,0.2,  0.2, 0.2, 0.2 ,   0.2 , 0.2  , 0.2,  0.2   ,  0.2  ,  0.2    , 0.2  ,0.2,   0.2  ,  0.2   ,  0.2  ,  0.2  , 0.2,0.0188679  , 0.0943396, 0.320755 ,0.245283 , 0.320755, 0.2    ,0.2,   0.2   , 0.2 ,0.2,  0.0769231 ,0.0769231, 0.0769231 , 0.692308 ,0.0769231, 0.2  , 0.2 , 0.2,  0.2 ,0.2, 0.2 ,  0.2  , 0.2 , 0.2,0.2, 0.2, 0.2 ,  0.2 ,0.2, 0.2, 0.2,  0.2,  0.2 , 0.2,  0.2,0.025641  ,  0.025641, 0.538462,0.025641,0.384615,0.2  ,0.2  ,0.2  ,0.2 ,  0.2,  0.2  , 0.2  , 0.2  ,0.2,  0.2,   0.2  , 0.2  ,  0.2 ,0.2,  0.2,0.2 , 0.2 , 0.2, 0.2, 0.2, 0.2 , 0.2 , 0.2 ,0.2 ,0.2, 0.2 ,0.2,0.2 ,0.2,0.2,0.2,  0.2 , 0.2, 0.2,0.2,0.2, 0.2 ,  0.2, 0.2 , 0.2, 0.1 , 0.1,0.1,0.6    ,  0.1),
                     dim =c(5,7,5,4),dimnames= list(Weight= lvWeigth,Rainfall=lvRain,Temperature=lvTemperature, Water_Stress=lvStress))
product.prob <- array(c(0.993492,rep((1-0.993492)/3,3),0.418552,0.576923,rep(0.00226244,2),0.00215054,0.492473,0.490323,0.0150538,0.0027248,0.0953678,0.798365,0.103542,0.009,0.009,0.504,0.48), dim=c(4,5), dimnames=list(Product_Weight=lvProduct,Weight=lvWeigth))
slope.prob <- array(c(0.5,0.5),dim=2,dimnames=list(Slope=lvSlope))
weeds.prob <- array(c(0.95,0.05,0.96,0.04,0.97,0.03,0.98,0.02,0.99,0.01,0.05,0.95,0.04,0.96,0.03,0.97,0.02,0.98,0.00999999,0.99),dim=c(2,5,2), dimnames=list(Weeds=lvWeeds,SOMC=lvSOMC,Tillage=lvTillage))
senesced.prob <- array(c(0.947126, 0.0436782, 0.00689655,   0.00229885, 0.8125 ,0.0625, 0.0625, 0.0625, 0.833333  ,0.0555556, 0.0555556,  0.0555556,0.25  ,0.25 , 0.25, 0.25, 0.25  , 0.25  ,  0.25  , 0.25,  0.918919   ,0.0675676  , 0.00810811 ,0.00540541,  0.730769  , 0.192308  , 0.0384615 , 0.0384615, 0.833333 , 0.12963   , 0.0185185  ,0.0185185,0.25 , 0.25  , 0.25  , 0.25,0.25  ,0.25  , 0.25 , 0.25,0.809322,   0.173729  , 0.0127119  , 0.00423729, 0.568345 , 0.417266  ,0.00719424, 0.00719424,  0.704082   ,0.27551     ,0.0102041  , 0.0102041, 0.25 ,  0.25  , 0.25 ,0.25, 0.25 ,  0.25 , 0.25 ,0.25,0.5,0.470588 , 0.0147059 ,0.0147059,0.496454  ,0.496454 , 0.0035461 , 0.0035461, 0.48  , 0.44 ,0.04,0.04, 0.25 , 0.25,0.25,0.25,0.25,0.25 ,0.25 ,0.25,0.3125, 0.5625 ,0.0625, 0.0625,  0.174312 ,     0.807339   ,  0.00917431 , 0.00917431,0.125  , 0.625 ,  0.125 , 0.125,0.25 ,0.25, 0.25, 0.25,0.25,0.25,0.25,0.25),dim=c(4,5,5),dimnames=list(Senesced=lvSenesced,SOMC=lvSOMC,Weight=lvWeigth))
water.prob <- array(c(rep(0.25,32),0.387097 , 0.290323 , 0.16129  , 0.16129, 0.387097, 0.290323,  0.16129  ,           0.16129,  0.117647   ,  0.0588235   ,  0.176471  ,  0.647059,0.117647       ,    0.0588235    ,    0.176471       ,    0.647059, 0.25 ,    0.25  , 0.25 ,0.25,   0.25 ,   0.25  ,  0.25 ,  0.25,0.25, 0.25,0.25, 0.25,0.25   , 0.25  , 0.25 ,  0.25,  0.277228  ,   0.287129   ,  0.128713   , 0.306931,    0.277228    , 0.287129  ,    0.128713    , 0.306931,0.0416667,  0.125  , 0.291667 ,  0.541667, 0.0416667  ,  0.125  , 0.291667 ,0.541667, 0.5  , 0.166667, 0.166667 , 0.166667, 0.5 , 0.166667   , 0.166667  , 0.166667, 0.4 , 0.2  ,  0.2  , 0.2, 0.4  ,  0.2 , 0.2 ,0.2,       0.281421  ,    0.300546   ,  0.120219,0.297814, 0.281421  ,0.300546  ,0.120219  , 0.297814,  0.1 ,   0.09  ,0.2  , 0.61,  0.1 ,   0.09  , 0.2 ,0.61, 0.5,  0.166667  ,  0.166667 , 0.166667, 0.5,0.166667 , 0.166667,0.166667, 0.25  ,  0.25  , 0.25    ,  0.25,0.25 ,  0.25  ,  0.25  , 0.25,0.338095 , 0.333333 ,0.0952381, 0.233333,  0.338095   ,0.333333, 0.0952381 ,0.233333,0.0540541 ,  0.0777027  , 0.216216  , 0.652027,0.0540541   , 0.0777027, 0.216216   , 0.652027, 0.5 , 0.166667 ,0.166667 ,0.166667,0.5 ,0.166667,0.166667 , 0.166667, 0.25, 0.25,  0.25 , 0.25,  0.25 ,  0.25,  0.25 , 0.25,   0.27551 , 0.285714  , 0.158163  , 0.280612,  0.27551, 0.285714  ,0.158163  , 0.280612,  0.09375  ,  0.03125    , 0.09375  ,0.78125, 0.09375 , 0.03125   ,0.09375  ,0.78125, 0.25  ,0.25 ,0.25, 0.25, 0.25 ,  0.25  , 0.25   , 0.25,0.25  , 0.25  , 0.25 , 0.25, 0.25 , 0.25  , 0.25,0.25, 0.253165  ,0.265823  , 0.126582, 0.35443, 0.253165 ,   0.265823, 0.126582  , 0.35443,  0.222222 ,0.111111,0.111111 ,0.555556,0.222222 ,0.111111, 0.111111 , 0.555556 , rep(0.25,16)),dim=c(4,2,4,7),dimnames=list(Water=lvWater,Tillage=lvTillage,Senesced=lvSenesced,Rainfall=lvRain))
runoff1.prob <- array(c(0.25  ,  0.25 , 0.25 , 0.25,0.25  , 0.25 , 0.25  , 0.25, 0.7, 0.1, 0.1 ,0.1, 0.7  , 0.1,   0.1 , 0.1,   0.8125 ,0.0625 ,0.0625, 0.0625,0.863636  , 0.0454546  , 0.0454546 ,0.0454546,   0.938775  ,  0.0204082, 0.0204082  ,  0.0204082,  0.944444 , 0.0277778,0.0138889 ,0.0138889, 0.968421  ,  0.0105263  , 0.0105263 ,0.0105263,      0.957747 ,   0.028169  ,  0.00704225  , 0.00704225, 0.884615  , 0.0384615  ,0.0384615, 0.0384615,0.918919 , 0.027027   , 0.027027 ,   0.027027, 0.75,0.0833333 ,0.0833333 ,0.0833333, 0.625 , 0.25  , 0.0625, 0.0625, 0.25  ,0.25  , 0.25 , 0.25,  0.25 ,  0.25 , 0.25 ,  0.25,0.625  , 0.125 ,  0.125 , 0.125, 0.625 ,  0.125 , 0.125 ,0.125, 0.863636  , 0.0454546, 0.0454546, 0.0454546,0.8125 ,0.0625 ,0.0625, 0.0625, 0.945946, 0.027027,0.0135135,0.0135135,0.784314, 0.156863, 0.0392157  , 0.0196078,0.972028 , 0.013986 ,0.00699301,0.00699301, 0.645833 , 0.322917 , 0.0208333  , 0.0104167,0.918919, 0.027027,0.027027, 0.027027, 0.576923,  0.346154,  0.0384615  , 0.0384615,  0.75  ,    0.125 ,   0.0625, 0.0625,  0.25, 0.416667 ,  0.25  , 0.0833333,  0.25 , 0.25, 0.25  ,  0.25, 0.25,  0.25 , 0.25,  0.25,  0.625  ,  0.125  ,  0.125  , 0.125,  0.5, 0.166667, 0.166667 , 0.166667, 0.8125, 0.0625, 0.0625, 0.0625, 0.7, 0.1, 0.1 , 0.1,0.933333 ,  0.0222222 ,  0.0222222 , 0.0222222, 0.8,0.12,0.04, 0.04,0.927711  , 0.0481928  , 0.0120482, 0.0120482, 0.446808,0.446808 ,0.0851064, 0.0212766,   0.88 ,  0.04, 0.04   , 0.04,0.2  , 0.666667 , 0.0666667 , 0.0666667, 0.444444, 0.333333,0.111111, 0.111111,0.125 ,0.375,0.375, 0.125, 0.25, 0.25, 0.25,0.25,0.25,0.25 ,0.25,0.25, 0.7 , 0.1, 0.1 , 0.1, 0.75, 0.0833333 , 0.0833333, 0.0833333, 0.863636   ,0.0454546 , 0.0454546 , 0.0454546, 0.892857,0.0357143 , 0.0357143 , 0.0357143, 0.871795, 0.102564,0.0128205 , 0.0128205,0.632653  ,0.285714 ,0.0612245 , 0.0204082, 0.83871 , 0.148387  , 0.00645161 , 0.00645161,0.335079, 0.586388 , 0.0732984,  0.0052356, 0.763158 , 0.18421 ,0.0263158, 0.0263158, 0.0625, 0.75 , 0.166667 ,  0.0208333,  0.421053 , 0.421053  , 0.105263 , 0.0526316,0.05 ,0.35 ,0.4 ,0.2), dim=c(4,2,7,4),dimnames=list(Daily_Runoff=lvRunoff1,Slope=lvSlope,Rainfall=lvRain,Water=lvWater))
runoff.prob <- array(c(0.99  ,    0.01,  0.98 ,     0.02, 0.97 ,     0.03,    0.96 ,     0.04,  0.4  ,       0.6,  0.39 ,     0.61,    0.38 ,     0.62,       0.37 ,     0.63,  0.95   ,   0.05,     0.94  ,    0.06,    0.93    ,  0.07,   0.92     , 0.08,  0.36 ,     0.64, 0.35      ,0.65, 0.34 ,     0.66,     0.33  ,    0.67,  0.91  ,    0.09,  0.9    ,     0.1,  0.89    ,  0.11, 0.88     , 0.12,   0.32      ,0.68,       0.31,      0.69,     0.3  ,       0.7,   0.29   ,   0.71,    0.87  ,    0.13, 0.86   ,   0.14,       0.85    ,  0.15,  0.84 ,     0.16,    0.28     , 0.72,    0.27      ,0.73,     0.26   ,   0.74,  0.25     , 0.75,   0.83    ,  0.17,    0.82     , 0.18,    0.81,      0.19,    0.8,         0.2,   0.24,      0.76,   0.23 ,     0.77,  0.22   ,   0.78,  0.21  ,    0.79,  0.95   ,   0.05,  0.94   ,   0.06,  0.93   ,   0.07,  0.92   ,   0.08,   0.36 ,     0.64,    0.35 ,     0.65,  0.34 ,     0.66,  0.33 ,     0.67, 0.91 ,     0.09,   0.9  ,       0.1,    0.89  ,    0.11,  0.88 ,     0.12,0.32 ,     0.68,    0.31  ,    0.69,   0.3  ,       0.7, 0.29 ,     0.71,  0.87 ,     0.13, 0.86 ,     0.14,0.85   ,   0.15,0.84  ,    0.16, 0.28    ,  0.72,  0.27   ,   0.73,   0.26   ,   0.74,  0.25 ,     0.75,  0.83 ,     0.17,   0.82  ,    0.18,      0.81  ,    0.19,    0.8  ,       0.2,    0.24 ,     0.76, 0.23 ,     0.77,0.22 ,     0.78,  0.21 ,     0.79,    0.79 ,     0.21,   0.78 ,     0.22,     0.77 ,     0.23,      0.76 ,     0.24,      0.2  ,       0.8,     0.19  ,    0.81, 0.18 ,     0.82,       0.17  ,    0.83,    0.91   ,   0.09,     0.9  ,       0.1, 0.89   ,   0.11,   0.88  ,    0.12,   0.32    ,  0.68,     0.31 ,     0.69, 0.3  ,       0.7,   0.29  ,    0.71,   0.87  ,    0.13,  0.86 ,     0.14,  0.85  ,    0.15, 0.84  ,    0.16,      0.28 ,     0.72, 0.27  ,    0.73,  0.26   ,   0.74,  0.25    ,  0.75,0.83   ,   0.17,0.82   ,   0.18,  0.81   ,   0.19, 0.8  ,       0.2,   0.24  ,    0.76,  0.23 ,     0.77,                      0.22  ,    0.78,   0.21   ,   0.79,     0.79     , 0.21,  0.78    ,  0.22, 0.77     , 0.23, 0.76 ,     0.24,     0.2  ,       0.8,   0.19 ,     0.81,     0.18 ,     0.82,   0.17 ,     0.83, 0.75  ,    0.25,  0.74  ,    0.26,   0.73 ,     0.27,  0.72 ,     0.28,  0.16 ,     0.84, 0.15 ,     0.85,   0.14 ,     0.86,  0.13  ,    0.87,0.87 ,     0.13,  0.86 ,     0.14, 0.85  ,    0.15,0.84 ,     0.16,  0.28 ,     0.72,  0.27 ,     0.73,0.26 ,     0.74, 0.25  ,    0.75,  0.83 ,     0.17,  0.82 ,     0.18,    0.81  ,    0.19,     0.8   ,      0.2,     0.24 ,     0.76, 0.23 ,     0.77,0.22 ,     0.78, 0.21 ,     0.79,
                       0.79 ,     0.21,0.78 ,     0.22 , 0.77   ,   0.23 , 0.76   ,   0.24,0.2    ,     0.8  ,  0.19   ,   0.81 , 0.18   ,   0.82,  0.17   ,   0.83,   0.75   ,   0.25  ,0.74   ,   0.26     , 0.73   ,   0.27    ,   0.72   ,   0.28    ,        0.16   ,   0.84      , 0.15   ,   0.85   , 0.14  ,    0.86    ,  0.13 ,     0.87     ,  0.71,      0.29     ,  0.7,         0.3,       0.69,      0.31  ,  0.68,      0.32  ,         0.12,      0.88   , 0.11,      0.89     , 0.1,         0.9    , 0.09 ,     0.91   ,  0.83 ,     0.17       , 0.82 ,     0.18  ,   0.81 ,     0.19 ,  0.8  ,       0.2 ,  0.24 ,     0.76  ,  0.23 ,     0.77     , 0.22 ,     0.78 ,  0.21 ,     0.79   , 0.79 ,     0.21  ,0.78 ,     0.22   , 0.77 ,     0.23    ,   0.76 ,     0.24      ,0.2  ,       0.8   ,  0.19 ,     0.81 ,0.18 ,     0.82     , 0.17 ,     0.83        ,  0.75 ,     0.25 ,0.74 ,     0.26       , 0.73 ,     0.27  ,  0.72 ,     0.28  , 0.16 ,     0.84    ,  0.15 ,     0.85   ,   0.14 ,     0.86   ,   0.13 ,     0.87     ,  0.71 ,     0.29,  0.7  ,       0.3 , 0.69 ,     0.31 , 0.68 ,     0.32  , 0.12 ,     0.88 ,0.11 ,     0.89 , 0.1  ,       0.9   , 0.09 ,     0.91 , 0.67 ,     0.33, 0.66 ,     0.34  ,0.65  ,    0.35   , 0.64 ,     0.36  , 0.08 ,     0.92  , 0.07 ,     0.93   , 0.06 ,     0.94     , 0.05 ,     0.95   ,0.79  ,    0.21    ,  0.78  ,    0.22    , 0.77 ,     0.23   , 0.76  ,    0.24   , 0.2  ,       0.8  , 0.19 ,     0.81     ,0.18 ,     0.82    ,  0.17 ,     0.83  , 0.75 ,     0.25   , 0.74  ,    0.26   , 0.73 ,     0.27 , 0.72 ,     0.28 ,  0.16 ,     0.84  ,  0.15 ,     0.85  , 0.14 ,     0.86   ,  0.13 ,     0.87, 0.71 ,     0.29   , 0.7  ,       0.3,  0.69 ,     0.31, 0.68 ,     0.32   , 0.12,      0.88 ,  0.11,      0.89  ,  0.1  ,       0.9 ,  0.09 ,     0.91  , 0.67 ,     0.33   , 0.66 ,     0.34   ,0.65 ,     0.35  ,0.64  ,    0.36    ,0.08 ,     0.92   ,0.07,      0.93, 0.06 , 0.94, 0.05 , 0.95, 0.63  ,    0.37, 0.62 , 0.38, 0.61 , 0.39, 0.6 , 0.4, 0.04 , 0.96 ,  0.03   ,   0.97, 0.02   ,   0.98, 0.00999999 ,0.99),
                     dim=c(2,4,2,5,6),dimnames=list(Runoff=lvRunoff,Daily_Runoff=lvRunoff1,Weeds=lvWeeds,VESS=lvVESS, Bulk_Density=lvBulk))
alleviation.prob <- array(c(0.99,0.009999999,0.01,0.99),dim=c(2,2),dimnames=list(Flood_Alleviation=lv,Runoff=lvRunoff))
erosion.prob <- array(c(0.02,0.98,0.03,0.97,0.04,0.96,0.05,0.95,0.06,0.94,0.07,0.93,0.08,0.92,0.09,0.91,0.10,0.90,0.11,0.89,0.12,0.88,0.13,0.87,0.88,0.12,0.89,0.11,0.9,0.1,0.91,0.09,0.92,0.08,0.93,0.07,0.94,0.06,0.95,0.05,0.96,0.04,0.97,0.03,0.98,0.02,0.99,0.01),dim=c(2,6,2,2),dimnames=list(Erosion=lv1,Bulk_Density=lvBulk,Runoff=lvRunoff,Tillage=lvTillage))
nutrients.prob <- array(c(0.8,0.2,0.85,0.15,0.9,0.1,0.95,0.05,0.99,0.01,0.75,0.25,0.8,0.2,0.85,0.15,0.9,0.1,0.95,0.05,0.5,0.5,0.55,0.45,0.6,0.4,0.65,0.35,0.7,0.3,0.2,0.8,0.15,0.85,0.1,0.9,0.05,0.95,0.01,0.99),dim=c(2,5,2,2),dimnames=list(Nutrients=lv1,SOMC=lvSOMC,Erosion=lv1,Weeds=lvWeeds))
yield.prob=array(c(0.7,0.3,0.65,0.35,0.6,0.4,0.55,0.45,0.04,0.96,0.03,0.97,0.02,0.98,0.01,0.99,0.8,0.2,0.75,0.25,0.7,0.3,0.65,0.35,0.65,0.35,0.6,0.4,0.55,0.45,0.5,0.5,0.85,0.15,0.8,0.2,0.75,0.25,0.7,0.3,0.7,0.3,0.65,0.35,0.6,0.4,0.55,0.45,0.95,0.05,0.9,0.1,0.85,0.15,0.8,0.2,0.75,0.25,0.7,0.3,0.65,0.35,0.6,0.4),dim=c(2,4,2,4),dimnames=list(Yield=c("Decrease","Increase"),Product_Weight=lvProduct,Nutrients=lv1,Land_Use=lvLand))
farm.prob <- array(c(0.01,0.99,0.99,0.01),dim=c(2,2),dimnames=list(Farm_Yield=lv,Yield=c("Decrease","Increase")))
cpt <- list(Land_Use=land.prob, Texture=texture.prob,Tillage=tillage.prob,
            Bulk_Density=bulk.prob, SOMC=SOMC.prob, VESS=VESS.prob, Rainfall=rain.prob,
            Temperature=temperature.prob, Water_Stress=stress.prob,Weight=weigth.prob, Product_Weight=product.prob,
            Slope=slope.prob,Weeds=weeds.prob,Senesced=senesced.prob,
            Water=water.prob, Daily_Runoff = runoff1.prob,Runoff=runoff.prob,
            Flood_Alleviation=alleviation.prob,Erosion=erosion.prob,
            Nutrients=nutrients.prob,Yield=yield.prob,Farm_Yield=farm.prob)

flood <- custom.fit(flood.dag,cpt)

usethis::use_data(flood, overwrite = TRUE)
