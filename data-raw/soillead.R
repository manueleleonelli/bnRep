
library(bnlearn)

dag <- model2network("[SoilPH|MedianHouseholdIncome:BlackPercentage:HouseAge:SoilPbAbove100ppm][MedianHouseholdIncome|BlackPercentage:DistanceToMajorRoad:HouseValue:SoilPbAbove100ppm][SoilSamplingLocation|HouseValue:SoilPbAbove100ppm][DistanceToMajorRoad|BlackPercentage:SoilClay:SoilPbAbove100ppm][BlackPercentage|HouseAge:HouseValue:SoilPbAbove100ppm][HouseValue|SoilClay:HouseAge:SoilPbAbove100ppm][SoilPbAbove100ppm][SoilClay|SoilPbAbove100ppm][HouseAge|SoilClay:SoilPbAbove100ppm]")
lv <- c("0", "1")
lvClay <- c("Below 26.14", "26.14-33.125", "Above 33.125")
lvAge <- c("Below 4.2", "4.2-7.9", "Above 7.9")
lvValue <- c("Below 1.292", "1.292-2.859", "Above 2.859")
lvBlack <- c("Below 0.355", "0.355-0.727", "Above 0.727")
lvDistance <- c("Below 500", "500-1000", "Above 1000")
lvLocation <- c("Dripline", "Streetside", "Yard")
lvIncome <- c("Below 0.255", "0.255-0.470", "Above 0.470")
lvPH <- c("Below 5.316", "5.316-5.974", "Above 5.974")

SoilPbAbove100ppm <- array(c(0.5,0.5),2,list(SoilPbAbove100ppm=lv))
SoilClay <- array(0.01*c(12.3010,84.4437,3.2553,0.9530,99.0453,0.0017),c(3,2),list(SoilClay=lvClay,SoilPbAbove100ppm=lv))
HouseAge <- array(0.01*c(84.9419,14.4348,0.6234,10.7233,62.6876,26.5891,35.0795,64.9075,0.0130,0.0585,57.7211,42.2203,11.3061,49.9981,38.6958,31.9229,33.1380,34.9390),c(3,3,2),list(HouseAge=lvAge,SoilClay=lvClay,SoilPbAbove100ppm=lv))
HouseValue <- array(0.01*c(30.8065,69.1921,0.0013,87.8019,12.1959,0.0022,0.0134,33.333,66.6536,99.9198,0.0722,0.008,80.7578,19.2419,0.0003,21.9710,78.0223,0.0067,99.587,0.2053,0.2077,63.8219,20.7697,15.4085,33.3338,33.3331,33.3331,100/3,100/3,100/3,99.9967,0.0017,0.0017,100/3,100/3,100/3,86.2229,0.1853,13.5918,95.8487,4.1245,0.0268,35.6089,32.1506,32.2405,99.9075,0.0463,0.0462,94.136,2.8316,3.0324,31.4267,36.4627,32.1106),c(3,3,3,2),list(HouseValue=lvValue,SoilClay=lvClay,HouseAge=lvAge,SoilPbAbove100ppm=lv))
BlackPercentage <- array(0.01*c(3.0822,17.2668,79.6510,19.1297,14.9119,65.9584,  32.1180,22.3717,45.5103,   99.9681,0.0016,0.0303,   95.1616,0.0012,4.8372,   70.5748,22.8479,6.5773,   99.9630,0.0185,0.0185,   32.2802,33.3743,34.3455,    99.9918,0.0041,0.0041,   0.8982,14.3464,84.7554,   15.1104,12.2234,72.6662,    8.9816,15.7471,75.2713,   100/3,100/3,100/3,   58.9596,0.0094,41.0310,     81.2367,9.2646,9.4987,   33.3332,33.3332,33.3336,0.2107,0.21114,99.5779,99.9641,0.0160,0.0199),c(3,3,3,2),list(BlackPercentage=lvBlack,HouseAge=lvAge,HouseValue=lvValue,SoilPbAbove100ppm=lv))
DistanceToMajorRoad <- array(0.01*c(20.8351,42.7072,36.4577,    0.4203,99.2242,0.3555,   31.3593,68.6379,0.0028,     85.8547,4.7081,9.4372,    67.5059,26.8051,5.6890,    51.7586,32.7260,15.5154,    0.0046,0.0046,99.9908,   1.3442,97.3116,1.3442,    0.0810, 99.8486,0.0703,    0.0580,99.8957,0.0462,      8.1538,84.7843,7.0619,    0.0605,99.9055,0.0339,     97.6485, 0.7468,1.6046,       54.4774,40.7198,4.8028,   52.4837,39.8081,7.7083,     38.8742,30.5629, 30.5629,     33.3568,33.3529,33.2902,    32.7118,35.2556, 32.0326),c(3,3,3,2),list(DistanceToMajorRoad=lvDistance,BlackPercentage=lvBlack,SoilClay=lvClay,SoilPbAbove100ppm=lv))
SoilSamplingLocation <- array(0.01*c(13.4721,16.1778,70.3501,18.4386,19.0152,62.5462,3.6152,23.4434,72.9414,26.2730,23.7631,49.9639,36.3835,31.0676,32.5490,99.8632,0.0695,0.0673),c(3,3,2),list(SoilSamplingLocation=lvLocation,HouseValue=lvValue,SoilPbAbove100ppm=lv))
MedianHouseholdIncome <- array(0.01*c(87.5412,6.4845,5.9743,69.0671,5.9874,24.9455,55.0038,44.9960,0.0002,     0.0616,99.8768,0.0616,0.0013,99.9974,0.0013,46.8164,53.1833,0.0003,     0.0016,46.8451,53.1533,0.0064,99.9872,0.0064,24.2970,75.7023,0.0007,      1.2226,58.5122,40.2652,0.0044,99.9912,0.0044,0.0281,99.9438,0.0281,    6.7805,0.0010,93.2185,32.6967,34.6066,32.6967,99.9862,0.0073,0.0065,      0.0010,0.0010,99.9980, rep(100/3,6),    0.0014,61.5918,38.4069,100/3,100/3,100/3,33.2172,33.5655,33.2172,      100/3,100/3,100/3,32.2405,35.5190,32.2405,33.1919,35.4458,31.3622,     0.0062,0.0062,99.9876, rep(100/3,6),    61.2146,21.0772,17.7082,38.2179,33.6992,28.0829, 39.5146,60.4852,0.0002,      0.0154,99.9692,0.0154,18.5190,81.4798,0.0012,69.2191,30.7807,0.0002,         0.0287,99.9426,0.0287,0.0097,99.9806,0.0097,0.0013,99.9976,0.0011,     15.1664,25.2752,59.5585,0.0616,99.8768,0.0616,0.0079,99.9843,0.0077,     99.8768,0.0616,0.0616,33.0162,33.9676,33.0162,99.8862,0.0690,0.0448,       100/3,100/3,100/3,32.3804,35.2392,32.3804,100/3,100/3,100/3,    0.0053,60.4762,39.5185, 100/3,100/3,100/3,66.9164,16.5418,16.5418,     100/3,100/3,100/3, 33.3320, 33.3360,33.3320,0.0758,99.8536,0.0706,    100/3,100/3,100/3,33.2223,33.5554,33.2223,100/3,100/3,100/3),c(3,3,3,3,2),list(MedianHouseholdIncome=lvIncome,BlackPercentage=lvBlack,DistanceToMajorRoad=lvDistance, HouseValue=lvValue,SoilPbAbove100ppm=lv))
SoilPH <- array(0.01*c(0.0154,0.0154,99.9692,0.0123,99.9754,0.0123,29.1667,12.5004,58.3329,      0.0066,0.0066,99.9868,0.0154,0.0154,99.9692,25.0013,0.0051,74.9936,      0.0011,0.0011,99.9978,0.0012,36.6785,63.3203,33.3112,33.3112,33.3776,    5.8830,0.0007,94.1163,0.0007,86.1203,13.8790,48.3143,29.2136,22.4721,        11.2597,0.0017,88.7386,0.0016,0.0016,99.9968, 0.0069,0.0069,99.9862,      6.6250,3.6808,89.6942,0.0003,7.1915,92.8082,32.8888,32.8888,34.2224,     7.8797,0.0016,92.1187,0.0010,1.5480,98.4510,0.0019,0.0019,99.9962,      0.0943,0.0025,99.9032,0.0022,0.0022,99.9956,0.0154,0.0154,99.9692,      22.6011,0.0012,77.3977,0.0017,0.0017,99.9966,33.2736,33.2736,33.4528,    0.0616,0.0616,99.8768,rep(100/3,6),    0.0308,0.0308,99.9384,0.0103,0.0103,99.9794,25.0019,0.0077,74.9904,   0.0015,0.0013,99.9972,0.0013,0.0013,99.9974,33.2787,33.2787,33.4426,     0.0015,0.0015,99.9970,0.0034,0.0034,99.9932,7.6941,92.3035,0.0024,     43.9992,0.0025,55.9983,0.0023,0.0023,99.9954,0.0103,0.0103,99.9794,       23.8443,0.0005,76.1552,0.0003,0.0003,99.9994,32.2442,32.2442,35.5116,    30.8422,0.0027,69.1551,0.0036,23.5305,76.4659,0.0123,0.0123,99.9754,      51.3205,0.0062,48.6733,0.0015,0.0015,99.9970, 0.0103,0.0103,99.9794,     9.7722,0.0005,90.2273,0.0005,0.0005,99.999, 33.0829,33.0829,33.8342     ),c(3,3,3,3,2),list(SoilPH=lvPH,MedianHouseholdIncome=lvIncome,BlackPercentage=lvBlack,HouseAge=lvAge,SoilPbAbove100ppm=lv))

soillead <- custom.fit(dag,list(
  SoilPbAbove100ppm=SoilPbAbove100ppm,SoilClay=SoilClay,HouseAge=HouseAge,
  HouseValue=HouseValue,BlackPercentage=BlackPercentage,
  DistanceToMajorRoad=DistanceToMajorRoad,
  SoilSamplingLocation=SoilSamplingLocation,
  MedianHouseholdIncome=MedianHouseholdIncome,
  SoilPH=SoilPH
))


usethis::use_data(soillead, overwrite = TRUE)
