
library(bnlearn)

dag <- model2network("[DoseRate|WaterFlux:CrackAperture:DiffusionCoefficient:DistributionCoefficient:ChemicalDegradation:BarrierDegradation:MonolithDegradation:HydraulicConductivity][Earthquake][WaterFlux][CrackAperture][DiffusionCoefficient][DistributionCoefficient][ChemicalDegradation][BarrierDegradation|Earthquake][MonolithDegradation|Earthquake][HydraulicConductivity|CrackAperture]")
lv <- c("Low","High")
lv1 <- c("Low","Medium","High")
lv2 <- c("Fast","Slow")
lv3 <- c("Very Fast","Fast","Slow")
lv4 <- c("Micro","Macro")
lv5 <- c("BDBE","Major")

Earthquake <- array(c((9.954E-01+9.908E-01)/2,1-(9.954E-01+9.908E-01)/2),c(2),list(Earthquake=lv5))
WaterFlux <- array(c((0.631+0.864)/2,1-(0.631+0.864)/2),c(2),list(WaterFlux=lv))
CrackAperture <- array(c((0.807+0.869)/2,1-(0.807+0.869)/2),c(2),list(CrackAperture=lv4))
DiffusionCoefficient <- array(c((0.5+0.75)/2,1-(0.5+0.75)/2),c(2),list(DiffusionCoefficient=lv))
DistributionCoefficient <- array(c((0.5+0.75)/2,1-(0.5+0.75)/2),c(2),list(DistributionCoefficient=lv))
ChemicalDegradation <- array(c((0.5+0.75+0.55)/3,1-(0.5+0.75+0.55)/3),c(2),list(ChemicalDegradation=lv2))
BarrierDegradation <- array(c((0.25+0.058)/2,1-(0.25+0.058)/2,(0.49+0.36)/2,1-(0.49+0.36)/2),c(2,2),list(BarrierDegradation=lv2,Earthquake=lv5))
MonolithDegradation <- array(c(0.148,0.1625,0.6895,0.148,0.385,0.467),c(3,2),list(MonolithDegradation=lv3,Earthquake=lv5))
HydraulicConductivity <- array(c(0.7405,0.149,1-0.149-0.7405,0.149,0.7405,1-0.149-0.7405),c(3,2),list(HydraulicConductivity=lv1,CrackAperture=lv4))
DoseRate  <- array(c(0.000,1,
                     0.500,0.5,
                     0.250,0.75,
                     0.500,0.5,
                     0.333,0.667,
                     0.667,0.333,
                     0.333,0.667,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.750,0.25,
                     0.000,1,
                     0.667,0.333,
                     0.333,0.667,
                     0.500,0.5,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.667,0.333,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.750,0.25,
                     0.500,0.5,
                     0.333,0.667,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.500,0.5,
                     0.333,0.667,
                     0.667,0.333,
                     0.667,0.333,
                     0.500,0.5,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.667,0.333,
                     0.667,0.333,
                     0.000,1,
                     0.500,0.5,
                     0.667,0.333,
                     0.667,0.333,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.667,0.333,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.500,0.5,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.750,0.25,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.667,0.333,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.667,0.333,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.333,0.667,
                     0.500,0.5,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.750,0.25,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.333,0.667,
                     0.667,0.333,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.333,0.667,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.667,0.333,
                     0.000,1,
                     0.750,0.25,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.333,0.667,
                     0.333,0.667,
                     0.000,1,
                     0.667,0.333,
                     0.333,0.667,
                     0.500,0.5,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.500,0.5,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.750,0.250,
                     0.000,1,
                     0.333,0.667,
                     0.500,0.5,
                     0.667,0.333,
                     0.333,0.667,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.333,0.667,
                     0.667,0.333,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.500,0.5,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.667,0.333,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.667,0.333,
                     0.500,0.5,
                     0.333,0.667,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.667,0.333,
                     0.667,0.333,
                     0.500,0.5,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.250,0.75,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.500,0.5,
                     0.250,0.75,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.500,0.5,
                     0.333,0.667,
                     0.667,0.333,
                     0.667,0.333,
                     0.667,0.333,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.667,0.333,
                     0.333,0.667,
                     0.500,0.5,
                     0.333,0.667,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.500,0.5,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.250,0.75,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.333,0.667,
                     0.000,1,
                     0.333,0.667,
                     0.500,0.5,
                     0.250,0.75,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.500,0.5,
                     0.750,0.25,
                     0.000,1,
                     0.333,0.667,
                     0.500,0.5,
                     0.667,0.333,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.667,0.333,
                     0.000,1,
                     0.667,0.333,
                     0.500,0.5,
                     0.750,0.25,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.500,0.5,
                     0.750,0.25,
                     0.000,1,
                     0.000,1,
                     0.667,0.333,
                     0.667,0.333,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.000,1,
                     0.333,0.667,
                     0.000,1,
                     0.000,1
),c(2,2,2,2,2,2,2,3,3),list(DoseRate=c("Violated","Not Violated"),WaterFlux=lv,CrackAperture=lv4,DiffusionCoefficient=lv,DistributionCoefficient=lv,ChemicalDegradation=lv2,BarrierDegradation=lv2,MonolithDegradation=lv3,HydraulicConductivity=lv1))

nuclearwaste <- custom.fit(dag,list(
  Earthquake =Earthquake,
  WaterFlux=WaterFlux,
  CrackAperture=CrackAperture,
  DiffusionCoefficient=DiffusionCoefficient,
  DistributionCoefficient=DistributionCoefficient,
  BarrierDegradation=BarrierDegradation,
  MonolithDegradation=MonolithDegradation,
  HydraulicConductivity=HydraulicConductivity,
  ChemicalDegradation=ChemicalDegradation,DoseRate=DoseRate
))


usethis::use_data(nuclearwaste, overwrite = TRUE)
