# Using Bayesian networks to map winter habitat for mountain goats in coastal British Columbia, Canada
library(bnlearn)

dag <- model2network("[Location][Solar_Insolation|Location][Snow_Zone|Location:Solar_Insolation][Forest_Age_Class|Location:Elevation][Elevation|Snow_Zone:Solar_Insolation:Location][Slope|Location:Elevation][Distance_Escape_Terrain|Location:Forest_Age_Class]")

lvLoc <- c("Observations","Random")
lvSol <- c("Very Low","Low","Moderate","High","Very High")
lvSnow <- c("Shallow","Moderate","Deep","Very Deep")
lvEl <- c("<=500m","<=900m","<=1300m","<=1700m",">1700m")
lvClass <- c("Early","Mid","Mature","Old","Non-Forested")
lvSlope <- c("Shallow","Moderate","Steep")
lvDist <- c("On Escape Terrain","<=150m away","<=300m away",">300m away")

Location.prob <- array(c(0.50003, 0.49997), dim=2, dimnames = list(Location = lvLoc))
Solar.prob <- array(c(0.1659017,   0.2196922,   0.2117921,   0.2485625,   0.1540515, 0.2428176,   0.2877771,   0.2226378,   0.1530485,   0.09371907), dim=c(5,2), dimnames = list(Solar_Insolation = lvSol, Location = lvLoc))
Snow.prob <- array(c(0.2233778,   0.5428545,   0.2177478,   0.01601984, 0.2206578,   0.4923151,   0.2327577,   0.05426946,0.1821,      0.52696,     0.23567,     0.05527,  0.0861,      0.46287,     0.35279,     0.09824,  0.00979,     0.2,         0.46807,     0.32214,0.2126579,   0.2868971,   0.201718,    0.298727, 0.2111279,   0.299477,    0.2141279,   0.2752673,     0.2170978,   0.2935471,   0.204518,    0.2848372,   0.22572,     0.26279,     0.20084,     0.31065,  0.22375,     0.28123,     0.21533,     0.27969 ), dim=c(4,5,2), dimnames= list(Snow_Zone = lvSnow, Solar_Insolation=lvSol,Location=lvLoc))
Forest.prob <- array(c(0.02898971,  0.2162778,   0.09921901,  0.3533965,   0.302117,0.01648,     0.10889,     0.04063,     0.41909,     0.41491,0.0025,      0.04083,     0.05335,     0.48498,     0.41834,0.001110011, 0.01404014,  0.05654056,  0.5461954,   0.3821138,0,           0.00122,     0.00608,     0.27859,     0.71411,0.05375946,  0.0800592,   0.100649,    0.3404466,   0.4250858,0.04764,     0.07286,     0.10088,     0.36749,     0.41113,0.04913049,  0.07435074,  0.09728097,  0.3684937,   0.4107441,0.05042,     0.07682,     0.09408,     0.35668,     0.422, 0.05438,     0.0805,      0.0941,      0.35349,     0.41753),dim=c(5,5,2), dimnames=list(Forest_Age_Class=lvClass, Elevation =lvEl, Location=lvLoc))
Elevation.prob <- array(c(0.49612,     0.45349,     0.05039,     0,           0,0.49185,     0.43852,     0.06963,     0,           0,0.2532575,   0.5642443,   0.1824982,   0,           0,0.08389,     0.68121,     0.2349,      0,           0,0,           0.09523905,  0.7142829,   0.1904781,   0,0.05342946,  0.7192928,   0.2232878,   0.00398996,  0,0.04913951,  0.6493935,   0.2928271,   0.00597994,  0.002659973,0.004499955, 0.5064349,   0.4716853,   0.01608984,  0.001289987,0,           0.3302133,   0.605496,    0.06367064,  6.200062e-4,0,           0.06993,     0.38928,     0.51515,     0.02564,0,           0.01590016,  0.8608386,   0.1212712,   0.00199002,0,           0.02668973,  0.6334237,   0.3328667,   0.007019931,0,           0.01151,     0.70647,     0.26619,     0.01583,   0,           0.00573,     0.6036,      0.38084,     0.00983, 0,           0,           0.20618,     0.73506,     0.05876,0,           0,           0.10811,     0.83784,     0.05405, 0,           0.006020061, 0.03614036,  0.5843458,   0.3734937,    0,           0,           0.0184,      0.45399,     0.52761,    0,           0,           0.01471,     0.47353,     0.51176,0,           0,           0.01158,     0.42113,     0.56729, 0.17663,     0.16551,     0.242,       0.20306,     0.2128,    0.20922,     0.17849,     0.20331,     0.21158,     0.1974, 0.19168,     0.15453,     0.20505,     0.24963,     0.19911, 0.1725583,   0.1767182,   0.2307677,   0.2099779,   0.2099779,    0.22945,     0.19178,     0.19178,     0.19178,     0.19521, 0.1876319,   0.1783518,   0.2381424,   0.202062,    0.1938119, 0.20667,     0.185,       0.21,        0.19,        0.20833, 0.1780218,   0.1879119,   0.2153821,   0.2098921,   0.2087921,0.19107,     0.16786,     0.225,       0.2375,      0.17857,0.17166,     0.16621,     0.21526,     0.21526,     0.23161,0.17595,     0.19062,     0.22727,     0.20235,     0.20381,0.17832,     0.18065,     0.20513,     0.23077,     0.20513,0.20662,     0.16246,     0.2429,      0.20505,     0.18297,0.198602,    0.1635516,   0.2079421,   0.2289723,   0.200932,0.2241977,   0.1779382,   0.1779382,   0.1743783,   0.2455475, 0.1821782,   0.1861381,   0.2514875,   0.1891081,   0.1910881,  0.19311,     0.18042,     0.21396,     0.22575,     0.18676, 0.1664783,   0.1857281,   0.2106479,   0.2163078,   0.2208378, 0.17674,     0.20695,     0.20544,     0.21903,     0.19184, 0.17808,     0.18082,     0.22466,     0.24384,     0.1726),dim=c(5,5,4,2), dimnames = list(Elevation = lvEl, Solar_Insolation =lvSol, Snow_Zone = lvSnow, Location = lvLoc))
Slope.prob <- array(c(0.12709,     0.53958,     0.33333, 0.03599,     0.51219,     0.45182,0.02311,     0.57069,     0.4062,0.0218,      0.7221,      0.2561,0.04866,     0.79927,     0.15207,0.28326,     0.61647,     0.10027,0.28983,     0.59968,     0.11049,0.28988,     0.61055,     0.09957,0.30626,     0.60135,     0.09239,0.30018,     0.60286,     0.09696 ),dim=c(3,5,2), dimnames= list(Slope=lvSlope, Elevation = lvEl, Location = lvLoc))
Distance.prob <- array(c(0,           0.19469,     0.23009,     0.57522, 0,           0.402626,    0.1838082,   0.4135658,  0.00858,     0.20458,     0.16166,     0.62518,  0.005200052, 0.3541835,   0.1744117,   0.4662047,  0.75457,     0.05623,     0.03059,     0.15861, 0.24051,     0.07876,     0.07876,     0.60197,  0.25117,     0.06349,     0.06256,     0.62278,  0.2614474,   0.06720933,  0.05760942,  0.6137339,    0.25392,     0.06629,     0.06328,     0.61651, 0.25336,     0.06695,     0.07126,     0.60843  ), dim=c(4,5,2),dimnames= list(Distance_Escape_Terrain = lvDist, Forest_Age_Class=lvClass, Location= lvLoc))
cpt <- list(Location = Location.prob, Solar_Insolation = Solar.prob,Snow_Zone=Snow.prob,Forest_Age_Class=Forest.prob , Elevation =Elevation.prob, Slope = Slope.prob,Distance_Escape_Terrain=Distance.prob)

mountaingoat <- custom.fit(dag,cpt)
usethis::use_data(mountaingoat, overwrite = TRUE)



