# Bayesian Belief Network Modeling of Accident Occurrence in Metal Lathe Machining Operations
library(bnlearn)

metal.dag = model2network("[CAF][WHF][TPF][CF][OS][SGF][IFR][FlyOutAccident|WHF:TPF:CF:OS:SGF:IFR:CAF]")

lvCAF = c("Okay","Faulty")
lvWHF = c("N-Fail","FLRE")
lvTPF <- c("Okay","Faulty")
lvCF <- c("Okay","Faulty")
lvOS <- c("Proper","Improper")
lvSGF <- c("Okay","Faulty")
lvIFR <- c("HR","HE")
lvFly <- c("Fatal","Major","Minor")


CAF.prob <- array(c(0.28,0.72),dim = 2, dimnames = list(CAF = lvCAF))
WHF.prob <- array(c(0.95,0.05),dim = 2, dimnames = list(WHF = lvWHF))
TPF.prob <- array(c(0.96,0.04),dim = 2, dimnames = list(TPF = lvTPF))
CF.prob <- array(c(0.99,0.01),dim = 2, dimnames = list(CF = lvCF))
OS.prob <- array(c(0.98,0.02),dim = 2, dimnames = list(OS = lvOS))
SGF.prob <- array(c(0.85,0.15),dim = 2, dimnames = list(SGF = lvSGF))
IFR.prob <- array(c(0.90,0.10),dim = 2, dimnames = list(IFR = lvIFR))
ar1 <- c(0.75,0.15,0.10,0.30,0.60,0.10,0.75,0.15,0.10,0.30,0.60,0.10,0.75,0.15,0.10,0.25,0.65,0.10,0.75,0.15,0.10,0.20,0.70,0.10,0.75,0.15,0.10,   0.25,0.55,0.20,0.75,0.15,0.10,  0.30,0.50,0.20, 0.60, 0.30, 0.10, 0.40,0.50,0.10, 0.70,0.20,0.10, 0.30, 0.50,0.20, 0.70,0.20,0.10,  0.30, 0.60, 0.10, 0.80,0.15,0.05, 0.40,0.50,0.10,0.70,0.20,0.10,0.30,0.60,0.10, 0.70,0.20,0.10, 0.40,0.30,0.30, 0.50,0.40,0.10,0.50,0.40,0.10,0.70,0.20,0.10,  0.30,0.40,0.30, 0.60,0.30,0.10, 0.60,0.30,0.10, 0.70,0.20,0.10, 0.30,0.60,0.10, 0.70,0.20,0.10, 0.55,0.35,0.10, 0.80,0.15,0.05, 0.40,0.30,0.30, 0.70,0.20,0.10, 0.45,0.45,0.10, 0.70,0.20,0.10, 0.50,0.40,0.10,   0.75,0.15,0.10,  0.70,0.20,0.10, 0.80,0.15,0.05, 0.30,0.60,0.10, 0.70,0.20,0.10, 0.25,0.65,0.10,   0.75,0.15,0.10,0.25,0.65,0.10,0.85,0.10,0.05, 0.30,0.60,0.10,0.70,0.20,0.10,0.25,0.65,0.10, 0.75,0.20,0.05, 0.20,0.70,0.10,0.80,0.15,0.05, 0.35,0.55,0.10,0.85,0.10,0.05, 0.30,0.60,0.10, 0.70,0.20,0.10, 0.40,0.50,0.10,0.80,0.15,0.05, 0.30,0.60,0.10, 0.75,0.20,0.05,0.30,0.60,0.10,0.85,0.10,0.05)
FlyOutAccident.prob <- array(c(0.01,0.04,0.95,0.05,0.10,0.85,0.05,0.10,0.85,0.15,0.20,0.65,0.30,0.45,0.25,0.5,0.3,0.2,0.3,0.5,0.2,0.55,0.3,0.15,0.01,0.04,0.95,0.1,0.2,0.7,0.1,0.2,0.7,0.15,0.20,0.65,0.3,0.4,0.3,0.5,0.3,0.2,0.55,0.3,0.15,0.60,0.30,0.10,0.334,0.333,0.333,0.35,0.35,0.30,0.35,0.35,0.30,0.35,0.35,0.30,0.35,0.40,0.25,0.60,0.30,0.10,0.30,0.50,0.20,0.60,0.30,0.10,0.334,0.333,0.333,0.35,0.35,0.30,0.35,0.35,0.30,0.35,0.35,0.30,0.30,0.60,0.10,0.60,0.30,0.10,0.30,0.60,0.10,0.60,0.30,0.10,0.25,0.25,0.50,0.30,0.30,0.40,0.30,0.35,0.35,0.45,0.30,0.25,0.30,0.60,0.10,0.70,0.20,0.10,0.30,0.60,0.10,0.70,0.20,0.10,0.30,0.35,0.35,0.47,0.33,0.20,0.30,0.60,0.10,0.65,0.25,0.10,0.30,0.60,0.10,0.65,0.25,0.10,0.30,0.40,0.30,0.45,0.35,0.20,0.30,0.40,0.30,0.45,0.35,0.20,0.30,0.60,0.10,0.70,0.20,0.10,0.25,0.65,0.10,0.75,0.15,0.10,0.30,0.50,0.20,0.60,0.30,0.10,0.30,0.50,0.20,0.75,0.15,0.10,0.30,0.60,0.10,ar1), dim = c(3,2,2,2,2,2,2,2), dimnames = list(FlyOutAccident=lvFly, IFR=lvIFR, SGF=lvSGF, OS = lvOS, CF=lvCF,TPF=lvTPF, WHF=lvWHF, CAF=lvCAF))


metal.cpt <- list(CAF=CAF.prob, WHF=WHF.prob,TPF=TPF.prob,CF=CF.prob,
                  OS=OS.prob,SGF=SGF.prob,IFR=IFR.prob, FlyOutAccident = FlyOutAccident.prob)

metal <- custom.fit(metal.dag,metal.cpt)

usethis::use_data(metal, overwrite = TRUE)
